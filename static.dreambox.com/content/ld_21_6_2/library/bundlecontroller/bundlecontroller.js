var __spreadArray=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||((i=i||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function createDesignTransform(e,t){return{name:e.name,regX:e.regX,regY:e.regY,x:e.x,y:e.y,rotation:e.rotation,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,index:t.getChildIndex(e)}}var bundleController,library_bundlecontroller=library_bundlecontroller||{},BundleMovieClipController=(()=>{function a(e,t){this._namedAssets={},this._buttons={},this._contollers={},this._placeholders={},this._clickListeners={},this._mainAsset="string"==typeof e?DBLAsset.create(e,t):e,this._bundle=t,this.scanNamedAssets()}return a.prototype.scanNamedAssets=function(e){var t=this._mainAsset.paused,n=this._mainAsset.currentFrame;e&&this._mainAsset.gotoAndStop(e);for(var i=0,r=this._mainAsset.children;i<r.length;i++){var o=r[i];o[a.DESIGN_DATA]||this.updateDesignData(o,this.newDesignTransform(o)),o.name&&!this._namedAssets.hasOwnProperty(o.name)&&(this._namedAssets[o.name]=o)}e&&(t?this._mainAsset.gotoAndStop(n):this._mainAsset.gotoAndPlay(n))},Object.defineProperty(a.prototype,"mainAsset",{get:function(){return this._mainAsset},enumerable:!1,configurable:!0}),a.prototype.tick24=function(e){DBLAsset.advanceMovieClip(this._mainAsset)},a.prototype.replaceController=function(e,t){e=new a(e,this._bundle);return this._contollers[t]=e,this.replaceAsset(e.mainAsset,t),e},a.prototype.replaceButton=function(e,t,n){e=new DBLTimelineButton(DBLAsset.create(e,this._bundle),n);return this._buttons[t]=e,this.replaceAsset(e,t),e},a.prototype.replaceButtons=function(e,t,n){for(var i={},r=0,o=t;r<o.length;r++){var a=o[r];i[a]=this.replaceButton(e,a,n)}return i},a.prototype.replacePlaceholderAsset=function(e){return this._placeholders[e]=this.removeAssetAndGetDesignTransform(e),this._placeholders[e]},a.prototype.replacePlaceholderAssets=function(e){for(var t={},n=0,i=e;n<i.length;n++){var r=i[n];t[r]=this.replacePlaceholderAsset(r)}return t},a.prototype.replaceAsset=function(e,t){t=this.removeAssetAndGetDesignTransform(t);return this.placeAsset(e,t),t},a.prototype.placeAsset=function(e,t){return this._mainAsset.addChild(e),this._mainAsset.setChildIndex(e,t.index),this.transformAsset(e,t),this.updateDesignData(e,t),t},a.prototype.setClickListener=function(e,t){this.removeClicklistener(e),this._clickListeners[e.name]=e.addEventListener("click",t)},a.prototype.removeClicklistener=function(e){var t=this._clickListeners[e.name];t&&(e.removeEventListener("click",t),delete this._clickListeners[e.name])},a.prototype.designData=function(e){return e[a.DESIGN_DATA]},a.prototype.removeAssetAndGetDesignTransform=function(e){var t=this._namedAssets[e],n=this.designData(t);return t.visible=!1,delete this._namedAssets[e],this._mainAsset.removeChild(t),n},a.prototype.newDesignTransform=function(e){return{name:e.name,regX:e.regX,regY:e.regY,x:e.x,y:e.y,rotation:e.rotation,scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,index:this._mainAsset.getChildIndex(e)}},a.prototype.transformAsset=function(e,t){e.name=t.name,e.regX=t.regX,e.regY=t.regY,e.x=t.x,e.y=t.y,e.rotation=t.rotation,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.skewX=t.skewX,e.skewY=t.skewY},a.prototype.getPopInAnimation=function(e){e=this.designData(e);return{ease:gsap.Back.easeOut,scaleX:e.scaleX,scaleY:e.scaleY,alpha:1}},a.prototype.getPopOutAnimation=function(e){return{ease:gsap.Back.easeIn,scaleX:0,scaleY:0,alpha:0}},a.prototype.namedMovieClip=function(e){return this._namedAssets[e]},a.prototype.namedText=function(e){return this._namedAssets[e]},a.prototype.setDefaultDesignData=function(e){var t={name:e.name,index:0,rotation:0,regX:0,regY:0,x:0,y:0,scaleX:1,scaleY:1,skewX:0,skewY:0};this.updateDesignData(e,t)},a.prototype.updateDesignData=function(e,t){e[a.DESIGN_DATA]=t},a.DESIGN_DATA="designData",a})();(e=>{var r=["Clip","Label","Image","Icon"];function t(e,t,n){for(var i in this._namedSymbols={},this._factory=n,(this._rootContainer=e)instanceof DBLTimelineButton?(this._mainClip=e.clip,this._rootButton=e):(this._mainClip=e instanceof createjs.MovieClip?e:null,this._rootButton=null),this._nodeData=t){i=t[i];-1!=r.indexOf(i.type)&&(this._namedSymbols[i.name]=this.navigateTo(i.parentRoute,i.name))}}t.prototype.setProxy=function(e,t){var n,i=this._nodeData[e],r=this._namedSymbols[e];return r&&r.parent&&r.parent.removeChild(r),"ProxyContainer"==i.type?(n=this.navigateTo(i.parentRoute,e),i.definition.ignoreScale&&(t.scaleX=1/i.design.scaleX,t.scaleY=1/i.design.scaleY),"number"==typeof i.definition.scaleX&&(t.scaleX*=i.definition.scaleX),"number"==typeof i.definition.scaleY&&(t.scaleY*=i.definition.scaleY),n.addChild(t),i.definition.centerX&&"number"==typeof i.definition.proxyWidth&&(n=t.getTransformedBounds().width,t.x+=.5*(i.definition.proxyWidth-n)),i.definition.centerY&&"number"==typeof i.definition.proxyHeight&&(n=t.getTransformedBounds().height,t.y+=.5*(i.definition.proxyHeight-n))):(r?r.parent:this.navigateTo(i.parentRoute)).addChildAt(t,i.design.index),this._namedSymbols[e]=t,r},t.prototype.createClipFromLibrary=function(e){return this._factory.getLibrarySymbol(e)},t.prototype.createClipFromLinkage=function(e){return this._factory.createClipFromLinkage(e)},t.prototype.setProxyFromLibrary=function(e,t){t=this._factory.getLibrarySymbol(t);return this.setProxy(e,t),t},t.prototype.removeProxy=function(e){e=this._namedSymbols[e];return e&&e.parent.removeChild(e),e},t.prototype.getRootContainer=function(){return this._rootContainer},t.prototype.getRootButton=function(){return this._rootButton},t.prototype.getMainClip=function(){return this._mainClip},t.prototype.getSymbol=function(e){return this._namedSymbols[e]},t.prototype.getText=function(e){return this._namedSymbols[e]},t.prototype.getMeta=function(e){return this._factory.getMeta(e)},t.prototype.setNamedSymbolVisibility=function(e,t){e=this._namedSymbols[e];e&&(e.visible=t)},t.prototype.navigateTo=function(e,t){void 0===t&&(t=null);for(var n,i=null!=(n=this._mainClip)?n:this._rootContainer,r=0,o=e;r<o.length;r++){var a=o[r];if(!(i instanceof createjs.Container))break;i=this.findChildByName(i,a)}return i=t&&i instanceof createjs.Container?this.findChildByName(i,t):i},t.prototype.findChildByName=function(e,t){for(var n=0,i=e.children;n<i.length;n++){var r=i[n];if(r.name==t)return r}return null},e.BundleTemplateController=t})(bundleController=bundleController||{}),(e=>{var l={lbl:"Label",img:"Image",lct:"Locator",prx:"Proxy",icn:"Icon"};function c(e){for(var t={},n=0,i=e.children;n<i.length;n++){var r=i[n];r.name&&!t.hasOwnProperty(r.name)&&(t[r.name]=r)}return t}function d(e,t){void 0===t&&(t=!0);var n={children:{}},i=0;if(e instanceof createjs.Container){var r,o=c(e);for(r in o){var a,s=d(o[r],t);t||(a=r.substring(0,3),s.type=a in l?l[a]:void 0),n.children[r]=s,i++}}return i<=0&&delete n.children,n}e.getNamedChildren=c,e.scanNodeNames=d,e.scanNamedTree=function(e){return{symbolName:"bundleRawData",type:"Unknown",tree:d(e)}}})(bundleController=bundleController||{}),(a=>{var l=["Clip","Label","Image","Locator","Proxy","ProxyContainer","Icon"],c=["Locator","Proxy"];function e(e,t){this._nodeData={},this._meta={},this._definition=e,this._bundle=t;var n=DBLAsset.create(e.symbolName,t),t=this.scanBundleTree(n);switch(this.initTemplate(e.symbolName,e.tree,t,[]),e.type){case"Layout":this._symbol=n;break;case"Movieclip":case"Button":this._symbol=null;break;default:throw Error("Type [".concat(e.type,"] not supported by template controller"))}}e.prototype.scanBundleTree=function(e){var t={};if(e instanceof createjs.Container){var n,i=a.getNamedChildren(e);for(n in i){var r=i[n],o=this.scanBundleTree(r);o.design=createDesignTransform(r,e),t[n]=o}}return{displayObject:e,children:t}},e.prototype.initTemplate=function(e,t,n,i){if(t.children){var r,o=__spreadArray([],i,!0);for(r in o.push(e),t.children){var a=t.children[r],s=n.children[r];this.initTemplate(r,a,s,o)}}-1!=l.indexOf(t.type)&&(i={name:e,parentRoute:i.slice(1),design:n.design,type:t.type,definition:t},this._nodeData[e]=i),"boolean"==typeof t.visible&&(n.displayObject.visible=t.visible),!t.remove&&-1==c.indexOf(t.type)||this.removeNamedAsset(e,n.displayObject)},e.prototype.removeNamedAsset=function(e,t){var n=t.parent;t.visible=!1,delete n[e],n.removeChild(t)},e.prototype.createInstance=function(){var e,t,n=null;return"Layout"==this._definition.type?(e=DBLGraphicUtils.copyCachedContainer(this._symbol),n=new a.BundleTemplateController(e,this._nodeData,this)):(e=DBLAsset.create(this._definition.symbolName,this._bundle),t="Movieclip"==this._definition.type?e:"Button"==this._definition.type?new DBLTimelineButton(e):null,n=new a.BundleTemplateController(t,this._nodeData,this),this.addMeta(this._definition.symbolName,this._definition),this.initMainAssetNode(e,this._definition.tree)),n},e.prototype.initMainAssetNode=function(e,t){if(t.children&&e instanceof createjs.Container)for(var n in t.children){var i=t.children[n],r=this.findChildByName(e,n);this.addMeta(n,i),this.initMainAssetNode(r,i)}"boolean"==typeof t.visible&&(e.visible=t.visible),"boolean"==typeof t.remove&&t.remove&&e.parent.removeChild(e)},e.prototype.addMeta=function(e,t){t=t.meta;t&&(this._meta[e]=t)},e.prototype.findChildByName=function(e,t){for(var n=0,i=e.children;n<i.length;n++){var r=i[n];if(r.name==t)return r}return null},e.prototype.getLibrarySymbol=function(e){var e=this._definition.symbolLibrary[e],t=null!=(t=e.bundle)?t:this._bundle;return DBLAsset.create(e.symbol,t)},e.prototype.createClipFromLinkage=function(e){return DBLAsset.create(e,this._bundle)},e.prototype.getMeta=function(e){return e=e||this._definition.symbolName,this._meta[e]},a.BundleTemplateFactory=e})(bundleController=bundleController||{}),(s=>{function e(e){this._factories={},this._loader=e||new DBLFileLoader}e.prototype.load=function(e){},Object.defineProperty(e.prototype,"loader",{get:function(){return this._loader},enumerable:!1,configurable:!0}),e.prototype.loadTemplates=function(r,o){for(var a=this,e=0,t=r;e<t.length;e++){var n=t[e];this.addTemplate(n.templateFQN)}this._loader.load(function(){for(var e=0,t=r;e<t.length;e++){var n=t[e],i=a._loader.getJson(n.templateFQN),i=new s.BundleTemplateFactory(i,n.bundle);a._factories[n.id]=i}null!=o&&o()})},e.prototype.addTemplate=function(e){this.addFileFqnToLoader(e,".json","text")},e.prototype.hasTemplate=function(e){return e in this._factories},e.prototype.addFileFqnToLoader=function(e,t,n){this._loader.addFile(e,t,n)},e.prototype.createInstance=function(e){return null==(e=this._factories[e])?void 0:e.createInstance()},s.BundleTemplateFactories=e})(bundleController=bundleController||{});