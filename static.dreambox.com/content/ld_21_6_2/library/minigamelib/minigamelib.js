var __extends=this&&this.__extends||(()=>{var i=function(t,e){return(i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}})(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},library_minigamelib=library_minigamelib||{},SOUNDBUTTONMOUSEDOWN=(DBLRuntime.requireLibrary("library.manipulativecore"),DBLRuntime.requireLibrary("library.intermediateshared"),DBLRuntime.requireAudio("assets.bundles.engagement.intermediate.minigames.sounds.SoundButtonMouseDown")),SOUNDBUTTONROLLOVER=DBLRuntime.requireAudio("assets.bundles.engagement.intermediate.minigames.sounds.SoundButtonRollover"),SOUNDSIGNSTATIC=DBLRuntime.requireAudio("assets.bundles.engagement.intermediate.minigames.sounds.SoundSignStatic"),Minigame=(i=>{function t(t,e){var n=i.call(this)||this,t=(n._paused=!1,n._muteBackground=!1,n._playTimer=new PlayTimer,n._gameExiting=!1,n._gameIsOver=!1,n._readied=!1,n._cleaned=!1,n._gameName=t,n._defaultPlayerData=e,n.addEventListener(TranscriptionEvent.TRANSCRIBE,n.transcribe.bind(n)),n._soundManager=new MiniGameSoundManager,n._soundManager.mute=n._muteBackground=muted,new createjs.Rectangle(0,-10,1024,768)),e=n.globalToLocal(0,0),t=(n._scrim=new createjs.Shape,n._scrim.graphics.beginFill(createjs.Graphics.getRGB(64,64,64)),n._scrim.graphics.drawRect(t.x,t.y,t.width,t.width),n._scrim.graphics.endFill(),n._scrim.setBounds(t.x,t.y,t.width,t.height),n._scrim.x=e.x,n._scrim.y=e.y,n._scrim.name="scrim",n.addChild(n._scrim),n._container=new createjs.Container,n._container.scaleX=n._container.scaleY=2,n._container.x=32,n._container.y=20,n.addChild(n._container),new createjs.Shape);return t.graphics.beginFill("black"),t.graphics.drawRect(n._container.x,n._container.y,960,640),t.graphics.endFill(),n._container.addChild(t),n._container.mask=t,setSessionProperty(DBLDataConstants.CUR_SCREEN_TYPE,DBLScreenConstants.MINIGAME_SCREEN),n}return __extends(t,i),t.prototype.getMappings=function(){return["assets.translations.engagement.intermediate.minigames.Translate"]},t.prototype.load=function(t){this._loadCallback=t,DBLStateManager.requestProperty(DBLDataConstants.PROPERTY2_MINIGAME_DATA),DBLStateManager.syncProperties(this.onSyncComplete.bind(this))},t.prototype.onSyncComplete=function(){DBLEngagementManager.getPracticeAreas(this.onPracticeAreasLoaded.bind(this))},t.prototype.loadBookwormCSVFiles=function(t){var e=this,n=new DBLFileLoader;t.forEach(function(t){n.addFile(t.fqn,".csv","text")}),n.load(function(){e.loadComplete(),e._game.fileLoader=n})},t.prototype.onPracticeAreasLoaded=function(t){var e;DBLDataUtils.isBookworm?(e=[DBLDataConstants.SYNONYM,DBLDataConstants.ANTONYM,DBLDataConstants.PREFIX_SUFFIX_ROOT,DBLDataConstants.PREFIX_SUFFIX_MATCH,DBLDataConstants.SAME_WORD,DBLDataConstants.SYLLABLE_SPELLING,DBLDataConstants.PREFIX_SUFFIX,DBLDataConstants.IRREGULAR_PHONICS_PATTERNS,DBLDataConstants.ROOT_WORD_MEANINGS,DBLDataConstants.REGULAR_PHONICS_PATTERNS],this._openGamesets=e.map(function(t){return t.name}),this.loadBookwormCSVFiles(e)):(this._openGamesets=t,-1==this._openGamesets.indexOf("P03A")&&this._openGamesets.unshift("P03A"),-1==this._openGamesets.indexOf("P02D")&&this._openGamesets.unshift("P02D"),-1==this._openGamesets.indexOf("P01A")&&this._openGamesets.unshift("P01A"),this.loadComplete())},t.prototype.loadComplete=function(){var t=this._loadCallback;this._loadCallback=null,t()},t.prototype.getBackScreen=function(){return null},t.prototype.ready=function(){this._cleaned&&DBLLog.log("Minigame's cleanup() called before ready().",DBLLog.ERROR),this._soundManager||DBLLog.log("ready() called without a valid SoundManager.",DBLLog.ERROR),this._readied=!0},t.prototype.cleanup=function(){this._readied||DBLLog.log("Minigame's cleanup() called before ready().",DBLLog.WARN),this._cleaned=!0,this.removeAllChildren(),this.removeAllEventListeners(),this._container.removeAllChildren(),this._current=null,this._currentHandler=null,this._help&&this._help.cleanup(),this._game&&this._game.cleanup(),this._summary&&this._summary.cleanup(),this._transition&&this._transition.cleanup(),this._menu&&this._menu.cleanup(),this._soundManager.destroy(),this._soundManager=null,this._playerData=null},t.prototype.pause=function(){this._paused||(this._paused=!0,this._soundManager.pause(),this._current&&this._current.pauseGame&&this._current.pauseGame(),this._playTimer.pause(),this.showMenu())},t.prototype.resume=function(){},t.prototype.mute=function(){this._muteBackground=!0,this._paused||(this._soundManager.mute=!0)},t.prototype.unmute=function(){this._muteBackground=!1,this._paused||(this._soundManager.mute=!1)},t.prototype.hide=function(t){t()},Object.defineProperty(t.prototype,"soundManager",{get:function(){return this._soundManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundSounds",{set:function(t){this._soundManager.setBackground(t)},enumerable:!1,configurable:!0}),t.prototype.startBackgroundSounds=function(){this._soundManager.startBackground()},t.prototype.stopBackgroundSounds=function(){this._soundManager.stopBackground()},t.prototype.clearBackgroundSounds=function(){this._soundManager.stopBackground(),this._soundManager.clearBackground()},t.prototype.fadeBackgroundSounds=function(){this._soundManager.fadeBackground()},Object.defineProperty(t.prototype,"isBackgroundMuted",{get:function(){return this._muteBackground},enumerable:!1,configurable:!0}),t.prototype.startGame=function(){this._paused=!1,this._help.state=MinigameConstants.PREGAME,this.activateMovie(this._help,this.startTransition.bind(this)),this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_GAME_ACTION,["Show Screen","Help"]))},t.prototype.stopGame=function(t){void 0===t&&(t=null),this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_GAME_ACTION,["Stop Game","Reset"])),this._playTimer.end(),this.startGame()},t.prototype.startTransition=function(){this.activateMovie(this._transition,this.startPlaying.bind(this))},t.prototype.startPlaying=function(){this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_GAME_ACTION,["Show Screen","Gameplay"])),this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_GAME_ACTION,["Gamesets",this._openGamesets.join(", ")])),this._playTimer.start(),this._game.playerData=this._playerData,this._game.openGamesets=this._openGamesets,this._game.addEventListener(MinigameConstants.SHOW_MENU,this.clickMenu.bind(this)),this._game.addEventListener(MinigameConstants.CLOSE,this.hideMenu.bind(this)),this.activateMovie(this._game,this.endTransition.bind(this))},t.prototype.endTransition=function(){this.savePlayerData(),this._playTimer.end();var t,e=["Game Time",this._playTimer.accumulatedTime];for(t in this._playerData)e.push(t),e.push(this._playerData[t]);this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_GAME_ACTION,e)),this.activateMovie(this._transition,this.endPlaying.bind(this))},t.prototype.endPlaying=function(){this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_GAME_ACTION,["Show Screen","Final Score"])),this._summary.playerData=this._playerData,this.activateMovie(this._summary,this.gameOver.bind(this))},t.prototype.gameOver=function(){this.cleanupMenu(),this._current&&(this._container.removeChild(this._current),this._current.removeAllEventListeners()),this._gameExiting||(this._gameExiting=!0,shell.loadScreen(DBLScreenConstants.COLLECTIONS_SCREEN))},t.prototype.clickMenu=function(){this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_STUDENT_ACTION,[TranscriptionEvent.STUDENT_ACTION_BUTTON_CLICK,"Top Menu"])),this._paused=!0,this._soundManager.pause(),this._current&&this._current.pauseGame&&this._current.pauseGame(),this._playTimer.pause(),this.showMenu()},t.prototype.showMenu=function(){this._menu.addEventListener(MinigameConstants.SHOW_HELP,this.showHelp.bind(this)),this._menu.addEventListener(MinigameConstants.RESTART,this.gameOver.bind(this)),this._menu.addEventListener(MinigameConstants.CLOSE,this.hideMenu.bind(this)),this._container.addChild(this._menu),this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_GAME_ACTION,["Show Screen","Menu"]))},t.prototype.hideMenu=function(){this.cleanupMenu(),0==this._gameIsOver&&(this._current&&this._current.resumeGame&&this._current.resumeGame(),this._playTimer.resume(),this._soundManager.resume(),this._soundManager.mute=this._muteBackground),this._paused=!1,this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_GAME_ACTION,["Hide Screen","Menu"]))},t.prototype.cleanupMenu=function(){this._menu.parent&&this._container.removeChild(this._menu),this._menu.removeEventListener(MinigameConstants.SHOW_HELP,this.showHelp.bind(this)),this._menu.removeEventListener(MinigameConstants.RESTART,this.gameOver.bind(this)),this._menu.removeEventListener(MinigameConstants.CLOSE,this.hideMenu.bind(this))},t.prototype.showHelp=function(){this._help.state=MinigameConstants.INGAME,this._help.addEventListener(MinigameConstants.CLOSE,this.hideHelp.bind(this)),this._container.addChild(this._help),this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_GAME_ACTION,["Show Screen","Help"]))},t.prototype.hideHelp=function(){this._container.removeChild(this._help),this._help.removeEventListener(MinigameConstants.CLOSE,this.hideHelp.bind(this)),this.dispatchEvent(new TranscriptionEvent(TranscriptionEvent.TYPE_GAME_ACTION,["Hide Screen","Help"]))},t.prototype.activateMovie=function(t,e){this._current&&(this._container.removeChild(this._current),this._current.removeAllEventListeners()),this._current=t,this._currentHandler=e,this._current.addEventListener(MinigameConstants.CONTINUE,e.bind(this)),this._current.addEventListener(MinigameConstants.PLAY_AGAIN,this.gameOver.bind(this)),this._container.addChild(this._current),this._current&&this._current.start&&this._current.start()},t.prototype.transcribe=function(t){DBLLog.log("Minigame transcribe event: "+t.eventType+" "+t.paramHash,DBLLog.INFO)},t.prototype.savePlayerData=function(){this._gameIsOver=!0;var t=DBLStateManager.getProperty(DBLDataConstants.PROPERTY2_MINIGAME_DATA)||{};t[this._gameName]=this.playerData,DBLStateManager.setProperty(DBLDataConstants.PROPERTY2_MINIGAME_DATA,t),DBLStateManager.syncProperties(function(){DBLLog.log("Server updated with minigame player data.",DBLLog.INFO)})},Object.defineProperty(t.prototype,"playerData",{get:function(){var t;return null==this._playerData&&(t=void 0,t=(t=DBLStateManager.getProperty(DBLDataConstants.PROPERTY2_MINIGAME_DATA))?t[this._gameName]:null,this._playerData=t||this._defaultPlayerData),this._playerData},enumerable:!1,configurable:!0}),t.prototype.tick24=function(t){if(!this._paused)for(;0<t--;)this._current&&this._current.tick24&&this._current.tick24(),this._help&&this._help.parent&&this._help.tick()},t.localizeWithFont=function(t,e,n,i,r){void 0===n&&(n=null),void 0===r&&(r=""),t.text=(i=void 0===i?"":i)+translate(e)+r,n&&DBLFont.fixFont(t,n)},t.prototype.getAccessibilityData=function(){return{role:"button",display:{object:this},label:"TODO: Implement!",labelObject:{id:this.name||"dblTimelineButton"},enabled:!0,visible:!0}},t})(createjs.Container),MinigameConstants=(()=>{function t(){}return t.CONTINUE="continue",t.RESTART="restart",t.PLAY_AGAIN="play_again",t.CLOSE="close",t.SHOW_MENU="show_menu",t.SHOW_HELP="show_help",t.PREGAME=0,t.INGAME=1,t.TYPE_ONE_TO_ONE=1,t.TYPE_MANY_TO_MANY=2,t})(),Help=(i=>{function t(t,e){var n=i.call(this)||this;return n._art=t,n._art.gotoAndStop(0),n.addChild(n._art),Util.fixButtonClip(n._art.btnPlay,e),n._btnPlay=new DBLTimelineButton(n._art.btnPlay,null,SOUNDBUTTONMOUSEDOWN,SOUNDBUTTONROLLOVER,n._art.btnPlay),n._btnPlay.addEventListener("click",n.playClicked.bind(n)),n.addChild(n._btnPlay),Util.fixButtonClip(n._art.btnClose,e),n._btnClose=new DBLTimelineButton(n._art.btnClose,null,SOUNDBUTTONMOUSEDOWN,SOUNDBUTTONROLLOVER,n._art.btnClose),n._btnClose.addEventListener("click",n.closeClicked.bind(n)),n.addChild(n._btnClose),n}return __extends(t,i),t.prototype.cleanup=function(){this._btnPlay.removeEventListener("click",this.playClicked.bind(this)),this._btnPlay.cleanup(),this._btnPlay=null,this._btnClose.removeEventListener("click",this.closeClicked.bind(this)),this._btnClose.cleanup(),this._btnClose=null},t.prototype.playClicked=function(){this.dispatchEvent(MinigameConstants.CONTINUE)},t.prototype.closeClicked=function(){this.dispatchEvent(MinigameConstants.CLOSE)},Object.defineProperty(t.prototype,"state",{set:function(t){switch(t){case MinigameConstants.PREGAME:this._btnPlay.visible=!0,this._btnClose.visible=!1;break;case MinigameConstants.INGAME:this._btnPlay.visible=!1,this._btnClose.visible=!0}},enumerable:!1,configurable:!0}),t.prototype.tick=function(){DBLAsset.advanceMovieClip(this._art.help)},t})(createjs.MovieClip),Menu=(i=>{function t(t,e){var n=i.call(this)||this;return n._art=t,n._art.gotoAndStop(0),n.addChild(n._art),Util.fixButtonClip(n._art.btnHelp,e),n._btnHelp=new DBLTimelineButton(n._art.btnHelp,null,SOUNDBUTTONMOUSEDOWN,SOUNDBUTTONROLLOVER,n._art.btnHelp),n._btnHelp.addEventListener("click",n.help.bind(n)),n.addChild(n._btnHelp),Util.fixButtonClip(n._art.btnStartover,e),n._btnStartover=new DBLTimelineButton(n._art.btnStartover,null,SOUNDBUTTONMOUSEDOWN,SOUNDBUTTONROLLOVER,n._art.btnStartover),n._btnStartover.addEventListener("click",n.startover.bind(n)),n.addChild(n._btnStartover),Util.fixButtonClip(n._art.btnResume,e),n._btnResume=new DBLTimelineButton(n._art.btnResume,null,SOUNDBUTTONMOUSEDOWN,SOUNDBUTTONROLLOVER,n._art.btnResume),n._btnResume.addEventListener("click",n.resume.bind(n)),n.addChild(n._btnResume),n}return __extends(t,i),t.prototype.cleanup=function(){this._btnHelp.removeEventListener("click",this.help.bind(this)),this._btnHelp.cleanup(),this._btnHelp=null,this._btnStartover.removeEventListener("click",this.startover.bind(this)),this._btnStartover.cleanup(),this._btnStartover=null,this._btnResume.removeEventListener("click",this.resume.bind(this)),this._btnResume.cleanup(),this._btnResume=null},t.prototype.help=function(){this.dispatchEvent(MinigameConstants.SHOW_HELP)},t.prototype.startover=function(){this.dispatchEvent(MinigameConstants.RESTART)},t.prototype.resume=function(){this.dispatchEvent(MinigameConstants.CLOSE)},t})(createjs.MovieClip),Summary=(r=>{function t(t,e,n){var i=r.call(this)||this;return i._art=t,i._art.gotoAndStop(0),i.addChild(i._art),i.name="summaryscreen",null!=i._art.btnReplay&&(null==i._btnReplay&&(Util.fixButtonClip(i._art.btnReplay,e),i._btnReplay=new DBLTimelineButton(i._art.btnReplay,null,SOUNDBUTTONMOUSEDOWN,SOUNDBUTTONROLLOVER,i._art.btnReplay),i.addChild(i._btnReplay)),i._btnReplay.addEventListener("click",i.clicked.bind(i))),i._soundManager=n,i}return __extends(t,r),t.prototype.clicked=function(t){this.dispatchEvent(MinigameConstants.CONTINUE)},t.prototype.cleanup=function(){null!=this._btnReplay&&(this._btnReplay.removeEventListener("click",this.clicked.bind(this)),this._btnReplay.cleanup(),this._btnReplay=null),this._soundManager.fade("summaryMusic"),this._soundManager=null},Object.defineProperty(t.prototype,"playerData",{set:function(t){null!=this._art.scoreDisplay&&(this._art.scoreDisplay.text=Util.addCommas(t.score.toString())),null!=this._art.highscoreDisplay&&(this._art.highscoreDisplay.text=Util.addCommas(t.highScore.toString()))},enumerable:!1,configurable:!0}),t})(createjs.MovieClip),Transition=(i=>{function t(t,e){var n=i.call(this)||this;return n._playing=!1,n._art=t,n._art.gotoAndStop(0),n.addChild(n._art),null!=n._art.animation&&n._art.animation.gotoAndStop(0),n._soundManager=e,n}return __extends(t,i),t.prototype.cleanup=function(){this._playing=!1,this._soundManager.stop("transitionMusic"),this._soundManager=null},t.prototype.start=function(){null!=this._art.animation&&this._art.animation.gotoAndPlay(0),this._playing=!0,this._soundManager.play("transitionMusic")},t.prototype.pause=function(){null!=this._art.animation&&this._art.animation.stop(),this._playing=!1},t.prototype.resume=function(){null!=this._art.animation&&this._art.animation.play(),this._playing=!0},t.prototype.tick24=function(){this._playing&&null!=this._art.animation&&(DBLAsset.advanceMovieClip(this._art.animation),this._art.animation.currentFrame==this._art.animation.timeline.duration-1)&&(this._playing=!1,this.dispatchEvent(MinigameConstants.CONTINUE))},t})(createjs.MovieClip),ArrayUtil=(()=>{function t(){}return t.updateArrayWith=function(t,e,n){for(;t.length>=n&&0<t.length;)t.shift();0<n&&t.push(e)},t.remove=function(t,e){for(var n=[],i=0;i<t.length;i++)-1==e.indexOf(t[i])&&n.push(t[i]);return n},t.dedupe=function(t){for(var e=t.length-1;0<=e;e--){for(var n=!1,i=0;i<e;i++)if(t[e]==t[i]){n=!0;break}n&&t.splice(e,1)}},t})(),ElapsedTimer=(()=>{function t(){this._accumulatedTime=0}return t.prototype.reset=function(){this._accumulatedTime=0,this._startTime=0},t.prototype.start=function(){this._accumulatedTime=0,this._startTime=getTime()},t.prototype.end=function(){var t;0!=this._startTime&&(t=getTime(),this._accumulatedTime+=t-this._startTime,this._startTime=0)},t.prototype.pause=function(){var t;0!=this._startTime&&(t=getTime(),this._accumulatedTime+=t-this._startTime,this._startTime=0)},t.prototype.resume=function(){0==this._startTime&&(this._startTime=getTime())},Object.defineProperty(t.prototype,"accumulatedTime",{get:function(){var t=this._accumulatedTime;return 0!=this._startTime&&(t+=getTime()-this._startTime),t},enumerable:!1,configurable:!0}),t})(),PlayTimer=(()=>{function t(){this._accumulatedTime=0}return t.prototype.reset=function(){this._accumulatedTime=0,this._startTime=0},t.prototype.start=function(){this._accumulatedTime=0,this._startTime=getTime()},t.prototype.end=function(){var t;0!=this._startTime&&(t=getTime(),this._accumulatedTime+=t-this._startTime,this._startTime=0)},t.prototype.pause=function(){var t;0!=this._startTime&&(t=getTime(),this._accumulatedTime+=t-this._startTime,this._startTime=0)},t.prototype.resume=function(){0==this._startTime&&(this._startTime=getTime())},Object.defineProperty(t.prototype,"accumulatedTime",{get:function(){return this._accumulatedTime},enumerable:!1,configurable:!0}),t})(),TimeKeeper=(()=>{function t(){this._timers={}}return t.prototype.delay=function(t,e,n){e=new DBLTimer(e,1);e.addEventListener(DBLTimer.TIMER_COMPLETE,n.bind(this)),e.addEventListener(DBLTimer.TIMER_COMPLETE,this.timerComplete.bind(this)),e.start(),this._timers[t]=e},t.prototype.elapsedTimer=function(t){this._timers[t]=new ElapsedTimer},t.prototype.start=function(t){t=this._timers[t];null!=t&&t.start()},t.prototype.kill=function(t){var e=this._timers[t];null!=e&&(e instanceof DBLTimer?(e.stop(),e.removeEventListener(DBLTimer.TIMER_COMPLETE,this.timerComplete.bind(this))):e instanceof ElapsedTimer&&e.end(),delete this._timers[t])},t.prototype.killAll=function(){for(var t in this._timers)this.kill(t)},t.prototype.pauseAll=function(){for(var t in this._timers){t=this._timers[t];t instanceof DBLTimer?t.stop():t instanceof ElapsedTimer&&t.pause()}},t.prototype.resumeAll=function(){for(var t in this._timers){t=this._timers[t];t instanceof DBLTimer?t.start():t instanceof ElapsedTimer&&t.resume()}},t.prototype.getTimer=function(t){return this._timers[t]},t.prototype.timerComplete=function(t){var e,n;for(n in this._timers)if(this._timers[n]==t.target){e=this._timers[n];break}null!=e&&(e.removeEventListener(DBLTimer.TIMER_COMPLETE,this.timerComplete.bind(this)),delete this._timers[n])},Object.defineProperty(t,"instance",{get:function(){return null==this._instance&&(this._instance=new t),this._instance},set:function(t){this._instance=t},enumerable:!1,configurable:!0}),t})(),RandomUtil=(()=>{function t(){}return t.coinFlip=function(t){return void 0===t&&(t=.5),t=Math.max(0,Math.min(t,1)),Math.random()<t},t.randomRange=function(t,e){return t+Math.random()*(e-t)},t.intRandom=function(t){return Math.floor(Math.random()*t)},t.randomBetween=function(t,e){return t+DBLUtils.toInt(Math.random()*(e-t+1))},t.randomBetweenExcluding=function(t,e,n){var i;if(this._traceGenerator,e-t+1>=n.length){for(var r=[],o=t;o<=e;o++)-1==n.indexOf(o)&&r.push(o);i=0<r.length?r[this.intRandom(r.length)]:(this._traceGenerator,this.randomBetween(t,e))}else for(;i=this.randomBetween(t,e),0<=n.indexOf(i););return i},t.randomElement=function(t){return 0==t.length?null:t[this.randomBetween(0,t.length-1)]},t.print=function(t){for(var e="[",n=0;n<t.length;n++)e+=(0!=n?", ":"")+t[n];return e+="]"},t})(),MiniGameSoundManager=(()=>{function u(){this._soundList={},this._groupList={},this._playing=[],this._mute=!1,this._backgroundSounds=[]}return u.prototype.register=function(t,e,n,i){this._soundList[t]=new SoundPlayer(e,n=void 0===n?!1:n,i=void 0===i?!1:i)},u.prototype.play=function(t,e,n){return this.playSound(t,0,0,e=void 0===e?0:e,n=void 0===n?1:n)},u.prototype.playPosition=function(t,e,n,i){return this.playSound(t,e=void 0===e?0:e,0,n=void 0===n?0:n,i=void 0===i?1:i)},u.prototype.playLoop=function(t,e,n){return this.playSound(t,0,e=void 0===e?1:e,0,n=void 0===n?1:n)},u.prototype.registerGroup=function(t,e){this._groupList[t]={members:e};for(var n=0;n<e.length;n++)if(null==this._soundList[e[n]])throw new Error('Unregistered sound listed in sound group: "'+e[n]+'"')},u.prototype.playGroup=function(t,e,n,i,r){var o,s,a;if(void 0===e&&(e=u.PURE_RANDOM),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=null),null==this._groupList[t])throw new Error('Attempting to play an unregistered sound group: "'+t+'"');switch(s=this._groupList[t],e){case u.PURE_RANDOM:default:o=s.members[DBLUtils.toInt(Math.random()*s.members.length)];break;case u.CYCLE:a=null==s.index?0:s.index,o=s.members[a],a=(a+1)%s.members.length,s.index=a;break;case u.CYCLE_RANDOM:for(null==s.used&&(s.used=[]),0==s.members.length&&(s.members=s.used,s.used=[]);a=DBLUtils.toInt(Math.random()*s.members.length),s.members[a]==s.lastPick;);o=s.lastPick=s.members[a],s.used=s.used.concat(s.members.splice(a,1))}return null!=(t=this.playSound(o,0,0,n,i))&&null!=r&&(t.completeFunction=r),t},u.prototype.playGroupAndWait=function(t,e,n){t=this.playGroup(t,e,0,1,n);return null==t&&null!=n&&n(),t},u.prototype.playSound=function(t,e,n,i,r){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=1);var o=this._soundList[t];if(null==o)throw new Error('Attempting to play an unregistered sound: "'+t+'"');return 0<=this._playing.indexOf(o)&&o.singular||(o.addEventListener("complete",this.playFinished.bind(this)),o.play(e,n,i,r),this._playing.push(o)),o},u.prototype.playFinished=function(t){if(this._playing){for(var e=-1,n=0;n<this._playing.length;n++)t.target==this._playing[n]&&(e=n);-1!=e&&(this._playing[e].removeEventListener("complete",this.playFinished.bind(this)),this._playing.splice(e,1))}},u.prototype.fade=function(t,e){void 0===e&&(e=1e3);var n=this._soundList[t];if(null==n)throw new Error('Attempting to fade an unregistered sound: "'+t+'"');n.isPlaying&&n.fade(e)},u.prototype.getSoundPlayer=function(t){if(null==this._soundList[t])throw new Error('Asking for the SoundPlayer  of an unregistered sound: "'+t+'"');return this._soundList[t]},u.prototype.stop=function(t,e){void 0===e&&(e=!1);var n=-1,i=this._soundList[t];if(null!=i){for(var r=0;r<this._playing.length;r++)i==this._playing[r]&&(n=r);-1!=n&&this._playing.splice(n,1),null!=i.channel&&(i.stop(e),i.clear())}},u.prototype.setBackground=function(t,e){void 0===e&&(e=1),t instanceof Array||(t=[t]);for(var n=this._backgroundSounds.length=0;n<t.length;n++){var i={quiet:!1,player:null};i.player=new SoundPlayer(t[n],!0),i.volume=Math.max(0,Math.min(e,1)),this._backgroundSounds.push(i)}},u.prototype.startBackground=function(t){void 0===t&&(t=0);for(var e=0;e<this._backgroundSounds.length;e++){var n=this._backgroundSounds[e];this._mute&&n.muteable||null==n.player||n.player.isPlaying||n.player.play(t,1e6,0,n.quiet?n.volume/2:n.volume)}},u.prototype.stopBackground=function(){for(var t=0;t<this._backgroundSounds.length;t++){var e=this._backgroundSounds[t];null!=e.player&&e.player.clear()}},u.prototype.fadeBackground=function(t){void 0===t&&(t=1e3);for(var e=0;e<this._backgroundSounds.length;e++){var n=this._backgroundSounds[e];null!=n.player&&n.player.fade(t)}},u.prototype.quietBackground=function(){for(var t=0;t<this._backgroundSounds.length;t++){var e=this._backgroundSounds[t];e.quiet=!0,e.player.volume=e.volume/2}},u.prototype.normalBackground=function(){for(var t=0;t<this._backgroundSounds.length;t++){var e=this._backgroundSounds[t];e.quiet=!1,e.player.volume=e.volume}},u.prototype.clearBackground=function(){this.stopBackground(),this._backgroundSounds.length=0},u.prototype.getBackgroundSounds=function(){for(var t=[],e=0;e<this._backgroundSounds.length;e++){var n=this._backgroundSounds[e];t.push(n.player)}return t},Object.defineProperty(u.prototype,"mute",{set:function(t){var e=this._mute;this._mute=t,this._mute!=e&&(this._mute?this.stopMuteable():this.restartMuteable())},enumerable:!1,configurable:!0}),u.prototype.stopMuteable=function(){for(var t=0;t<this._playing.length;t++)this._playing[t].muteable&&this._playing[t].stop();this.stopBackground()},u.prototype.restartMuteable=function(){this.startBackground()},u.prototype.pause=function(){for(var t=0;t<this._playing.length;t++)this._playing[t].pause();this.stopBackground()},u.prototype.resume=function(){for(var t=0;t<this._playing.length;t++)this._playing[t].resume();this._mute||this.startBackground()},u.prototype.stopAll=function(){for(var t=0;t<this._playing.length;t++)this._playing[t].stop()},u.prototype.destroy=function(){for(var t,e=0;e<this._playing.length;e++)this._playing[e].clear();for(t in this.clearBackground(),this._soundList)this._soundList[t].clear();this._soundList=null,this._groupList=null,this._playing=null,this._backgroundSounds=null},u.PURE_RANDOM=0,u.CYCLE=1,u.CYCLE_RANDOM=2,u})(),SoundPlayer=(r=>{function t(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===i&&(i=0);n=r.call(this)||this;return n._volume=1,n._pan=0,n._playPosition=0,n._sound=t,n._pausable=e,n._offset=i,n}return __extends(t,r),t.prototype.play=function(t,e,n,i){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),this._playPosition=t=void 0===t?0:t,this._loops=e,this._pan=n,this._volume=i,this.playSound()},t.prototype.playSound=function(){var t=Math.max(0,Math.min(this._volume,1)),e=Math.max(-1,Math.min(this._pan,1));0==this._playPosition&&0<this._offset&&(this._playPosition=this._offset),this._channel=DBLAsset.playSound(this._sound,{offset:this._playPosition,loop:this._loops,volume:t,pan:e}),null!=this._channel?this._channel.addEventListener("complete",this.playFinished.bind(this)):this.playFinished()},t.prototype.playFinished=function(){null!=this._channel&&(this._channel.removeAllEventListeners(),this._channel=null),null!=this._complete&&this._complete("complete"),this.dispatchEvent("complete")},t.prototype.pause=function(){null!=this._channel&&this._pausable&&(this._channel.paused=!0)},t.prototype.resume=function(){null!=this._channel&&this._pausable&&(this._channel.paused=!1)},t.prototype.stop=function(t){void 0===t&&(t=!1),null!=this._channel&&(this._channel.stop(),t)&&null!=this._complete&&this._complete("complete")},t.prototype.clear=function(){null!=this._channel&&(this._channel.stop(),this._channel.removeAllEventListeners(),this._channel=null),null!=this._fadeChannel&&(this._fadeChannel.stop(),this._fadeChannel.removeAllEventListeners(),this._fadeChannel=null),this._fadeTimer&&(this._fadeTimer.stop(),this._fadeTimer.removeAllEventListeners(),this._fadeTimer=null)},Object.defineProperty(t.prototype,"isPlaying",{get:function(){return null!=this._channel},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentPosition",{get:function(){return null==this._channel?0:this._channel.position},enumerable:!1,configurable:!0}),t.prototype.fade=function(t){null!=this._channel&&null==this._fadeTimer&&(this._fadeChannel=this._channel,this._channel.removeAllEventListeners(),this._channel=null,this._fadeTimer=new DBLTimer(1e3/24,24*t/1e3),this._fadeTimer.addEventListener(DBLTimer.TIMER,this.fadeStep.bind(this)),this._fadeTimer.addEventListener(DBLTimer.TIMER_COMPLETE,this.fadeFinished.bind(this)),this._fadeTimer.start())},t.prototype.fadeStep=function(){this._fadeChannel.volume=this._volume*(this._fadeTimer.repeatCount-this._fadeTimer.currentCount)/this._fadeTimer.repeatCount},t.prototype.fadeFinished=function(){this.clear()},Object.defineProperty(t.prototype,"url",{get:function(){return this._url},set:function(t){this._url=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pausable",{get:function(){return this._pausable},set:function(t){this._pausable=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"muteable",{get:function(){return this._muteable},set:function(t){this._muteable=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offset",{get:function(){return this._offset},set:function(t){this._offset=Math.max(0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=Math.max(0,Math.min(t,1)),this._channel&&(this._channel.volume=this._volume)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan=Math.max(-1,Math.min(t,1)),this._channel&&(this._channel.pan=this._pan)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"singular",{get:function(){return this._singular},set:function(t){this._singular=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"completeFunction",{get:function(){return this._complete},set:function(t){this._complete=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"channel",{get:function(){return this._channel},set:function(t){this._channel=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sound",{get:function(){return this._sound},enumerable:!1,configurable:!0}),t})(createjs.EventDispatcher),TranscriptionEvent=(r=>{function o(t,e,n,i){n=r.call(this,o.TRANSCRIBE,n=void 0===n?!0:n,i=void 0===i?!1:i)||this;return n.params=e,n._eventType=t,n}return __extends(o,r),Object.defineProperty(o.prototype,"paramHash",{get:function(){for(var t={},e=0;e<this.params.length;)t[this.params[e]]=this.params[e+1],e+=2;return t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"eventType",{get:function(){return this._eventType},set:function(t){this._eventType=t},enumerable:!1,configurable:!0}),o.prototype.clone=function(){return new o(this._eventType,this.params,this.bubbles,this.cancelable)},o.TYPE_GAME_ACTION="GameAction",o.TYPE_STUDENT_ACTION="StudentAction",o.GAME_START_LEVEL="StartLevel",o.GAME_END_LEVEL="EndLevel",o.STUDENT_ACTION_BUTTON_CLICK="ButtonClick",o.STUDENT_ACTION_CORRECT_ANSWER="CorrectAnswer",o.STUDENT_ACTION_WRONG_ANSWER="WrongAnswer",o.STUDENT_ACTION_MISSED_ANSWER="MissedCorrectAnswer",o.STUDENT_ACTION_HIT_BONUS="HitBonus",o.GENERATOR_ACTION_NEW_PROBLEM="NewProblem",o.GENERATOR_ACTION_NEW_QUESTION="NewQuestion",o.GENERATOR_ACTION_NEW_ANSWER="NewAnswer",o.DEFAULT_NAME="DBLTranscriptionEvent",o.TRANSCRIBE="transcribe",o})(createjs.Event),Util=(()=>{function t(){}return t.addCommas=function(t){var e="",n=!1;for("-"==t.substr(0,1)&&(n=!0,t=t.substr(1));3<t.length;)e=","+t.substr(t.length-3,3)+e,t=t.substr(0,t.length-3);return(t=n?"-"+t:t)+e},t.fixButtonClip=function(t,e){for(var n=null,i=0;i<t.timeline.duration;i++){t.gotoAndStop(i);for(var r=0;r<t.numChildren;r++){var o=t.getChildAt(r);o instanceof createjs.Text&&(o=o,n=n||translate(o.text),o.text=n,DBLFont.fixFont(o,e))}}t.gotoAndStop(0)},t})(),BitmapTextFactory=(t=>{function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e})(createjs.Container),Crusher=function(){},DustCloud=(t=>{function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setArt=function(t){this.addChild(t);t=this.getBounds();this.mouseEnabled=!1,this.mouseChildren=!1,this.cache(t.x,t.y,t.width,t.height,3)},e.prototype.start=function(){var t=2+.5*Math.random();this.scaleX=RandomUtil.coinFlip()?-1:1,this.scaleY=RandomUtil.coinFlip()?-1:1,this.alpha=1,this.visible=!0,gsap.TweenLite.to(this,t,{alpha:.2,ease:gsap.Linear.ease,onComplete:this.remove.bind(this)}),gsap.TweenLite.to(this,t,{scaleX:5*this.scaleX,scaleY:5*this.scaleY,ease:gsap.Linear.ease})},e.prototype.remove=function(){null!=this.parent&&this.parent.removeChild(this)},e})(createjs.MovieClip),FadeAndRise=(o=>{function s(t,e,n,i){void 0===i&&(i=!0);var r=o.call(this)||this;return r.mouseEnabled=r.mouseChildren=!1,r._fade=s._fadeStart,r._vy=s._vyStart,r._delay=s._delaySteps,r.addChild(t),r.x=e-t.getTransformedBounds().width/2,r.y=n-t.getTransformedBounds().height/2,DBLAsset.setNameAndBounds(r,"fadeandrise",t.getTransformedBounds()),DBLAsset.setNameAndBounds(t,"fadeandrise",t.getTransformedBounds()),i&&(e=t.getBounds(),t.cache(e.x,e.y,e.width,e.height,2)),r}return __extends(s,o),s.prototype.step=function(){0<this._delay?this._delay--:(this.y-=this._vy,this._vy+=s._ay,this._fade-=s._dFade,this.alpha=this._fade,this._fade<=0&&this.parent&&this.parent.removeChild(this))},Object.defineProperty(s,"acceleration",{get:function(){return this._ay},set:function(t){s._ay=t},enumerable:!1,configurable:!0}),Object.defineProperty(s,"fadeStart",{get:function(){return this._fadeStart},set:function(t){s._fadeStart=t},enumerable:!1,configurable:!0}),Object.defineProperty(s,"fadeStep",{get:function(){return this._dFade},set:function(t){s._dFade=t},enumerable:!1,configurable:!0}),Object.defineProperty(s,"startVelocity",{get:function(){return this._vyStart},set:function(t){s._vyStart=t},enumerable:!1,configurable:!0}),Object.defineProperty(s,"delaySteps",{get:function(){return this._delaySteps},set:function(t){s._delaySteps=t},enumerable:!1,configurable:!0}),s.prototype.tick24=function(){this.step()},s._ay=.75,s._fadeStart=1.4,s._dFade=.1,s._vyStart=2,s._delaySteps=0,s})(createjs.Container),Floater=(e=>{function t(){var t=e.call(this)||this;return t._floatEnabled=!1,t._dx=0,t._dy=0,t._xStep=0,t._yStep=0,t._xInc=.8+.4*Math.random(),t._yInc=.8+.4*Math.random(),t}return __extends(t,e),Object.defineProperty(t.prototype,"floatEnabled",{get:function(){return this._floatEnabled},set:function(t){this._floatEnabled=t,this._floatEnabled&&(this._baseX=this.x,this._baseY=this.y)},enumerable:!1,configurable:!0}),t.prototype.tick24=function(){this._floatEnabled&&(this._dx=Math.cos(Math.PI*this._xStep/50),this._dy=2*Math.cos(Math.PI*this._yStep/40),this._xStep+=this._xInc,this._xStep=100<this._xStep?this._xStep-100:this._xStep,this._yStep+=this._yInc,this._yStep=80<this._yStep?this._yStep-80:this._yStep,this.x=this._baseX+this._dx,this.y=this._baseY+this._dy)},t})(createjs.MovieClip),Shatter=(()=>{function t(){}return t.shatter=function(t,e,n){void 0===e&&(e=2),void 0===n&&(n=2);var i,r,o,s=t.getBounds(),a=s.width/e,u=s.height/n,c=[],h=[];for(t instanceof createjs.Bitmap?i=t:(t.cache(s.x,s.y,s.width,s.height),i=new createjs.Bitmap(t.cacheCanvas),t.uncache()),r=0;r<=e;r++)for(c[r]=[],o=0;o<=n;o++){var l=r*a,p=o*u;0<r&&r<e&&0<o&&o<n&&(l+=Math.random()*a/2-a/4,p+=Math.random()*u/2-u/4),c[r][o]=new createjs.Point(l,p)}for(r=0;r<e;r++)for(o=0;o<n;o++){var _=c[r][o],d=c[r+1][o],m=c[r][o+1],f=c[r+1][o+1],g=Math.min(_.x,m.x),y=Math.max(d.x,f.x),_=Math.min(_.y,m.y),m=Math.max(d.y,f.y);i.sourceRect=new createjs.Rectangle(g,_,y-g,m-_),d=i.clone(),h.push(this.createPiece(d,g,_))}return h},t.createPiece=function(t,e,n){var i,r;return null==this._pieceClass?(t.x=e,t.y=n,t):(r=new this._pieceClass,t.x=-i.width/2,t.y=-i.height/2,r.addChild(t),r.x=e+i.width/2,r.y=n+i.height/2,r)},Object.defineProperty(t,"pieceClass",{get:function(){return this._pieceClass},set:function(t){this._pieceClass=t},enumerable:!1,configurable:!0}),t})(),VideoStatic=(e=>{function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._cycle=0,t._frameSelect=!1,t}return __extends(t,e),t.prototype.render=function(t,e,n){this._wrapper1=this.generate(t,e,n),this._wrapper2=this.generate(t,e,n),this.addChild(this._wrapper1),this.addChild(this._wrapper2)},t.prototype.generate=function(t,e,n){for(var i=new createjs.Container,r=(i.name="noise",new createjs.Shape),o=(r.setBounds(0,0,t,e),t/n/2),s=e/n/2,a=0;a<n;a++)for(var u=0;u<n;u++){var c=DBLUtils.toInt(192*Math.random()),c=createjs.Graphics.getRGB(c,c,c);r.graphics.beginFill(c),r.graphics.drawRect(a*o,u*s,o,s),r.graphics.endFill()}return r.scaleX=r.scaleY=2,r.x=-t/2,r.y=-e/2,i.addChild(r),i},Object.defineProperty(t.prototype,"enable",{set:function(t){(this.visible=t)&&(this._wrapper1.visible=this._frameSelect,this._wrapper2.visible=!this._frameSelect)},enumerable:!1,configurable:!0}),t.prototype.tick24=function(){this.visible&&this._wrapper1&&(this._frameSelect&&(this._cycle=(this._cycle+1)%4),this._wrapper1.scaleX=1&this._cycle?1:-1,this._wrapper1.scaleY=2&this._cycle?1:-1,this._wrapper2.scaleX=1&this._cycle?1:-1,this._wrapper2.scaleY=2&this._cycle?1:-1,this._wrapper1.visible=this._frameSelect,this._wrapper2.visible=!this._frameSelect,this._frameSelect=!this._frameSelect)},t})(createjs.Container),GeneratorBase=(()=>{function t(){this._current=t.__idGen,t.__idGen++,this.configure(this.defaultConfigurationObject)}return t.prototype.configure=function(t){this._configurationObject=t},Object.defineProperty(t.prototype,"defaultConfigurationObject",{get:function(){return{}},enumerable:!1,configurable:!0}),t.prototype.generateQuestion=function(){return new Question},t.prototype.generateCorrectValue=function(){return new Answer(!0)},t.prototype.generateIncorrectValue=function(){return new Answer(!1)},t.prototype.generateRandomValue=function(t){return void 0===t&&(t=.5),Math.random()<t?this.generateCorrectValue():this.generateIncorrectValue()},Object.defineProperty(t.prototype,"level",{get:function(){return this._level},set:function(t){this._level=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t+" "+this._current},enumerable:!1,configurable:!0}),t.prototype.randomBetween=function(t,e){return RandomUtil.randomBetween(t,e)},t.prototype.randomBetweenExcluding=function(t,e,n){return RandomUtil.randomBetweenExcluding(t,e,n)},t.prototype.updateArrayWith=function(t,e,n){return ArrayUtil.updateArrayWith(t,e,n)},t.prototype.remove=function(t,e){return ArrayUtil.remove(t,e)},t.__idGen=0,t})(),AminusBGenerator=(e=>{function t(){var t=e.call(this)||this;return t._recentMinuends=[],t._recentQuestions=[],t}return __extends(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,t),this._minValue=t.min,this._maxValue=t.max,this._buffer=t.maxBuffer},t.prototype.generateQuestion=function(){return this._recentMinuends=[],this._reference=this.randomBetweenExcluding(this._minValue,this._maxValue,this._recentQuestions),this.updateArrayWith(this._recentQuestions,this._reference,Math.min(5,this._maxValue-this._minValue)),new SimpleQuestion(t.DEFAULT_INSTRUCTION,this._reference)},t.prototype.generateCorrectValue=function(){var t=Math.max(this._maxValue,this._reference+this._buffer),t=this.randomBetweenExcluding(this._reference,t,this._recentMinuends);return this.updateArrayWith(this._recentMinuends,t,Math.min(5,this._maxValue-this._reference)),new ExpressionAnswer(this.build(t,t-this._reference),!0)},t.prototype.generateIncorrectValue=function(){var t=Math.max(this._maxValue,this._reference+this._buffer),t=this.randomBetween(this._reference,t),e=this.randomBetweenExcluding(this._minValue,t,[t-this._reference]);return new ExpressionAnswer(this.build(t,e),!1)},t.prototype.build=function(t,e){return t.toString()+"-"+e.toString()},Object.defineProperty(t.prototype,"defaultConfigurationObject",{get:function(){return{min:1,max:10}},enumerable:!1,configurable:!0}),t.DEFAULT_INSTRUCTION="numbers equal to",t})(GeneratorBase),AplusBGenerator=(e=>{function t(){var t=e.call(this)||this;return t._recent=[],t}return __extends(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,t),this._minValue=t.min,this._maxValue=t.max},t.prototype.generateQuestion=function(){return this._reference=this.randomBetween(this._minValue,this._maxValue),new SimpleQuestion(t.DEFAULT_INSTRUCTION,this._reference)},t.prototype.generateCorrectValue=function(){var t=this.randomBetweenExcluding(0,this._reference,this._recent);return this.updateRecentWith(t),new ExpressionAnswer(this.splitTotal(this._reference,t),!0)},t.prototype.generateIncorrectValue=function(){var t=this.randomBetweenExcluding(this._minValue,this._maxValue,[this._reference]),e=(this.updateRecentWith(t),this.randomBetween(0,t));return new ExpressionAnswer(this.splitTotal(t,e),!1)},t.prototype.splitTotal=function(t,e){t-=e;return e.toString()+"+"+t.toString()},t.prototype.updateRecentWith=function(t){this.updateArrayWith(this._recent,t,Math.min(this._reference,3))},Object.defineProperty(t.prototype,"defaultConfigurationObject",{get:function(){return{min:2,max:10}},enumerable:!1,configurable:!0}),t.DEFAULT_INSTRUCTION="numbers equal to",t})(GeneratorBase),AplusXGenerator=(e=>{function t(){return e.call(this)||this}return __extends(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,t),this._minValue=t.min,this._maxValue=t.max},t.prototype.generateQuestion=function(){var t=this.randomBetween(this._minValue+2,this._maxValue),e=this.randomBetween(this._minValue,t-1);return this._reference=t-e,new ExpressionQuestion(e+" + ? = "+t)},t.prototype.generateCorrectValue=function(){return new NumericAnswer(this._reference,!0)},t.prototype.generateIncorrectValue=function(){var t=this.randomBetweenExcluding(this._minValue,this._maxValue,[this._reference]);return new NumericAnswer(t,!1)},Object.defineProperty(t.prototype,"defaultConfigurationObject",{get:function(){return{min:2,max:10}},enumerable:!1,configurable:!0}),t})(GeneratorBase),MultOfTenMoreGenerator=(e=>{function t(){return e.call(this)||this}return __extends(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,t),this._minValue=t.min,this._maxValue=t.max},t.prototype.generateQuestion=function(){return this._referenceTens=this.randomBetween(1,(this._maxValue-1)/10-1),this._starting=this.randomBetween(1,this._maxValue-10-10*this._referenceTens),new StackedQuestion(10*this._referenceTens,translate("more than"),this._starting)},t.prototype.generateCorrectValue=function(){return new NumericAnswer(this._starting+10*this._referenceTens,!0)},t.prototype.generateIncorrectValue=function(){var t=this.randomBetweenExcluding(1,(this._maxValue-this._starting)/10,[this._referenceTens]);return new NumericAnswer(this._starting+10*t,!1)},Object.defineProperty(t.prototype,"defaultConfigurationObject",{get:function(){return{min:1,max:500}},enumerable:!1,configurable:!0}),t})(GeneratorBase),ComparisonDataSet=(()=>{function t(){}return t.prototype.generateQuestion=function(){return new ComparisonValue},t.prototype.configure=function(t){this._minValue=t.min,this._maxValue=t.max},t})(),ComparisonValue=function(){},FractionsDataSet=(DBLRuntime.requireLibrary("library.fractions"),(e=>{function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.generateQuestion=function(){var t=new ComparisonValue,e=ComparisonUtil.randomFraction(this._minValue,this._maxValue,this._denominators),n=ComparisonUtil.randomFraction(this._minValue,this._maxValue,this._denominators);return t.operation=ComparisonUtil.getOperationFraction(e,n),t.leftSide=e,t.rightSide=n,t},t.prototype.configure=function(t){e.prototype.configure.call(this,t),this._denominators=t.denominators},t})(ComparisonDataSet)),NumbersDataSet=(e=>{function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.generateQuestion=function(){var t=new ComparisonValue,e=RandomUtil.randomBetween(this._minValue,this._maxValue),n=RandomUtil.randomBetween(this._minValue,this._maxValue);return t.operation=ComparisonUtil.getOperation(e,n),1<this._numParts?(t.leftSide=ComparisonUtil.split(e,this._numParts),t.rightSide=ComparisonUtil.split(n,this._numParts)):(t.leftSide=e,t.rightSide=n),t},t.prototype.configure=function(t){e.prototype.configure.call(this,t),this._numParts=t.numParts},t})(ComparisonDataSet),CompareGenerator=(e=>{function t(){var t=e.call(this)||this;return t._recentCorrect=[],t._recentIncorrect=[],t._recentReference=[],t}return __extends(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,t),this._minValue=t.min,this._maxValue=t.max,this._referenceMin=t.referenceMin,this._referenceMax=t.referenceMax,this._operation=t.operation},t.prototype.generateQuestion=function(){var t=this.randomBetweenExcluding(this._referenceMin,this._referenceMax,this._recentReference);switch(this.updateArrayWith(this._recentReference,t,Math.min(5,this._referenceMax-this._referenceMin)),this._operation){case"greater":this._minCorrect=t+1,this._maxCorrect=this._maxValue,this._minIncorrect=this._minValue,this._maxIncorrect=t-1;break;case"less":this._minCorrect=this._minValue,this._maxCorrect=t-1,this._minIncorrect=t+1,this._maxIncorrect=this._maxValue}return this._recentCorrect=[],this._recentIncorrect=[],new SimpleQuestion("numbers "+this._operation+" than",t)},t.prototype.generateCorrectValue=function(){var t=this.randomBetweenExcluding(this._minCorrect,this._maxCorrect,this._recentCorrect);return this.updateArrayWith(this._recentCorrect,t,Math.min(5,this._maxCorrect-this._minCorrect)),new NumericAnswer(t,!0)},t.prototype.generateIncorrectValue=function(){var t=this.randomBetweenExcluding(this._minIncorrect,this._maxIncorrect,this._recentIncorrect);return this.updateArrayWith(this._recentIncorrect,t,Math.min(5,this._maxIncorrect-this._minIncorrect)),new NumericAnswer(t,!1)},Object.defineProperty(t.prototype,"defaultConfigurationObject",{get:function(){return{min:1,max:10,referenceMin:4,referenceMax:7,operation:"greater"}},enumerable:!1,configurable:!0}),t})(GeneratorBase),ComparisonSymbolGenerator=(n=>{function i(){return n.call(this)||this}return __extends(i,n),i.prototype.configure=function(t){n.prototype.configure.call(this,t);var e=i.DATA_SETS[t.type.toLowerCase()];e&&(this._dataSet=new e,this._dataSet.configure(t))},i.prototype.generateQuestion=function(){var t=this._dataSet.generateQuestion();return this._referenceOperation=t.operation,new ComparisonQuestion(t.leftSide,t.rightSide)},i.prototype.generateCorrectValue=function(){return new SymbolAnswer(this._referenceOperation,!0)},i.prototype.generateIncorrectValue=function(){var t=[this._referenceOperation];return null!=this._generatedIncorrect&&t.push(this._generatedIncorrect),t=this.remove(i.ALL_OPERATIONS,t),this._generatedIncorrect=RandomUtil.randomElement(t),new SymbolAnswer(this._generatedIncorrect,!1)},Object.defineProperty(i.prototype,"defaultConfigurationObject",{get:function(){return{numParts:1,min:1,max:20,type:i.TYPE_NUMBERS}},enumerable:!1,configurable:!0}),i.ALL_OPERATIONS=[">","<","="],i.DATA_SETS={numbers:NumbersDataSet,fractions:FractionsDataSet},i.TYPE_NUMBERS="numbers",i.TYPE_FRACTIONS="fractions",i})(GeneratorBase),ComparisonUtil=(DBLRuntime.requireLibrary("library.fractions"),(()=>{function t(){}return t.split=function(t,e){switch(e){case 1:return t.toString();case 2:var n=RandomUtil.randomBetween(0,t);return n+"+"+(t-n)}return t.toString()},t.getOperation=function(t,e){return t==e?"=":e<t?">":"<"},t.getOperationFraction=function(t,e){return t.isEqualTo(e)?"=":t.gt(e)?">":"<"},t.randomFraction=function(t,e,n){n=RandomUtil.randomElement(n),t=RandomUtil.randomBetween(Math.max(t*n,1),e*n);return new fractions.DBLFraction(t,n)},t})()),FourAdditionGenerator=(e=>{function t(){var t=e.call(this)||this;return t._recentQuestion=[],t._recentAddend=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"sum",{get:function(){return this._sum},enumerable:!1,configurable:!0}),t.prototype.generateQuestion=function(){for(;this._sum=10*this.randomBetween(3,9),0<=this._recentQuestion.indexOf(this._sum););return 3<this._recentQuestion.length&&this._recentQuestion.shift(),this._recentQuestion.push(this._sum),new SimpleQuestion("an expression equal to",this._sum)},t.prototype.generateCorrectValue=function(){var t="";do{var e,n=10-(e=this.randomBetween(1,9)),i=10*this.randomBetween(1,this._sum/10-2),t=(e+=i)+"+"+(n+=this._sum-i-10)}while(0<=this._recentAddend.indexOf(e));return 5<this._recentAddend.length&&this._recentAddend.shift(),this._recentAddend.push(e),new ExpressionAnswer(t,!0)},t.prototype.generateIncorrectValue=function(){for(var t,e,n="";(t=this.randomBetween(10,this._sum-10))+(e=this.randomBetween(10,this._sum-10))==this._sum&&(t+=1),n=t+"+"+e,0<=this._recentAddend.indexOf(t););return 5<this._recentAddend.length&&this._recentAddend.shift(),this._recentAddend.push(t),new ExpressionAnswer(n,!1)},t})(GeneratorBase),FourDivisionGenerator=(e=>{function t(){var t=e.call(this)||this;return t._recentQuestion=[],t._recentDividend=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"remainder",{get:function(){return this._remainder},enumerable:!1,configurable:!0}),t.prototype.calculateDividends=function(){var t,e,n;for(this._possibleDividends=[],e=this._remainder+1;e<10;e++)for(t=10;t<10*e;t++)t%e==0&&((n=new Object).dividend=t,n.divisor=e,this._possibleDividends.push(n));this._possibleDividends=FourUtils.randomize2(this._possibleDividends)},t.prototype.generateQuestion=function(){for(;this._remainder=this.randomBetween(1,5),this.calculateDividends(),0<=this._recentQuestion.indexOf(this._remainder););return 2<this._recentQuestion.length&&this._recentQuestion.shift(),this._recentQuestion.push(this._remainder),new SimpleQuestion("an expression with a remainder of",this._remainder)},t.prototype.generateCorrectValue=function(){var t="";do{0==this._possibleDividends.length&&this.calculateDividends();var e=this._possibleDividends.pop(),n=e.dividend+this.remainder,e=e.divisor,t=(this.remainder,n.toString()+""+e.toString())}while(0<=this._recentDividend.indexOf(n));return 5<this._recentDividend.length&&this._recentDividend.shift(),this._recentDividend.push(n),new ExpressionAnswer(t,!0)},t.prototype.generateIncorrectValue=function(){for(var t,e,n="";(t=this.randomBetween(10,99))%(e=this.randomBetween(1,9))==this._remainder&&(t+=1),n=t.toString()+""+e.toString(),0<=this._recentDividend.indexOf(t););return 5<this._recentDividend.length&&this._recentDividend.shift(),this._recentDividend.push(t),new ExpressionAnswer(n,!1)},t})(GeneratorBase),FourMultiplicationGenerator=(e=>{function t(){var t=e.call(this)||this;return t._recentQuestion=[],t._recentMultiplicand=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"product",{get:function(){return this._product},enumerable:!1,configurable:!0}),t.prototype.configure=function(t){e.prototype.configure.call(this,t),this._answerType=t.answerType},t.prototype.generateProductSet=function(){for(var t=[],e=10;e<100;e++){var n,i=void 0;(3<(i="multi"==this._answerType?FourUtils.getAllFactorArray(e,"basicFactExtra"):"single"==this._answerType?FourUtils.getAllFactorArray(e,"basicFact"):FourUtils.getAllFactorArray(e,"all")).length||"single"==this._answerType&&0<i.length)&&((n={}).factors=i.concat(),n.product=e,t.push(n))}return t},t.prototype.generateQuestion=function(){this._productSet=this.generateProductSet();for(var t=0;t=this.randomBetween(0,this._productSet.length-1),0<=this._recentQuestion.indexOf(t););return 3<this._recentQuestion.length&&this._recentQuestion.shift(),this._recentQuestion.push(t),this._productZeroes=this.randomBetween(2,3),this._product=this._productSet[t].product*(3==this._productZeroes?1e3:100),this._factorsSet=this._productSet[t].factors,this._factorsCurrent=FourUtils.randomize2(this._factorsSet),new SimpleQuestion("an expression equal to",this._product)},t.prototype.generateCorrectValue=function(){var t,e;do{0==this._factorsCurrent.length&&(this._factorsCurrent=FourUtils.randomize2(this._factorsSet));var n=FourUtils.takeOne(this._factorsCurrent),i=RandomUtil.coinFlip()?(e=n[0],n[1]):(e=n[1],n[0])}while(0<=this._recentMultiplicand.indexOf(e));2<this._recentMultiplicand.length&&this._recentMultiplicand.shift(),"single"!=this._answerType&&this._recentMultiplicand.push(e);var r=this._productZeroes;for(e*=10,i*=10,r-=2;0<r;)0==this.randomBetween(0,1)?e*=10:i*=10,r--;return t=e.toString()+""+i.toString(),new ExpressionAnswer(t,!0)},t.prototype.generateIncorrectValue=function(){var t=10*this.randomBetween(1,20),e=10*this.randomBetween(1,20);return t*e==this._product&&(t+=10),t=t.toString()+""+e.toString(),new ExpressionAnswer(t,!1)},t})(GeneratorBase),FourSubtractionGenerator=(e=>{function t(){var t=e.call(this)||this;return t._recentQuestion=[],t._recentMinuend=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"difference",{get:function(){return this._difference},enumerable:!1,configurable:!0}),t.prototype.generateQuestion=function(){for(;this._difference=this.randomBetween(5,12),10==this._difference&&(this._difference+=1),0<=this._recentQuestion.indexOf(this._difference););return 3<this._recentQuestion.length&&this._recentQuestion.shift(),this._recentQuestion.push(this._difference),new SimpleQuestion("an expression equal to",this._difference)},t.prototype.generateCorrectValue=function(){var t="";do{var e,n=10<this._difference?this._difference-10:this._difference,i=this.randomBetween(10-n,9),r=10*this.randomBetween(1,7),t=(e=r+(10<this._difference?20:10)+(i+n-10))+"-"+(r+i)}while(0<=this._recentMinuend.indexOf(e));return 5<this._recentMinuend.length&&this._recentMinuend.shift(),this._recentMinuend.push(e),new ExpressionAnswer(t,!0)},t.prototype.generateIncorrectValue=function(){for(var t,e,n="";(t=this.randomBetween(20,99))-(e=this.randomBetween(t-15,t))==this._difference&&(t+=1),n=t+"-"+e,0<=this._recentMinuend.indexOf(t););return 5<this._recentMinuend.length&&this._recentMinuend.shift(),this._recentMinuend.push(t),new ExpressionAnswer(n,!1)},t})(GeneratorBase),FourUtils=(()=>{function t(){}return t.randomize2=function(t){for(var e,n=t.concat(),i=[],r=0;r<n.length;r++)e=Math.floor(Math.random()*n.length),i.push(n[e]),n.splice(e,1),r--;return i},t.takeOne=function(t){return 0==t.length?null:t.pop()},t.isBasicFact=function(t,e){return t<10&&e<10},t.isBasicFactExtra=function(t,e){return t<13&&e<13||t<13&&15==e||15==t&&t<13},t.getAllFactorArray=function(t,e){void 0===e&&(e="all");for(var n,i,r=[],o=1;o*o<=t;o++)t%o==0&&(i=t/(n=o),"all"==e.toLowerCase()?r.push([n,i]):"basicfact"==e.toLowerCase()?this.isBasicFact(n,i)&&r.push([n,i]):"basicfactextra"==e.toLowerCase()&&this.isBasicFactExtra(n,i)&&(r.push([n,i]),n!=i)&&r.push([i,n]));return r},t})(),DEFAULT_INSTRUCTION="fractions equivalent to",EquivalentFractionsGenerator=(e=>{function t(){var t=e.call(this)||this;return t._recentMultiples=[],t._recentDenominators=[],t._multipleMin=2,t._multipleMax=12,t}return __extends(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,t),this._denominators=t.denominators},t.prototype.generateQuestion=function(){var t=this.randomBetweenExcluding(0,this._denominators.length-1,this._recentDenominators);return this.updateArrayWith(this._recentDenominators,t,this._denominators.length-1),this._referenceDenominator=this._denominators[t],this._referenceNumerator=this.randomBetween(1,this._referenceDenominator),new FractionQuestion(DEFAULT_INSTRUCTION,this._referenceNumerator,this._referenceDenominator)},t.prototype.generateCorrectValue=function(){var t=this.randomBetweenExcluding(this._multipleMin,this._multipleMax,this._recentMultiples),e=(this.updateArrayWith(this._recentMultiples,t,this._multipleMax-this._multipleMin),this._referenceNumerator*t),t=this._referenceDenominator*t;return new FractionAnswer(e,t,!0)},t.prototype.generateIncorrectValue=function(){var t=this.randomBetween(this._multipleMin,this._multipleMax),e=this.randomBetweenExcluding(this._multipleMin,this._multipleMax,[t]),t=this._referenceNumerator*t,e=this._referenceDenominator*e;return new FractionAnswer(t,e,!1)},Object.defineProperty(t.prototype,"defaultConfigurationObject",{get:function(){return{denominators:[2,3,4,5,6,8,10,12]}},enumerable:!1,configurable:!0}),t})(GeneratorBase),Fraction=(DBLRuntime.requireLibrary("library.fractions"),(i=>{function t(t,e){var n=i.call(this)||this;return n._numerator=t,n._denominator=e,n}return __extends(t,i),Object.defineProperty(t.prototype,"numerator",{get:function(){return this._numerator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"denominator",{get:function(){return this._denominator},enumerable:!1,configurable:!0}),t.prototype.equals=function(t){return this.compare(fractions.DBLFraction.build(this._numerator,this._denominator),"=",t)},t.prototype.lessThan=function(t){return this.compare(fractions.DBLFraction.build(this._numerator,this._denominator),"<",t)},t.prototype.greaterThan=function(t){return this.compare(fractions.DBLFraction.build(this._numerator,this._denominator),">",t)},t.prototype.toString=function(){return this.numerator+" / "+this.denominator},t.prototype.compare=function(t,e,n){var i=t.numerator*n.denominator,r=t.denominator*n.numerator;switch(e){case"=":return i==r;case">":return r<i;case"<":return i<r}return!1},t})(GeneratorBase)),LiteracyGenerator=(e=>{function t(){return e.call(this)||this}return __extends(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,t)},t.prototype.generateQuestion=function(){var e=this,t=(this._csvAllData||(this._csvAllData=this.fileLoader.getCSV(this.configurationObject.fqn)),this._csvAllData.filter(function(t){return t.grade==e.configurationObject.grade})),n=t.length,t=t[this.randomBetween(0,n-1)];return this._correctAnswers=t.corrects.split(","),this._incorrectAnswers=t.distractors.split(","),new WordExpressionQuestion(this.configurationObject.question,t.word)},t.prototype.generateCorrectValue=function(){var t=this._correctAnswers.length,t=this._correctAnswers[this.randomBetween(0,t-1)];return new ExpressionAnswer(t,!0)},t.prototype.generateIncorrectValue=function(){var t=this._incorrectAnswers.length,t=this._incorrectAnswers[this.randomBetween(0,t-1)];return new ExpressionAnswer(t,!1)},Object.defineProperty(t.prototype,"defaultConfigurationObject",{get:function(){return{}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"configurationObject",{get:function(){return this._configurationObject},enumerable:!1,configurable:!0}),t})(GeneratorBase),GeneratorList=(()=>{function o(){this._generators=[]}return o.prototype.add=function(t,e,n,i,r){this.addNode(new GeneratorListNode(t,e,n,i,r))},o.prototype.getAt=function(t){return t<0||t>=this._generators.length?null:this._generators[t].instance},o.prototype.filterByQuestionTypes=function(t){var e=new o;if(t)for(var n=0;n<this._generators.length;n++){var i=this._generators[n];0<=t.indexOf(i.questionType)&&e.addNode(i)}return e},o.prototype.filterByMiniGameType=function(t){for(var e=new o,n=0;n<this._generators.length;n++){var i=this._generators[n];-1==i.unsupportedMiniGameTypes.indexOf(t)&&e.addNode(i)}return e},o.prototype.limitToLast=function(t){var e=this._generators.sort(function(t,e){return e.sortValue-t.sortValue}),n=new o;t=Math.min(t,e.length);for(var i=0;i<t;i++){var r=e[i];n.addNode(r)}return n},o.prototype.getRandom=function(){return this.getAt(DBLUtils.toInt(Math.random()*this.length))},Object.defineProperty(o.prototype,"length",{get:function(){return this._generators.length},enumerable:!1,configurable:!0}),o.prototype.addNode=function(t){this._generators.push(t)},o.prototype.toString=function(){return"GeneratorList\n\t"+this._generators.join("\n\t")},o})(),GeneratorListNode=(()=>{function t(t,e,n,i,r){this._instance=null,this.questionType=t,this.sortValue=e,this.unsupportedMiniGameTypes=n,this._generatorClass=i,this._configurationObject=r}return Object.defineProperty(t.prototype,"instance",{get:function(){return null==this._instance&&(this._instance=new this._generatorClass,this._instance.configure(this._configurationObject),this._instance.id=this._generatorClass.name+" "+this.questionType),this._instance},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return""},t})(),MultDivFormatMap=(()=>{function t(){this._formats=[]}return t.prototype.add=function(t,e,n){this._formats.push(new MultDivFormatMapNode(t,e,n))},t.prototype.get=function(t,e){for(var n=0;n<this._formats.length;n++){var i=this._formats[n];if(i.operation==t&&i.missing==e)return i.formatter}return null},t})(),MultDivFormatMapNode=function(t,e,n){this.operation=t,this.missing=e,this.formatter=n},MultDivGenerator=(e=>{function t(){var t=e.call(this)||this;return t._rangeMap={},t._formatMap=new MultDivFormatMap,t._formatMap.add("*","c",function(t){return t.a+"  "+t.b+" = ?"}),t._formatMap.add("*","b",function(t){return t.a+"  ? = "+t.c}),t._formatMap.add("/","a",function(t){return t.c+"  ? = "+t.b}),t._formatMap.add("/","b",function(t){return t.c+"  "+t.a+" = ?"}),t}return __extends(t,e),t.prototype.configure=function(t){e.prototype.configure.call(this,t),this._missingletiable=t.missing,this._operation=t.operation,this._rangeMap||(this._rangeMap={}),this._rangeMap.a={min:2,max:12},this._rangeMap.b={min:2,max:12},this._rangeMap.c={min:1,max:100}},t.prototype.generateQuestion=function(){var t={},e=(t.a=this.randomBetween(this._rangeMap.a.min,this._rangeMap.a.max),t.b=this.randomBetween(this._rangeMap.b.min,DBLUtils.toInt(this._rangeMap.c.max/this._rangeMap.b.max)),t.c=t.a*t.b,this._reference=t[this._missingletiable],this._formatMap.get(this._operation,this._missingletiable));return new ExpressionQuestion(e.apply(this,[t]))},t.prototype.generateCorrectValue=function(){return new NumericAnswer(this._reference,!0)},t.prototype.generateIncorrectValue=function(){var t=this.randomBetweenExcluding(this._rangeMap[this._missingletiable].min,this._rangeMap[this._missingletiable].max,[this._reference]);return new NumericAnswer(t,!1)},Object.defineProperty(t.prototype,"defaultConfigurationObject",{get:function(){return{missing:"c",operation:""}},enumerable:!1,configurable:!0}),t.DEFAULT_INSTRUCTION="find ? in",t})(GeneratorBase),MultipleGenerator=(e=>{function t(){var t=e.call(this)||this;return t._recent=[],t}return __extends(t,e),t.prototype.generateQuestion=function(){return this._multiple=DBLUtils.toInt(11*Math.random())+2,new SimpleQuestion("multiples of",this._multiple)},t.prototype.generateCorrectValue=function(){for(var t;t=this._multiple*(DBLUtils.toInt(11*Math.random())+2),0<=this._recent.indexOf(t););return 5<this._recent.length&&this._recent.shift(),this._recent.push(t),new NumericAnswer(t,!0)},t.prototype.generateIncorrectValue=function(){for(var t;t=this._multiple*(DBLUtils.toInt(11*Math.random())+2),t-=DBLUtils.toInt(Math.random()*(this._multiple-1))+1,0<=this._recent.indexOf(t););return 5<this._recent.length&&this._recent.shift(),this._recent.push(t),new NumericAnswer(t,!1)},t})(GeneratorBase),FibonacciGenerator=(n=>{function t(){var t=n.call(this)||this;t._good=[1,2],t._recent=[];for(var e=0;e<10;e++)t._good.push(t._good[t._good.length-2]+t._good[t._good.length-1]);return t}return __extends(t,n),t.prototype.generateQuestion=function(){return new ExpressionQuestion("fibonacci numbers")},t.prototype.generateCorrectValue=function(){for(var t;t=this._good[DBLUtils.toInt(Math.random()*this._good.length)],0<=this._recent.indexOf(t););return 5<this._recent.length&&this._recent.shift(),this._recent.push(t),new NumericAnswer(t,!0)},t.prototype.generateIncorrectValue=function(){for(var t;t=1+DBLUtils.toInt(Math.random()*this._good[this._good.length-1]),0<=this._good.indexOf(t)||0<=this._recent.indexOf(t););return 5<this._recent.length&&this._recent.shift(),this._recent.push(t),new NumericAnswer(t,!1)},t})(GeneratorBase),PrimeGenerator=(e=>{function t(){var t=e.call(this)||this;return t._prime=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139],t._recent=[],t}return __extends(t,e),t.prototype.generateQuestion=function(){return new ExpressionQuestion("prime numbers")},t.prototype.generateCorrectValue=function(){for(var t;t=this._prime[DBLUtils.toInt(Math.random()*this._prime.length)],0<=this._recent.indexOf(t););return 5<this._recent.length&&this._recent.shift(),this._recent.push(t),new NumericAnswer(t,!0)},t.prototype.generateIncorrectValue=function(){for(var t;t=2+DBLUtils.toInt(Math.random()*this._prime[this._prime.length-1]),0<=this._prime.indexOf(t)||0<=this._recent.indexOf(t););return 5<this._recent.length&&this._recent.shift(),this._recent.push(t),new NumericAnswer(t,!1)},t})(GeneratorBase),PlaceValueGenerator=(e=>{function n(){var t=e.call(this)||this;return t._recent=[],t._placeValueMinMax={},t}return __extends(n,e),n.prototype.configure=function(t){e.prototype.configure.call(this,t),this._placeValue=t.placeValue,this._minToTheLeft=DBLUtils.toInt(t.min/(10*this._placeValue)),this._maxToTheLeft=DBLUtils.toInt(t.max/(10*this._placeValue))},n.prototype.generateQuestion=function(){this._reference=this.randomBetweenExcluding(1,9,[this._recent]),this.updateRecentWith(this._reference);var t=8==this._reference?n.INSTRUCTION1_EIGHT:n.INSTRUCTION1;return new InlineQuestion(t,this._reference,n.INSTRUCTION2)},n.prototype.generateCorrectValue=function(){var t=this.randomWithPlaceValue(this._reference);return new NumericAnswer(t,!0)},n.prototype.generateIncorrectValue=function(){var t=this.randomBetweenExcluding(0,9,[this._reference]),t=this.randomWithPlaceValue(t);return new NumericAnswer(t,!1)},n.prototype.randomWithPlaceValue=function(t){return this.randomBetween(this._minToTheLeft,this._maxToTheLeft)*(10*this._placeValue)+this._placeValue*t+this.randomBetween(0,this._placeValue-1)},n.prototype.updateRecentWith=function(t){this.updateArrayWith(this._recent,t,3)},Object.defineProperty(n.prototype,"defaultConfigurationObject",{get:function(){return{min:10,max:99,placeValue:10}},enumerable:!1,configurable:!0}),n.INSTRUCTION1="numbers with a",n.INSTRUCTION1_EIGHT="numbers with an",n.INSTRUCTION2="in the tens place",n.MAX_PLACE_VALUE=1e3,n})(GeneratorBase),Answer=(()=>{function t(t){this._correct=t,this._valid=!0}return Object.defineProperty(t.prototype,"correct",{get:function(){return this._correct},set:function(t){this._correct=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return this._valid},set:function(t){this._valid=t},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return""},t})(),Question=(()=>{function t(){}return t.prototype.translate=function(t){},t.prototype.toString=function(){return""},t})(),ComparisonQuestion=(i=>{function t(t,e){var n=i.call(this)||this;return n._leftSide=t,n._rightSide=e,n}return __extends(t,i),t.prototype.translate=function(t){},Object.defineProperty(t.prototype,"leftSide",{get:function(){return this._leftSide},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightSide",{get:function(){return this._rightSide},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.leftSide+" : "+this.rightSide},t})(Question),ExpressionAnswer=(n=>{function t(t,e){e=n.call(this,e)||this;return e._expression=t,e}return __extends(t,n),Object.defineProperty(t.prototype,"expression",{get:function(){return this._expression},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.expression},t})(Answer),ExpressionQuestion=(n=>{function t(t){var e=n.call(this)||this;return e._expression=t,e}return __extends(t,n),t.prototype.translate=function(t){},Object.defineProperty(t.prototype,"expression",{get:function(){return this._expression},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._expression},t})(Question),FractionAnswer=(i=>{function t(t,e,n){n=i.call(this,n)||this;return n._numerator=t,n._denominator=e,n}return __extends(t,i),Object.defineProperty(t.prototype,"numerator",{get:function(){return this._numerator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"denominator",{get:function(){return this._denominator},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.numerator+" / "+this.denominator},t})(Answer),FractionQuestion=(r=>{function t(t,e,n){var i=r.call(this)||this;return i._instructions=t,i._numerator=e,i._denominator=n,i}return __extends(t,r),t.prototype.translate=function(t){this._instructions=t(this._instructions)},Object.defineProperty(t.prototype,"instructions",{get:function(){return this._instructions},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"numerator",{get:function(){return this._numerator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"denominator",{get:function(){return this._denominator},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._instructions+" "+this._numerator+"/"+this._denominator},t})(Question),InlineQuestion=(r=>{function t(t,e,n){var i=r.call(this)||this;return i._instructions1=t,i._value=e,i._instructions2=n,i}return __extends(t,r),t.prototype.translate=function(t){this._instructions1=t(this._instructions1),this._instructions2=t(this._instructions2)},Object.defineProperty(t.prototype,"instructions1",{get:function(){return this._instructions1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"instructions2",{get:function(){return this._instructions2},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._instructions1+" "+this._value.toString()+" "+this._instructions2},t})(Question),NumericAnswer=(n=>{function t(t,e){e=n.call(this,e)||this;return e._number=t,e}return __extends(t,n),Object.defineProperty(t.prototype,"number",{get:function(){return this._number},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.number.toString()},t})(Answer),SimpleQuestion=(i=>{function t(t,e){var n=i.call(this)||this;return n._instructions=t,n._number=e,n}return __extends(t,i),t.prototype.translate=function(t){this._instructions=t(this._instructions)},Object.defineProperty(t.prototype,"instructions",{get:function(){return this._instructions},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"number",{get:function(){return this._number},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._instructions+" "+this._number},t})(Question),StackedQuestion=(r=>{function t(t,e,n){var i=r.call(this)||this;return i._topValue=t,i._instructions=e,i._bottomValue=n,i}return __extends(t,r),t.prototype.translate=function(t){this._instructions=t(this._instructions)},Object.defineProperty(t.prototype,"topValue",{get:function(){return this._topValue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"instructions",{get:function(){return this._instructions},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottomValue",{get:function(){return this._bottomValue},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._topValue+" "+this._instructions+" "+this._bottomValue},t})(Question),SymbolAnswer=(n=>{function t(t,e){e=n.call(this,e)||this;return e._symbol=t,e}return __extends(t,n),Object.defineProperty(t.prototype,"symbol",{get:function(){return this._symbol},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.symbol},t})(Answer),WordExpressionQuestion=(i=>{function t(t,e){var n=i.call(this)||this;return n._instructions=t,n._word=e,n}return __extends(t,i),t.prototype.translate=function(t){this._instructions=t(this._instructions)},Object.defineProperty(t.prototype,"instructions",{get:function(){return this._instructions},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"word",{get:function(){return this._word},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._instructions+" "+this._word},t})(Question),GeneratorManager=(()=>{function t(t){this._available=[],this._recent=[];var e,n=new GeneratorList;DBLDataUtils.isBookworm?(e=[DBLDataConstants.PREFIX_SUFFIX_ROOT,DBLDataConstants.PREFIX_SUFFIX_MATCH,DBLDataConstants.PREFIX_SUFFIX,DBLDataConstants.ROOT_WORD_MEANINGS],e.forEach(function(t){var e=__assign(__assign({},t),{grade:3});n.add(t.name,1,[],LiteracyGenerator,e)})):(n.add("P01A",1,[],CompareGenerator,{min:1,max:10,referenceMin:4,referenceMax:7,operation:"greater"}),n.add("P02D",2,[],CompareGenerator,{min:1,max:10,referenceMin:4,referenceMax:7,operation:"less"}),n.add("P03A",3,[],AplusBGenerator,{min:2,max:10}),n.add("P03A",4,[],AminusBGenerator,{min:1,max:10,maxBuffer:10}),n.add("P04C",5,[],CompareGenerator,{min:1,max:50,referenceMin:6,referenceMax:45,operation:"greater"}),n.add("P04C",6,[],CompareGenerator,{min:1,max:50,referenceMin:6,referenceMax:45,operation:"less"}),n.add("P05F",7,[],AplusBGenerator,{min:2,max:20}),n.add("P06E",8,[],AminusBGenerator,{min:1,max:20,maxBuffer:10}),n.add("P07C",9,[MinigameConstants.TYPE_MANY_TO_MANY],ComparisonSymbolGenerator,{min:1,max:100,numParts:1,type:"numbers"}),n.add("P08A",10,[MinigameConstants.TYPE_MANY_TO_MANY],ComparisonSymbolGenerator,{min:1,max:20,numParts:2,type:"numbers"}),n.add("P09D",11,[],PlaceValueGenerator,{min:10,max:99,placeValue:10}),n.add("P10B",12,[MinigameConstants.TYPE_MANY_TO_MANY],ComparisonSymbolGenerator,{min:1,max:50,numParts:2,type:"numbers"}),n.add("P11A",13,[],AminusBGenerator,{min:2,max:50,maxBuffer:10}),n.add("P12C",14,[],AplusBGenerator,{min:2,max:50}),n.add("P13C",15,[MinigameConstants.TYPE_MANY_TO_MANY],ComparisonSymbolGenerator,{min:1,max:500,numParts:1,type:"numbers"}),n.add("P14A",16,[MinigameConstants.TYPE_MANY_TO_MANY],MultOfTenMoreGenerator,{min:1,max:500}),n.add("P15A",17,[MinigameConstants.TYPE_MANY_TO_MANY],AplusXGenerator,{min:1,max:500}),n.add("P16A",18,[],PlaceValueGenerator,{min:10,max:999,placeValue:10}),n.add("P20A",19,[MinigameConstants.TYPE_MANY_TO_MANY],MultDivGenerator,{missing:"b",operation:"*"}),n.add("P21A",20,[MinigameConstants.TYPE_MANY_TO_MANY],MultDivGenerator,{missing:"c",operation:"*"}),n.add("P22A",21,[MinigameConstants.TYPE_MANY_TO_MANY],MultDivGenerator,{missing:"b",operation:"/"}),n.add("G04",22,[],MultipleGenerator,{min:2,max:12,productMax:144}),n.add("G23",23,[MinigameConstants.TYPE_MANY_TO_MANY],MultDivGenerator,{missing:"a",operation:"/"}),n.add("P32",24,[],EquivalentFractionsGenerator,{denominators:[2,3,4,5,6,8,10]}),n.add("P34",25,[MinigameConstants.TYPE_MANY_TO_MANY],ComparisonSymbolGenerator,{min:0,max:1,type:"fractions",denominators:[2,3,4,5,6,8,10]}),n.add("P41",26,[MinigameConstants.TYPE_MANY_TO_MANY],FourMultiplicationGenerator,{answerType:"single"}),n.add("P41",27,[MinigameConstants.TYPE_ONE_TO_ONE],FourMultiplicationGenerator,{answerType:"multi"}),n.add("P44",28,[],FourAdditionGenerator,{}),n.add("P45",29,[],FourSubtractionGenerator,{}),n.add("P47",30,[MinigameConstants.TYPE_MANY_TO_MANY],FourDivisionGenerator,{})),this._generatorsForMiniGame=n.filterByMiniGameType(t),this._availableGenerators=this._generatorsForMiniGame}return t.prototype.setConstraints=function(t){},Object.defineProperty(t.prototype,"openGamesets",{set:function(t){0<(t=t||[]).length&&"test"==t[0]?(t.shift(),this._availableGenerators=this._generatorsForMiniGame.filterByQuestionTypes(t)):(DBLDataUtils.isBookworm||(t=t.concat(["P01A","P02D","P03A"])),ArrayUtil.dedupe(t),this._availableGenerators=this._generatorsForMiniGame.filterByQuestionTypes(t),this._traceGenerators,this._availableGenerators=this._availableGenerators.limitToLast(5)),this._traceGenerators,this._availableGenerators.length},enumerable:!1,configurable:!0}),t.prototype.nextGenerator=function(){var t=this._availableGenerators.getRandom();return t.fileLoader=this.fileLoader,this._recent.push(t),this._current=t},Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!1,configurable:!0}),t})();