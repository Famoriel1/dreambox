var __spreadArray=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||((o=o||Array.prototype.slice.call(t,0,r))[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},__extends=this&&this.__extends||(()=>{var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}})(),__awaiter=this&&this.__awaiter||function(e,a,s,l){return new(s=s||Promise)(function(n,t){function o(e){try{i(l.next(e))}catch(e){t(e)}}function r(e){try{i(l.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,r)}i((l=l.apply(e,a||[])).next())})},__generator=this&&this.__generator||function(o,r){var i,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(n){return function(e){var t=[n,e];if(i)throw new TypeError("Generator is already executing.");for(;l=c&&t[c=0]?0:l;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))l.label=t[1];else if(6===t[0]&&l.label<s[1])l.label=s[1],s=t;else{if(!(s&&l.label<s[2])){s[2]&&l.ops.pop(),l.trys.pop();continue}l.label=s[2],l.ops.push(t)}}t=r.call(o,l)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},Loc,Loc,Loc,Loc,Loc,Loc,Loc,DBLActivityMonitor,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,a11y,DBLAlign,DBLAsset,DBLAudioUtils,DBLAutomation,DBLCapabilities,DBLClientEventManager,DBLComponentEvent=((Loc||(Loc={})).getAllValuesOfLcidProperty=function(e,t){var n,o=t=void 0===t?[]:t;for(n in Lcid.LCID){var r=Lcid.LCID[n][e];r&&-1===o.indexOf(r)&&o.push(r)}return o},(r=>{function n(e){if(e)for(var t=0,n=r.getLocaleOptions();t<n.length;t++){var o=e[n[t]];if(o)return o}return null}r.localizeBundle=function(e){var t;return null!=(t=n(o[e]))?t:e},r.localizeAsset=function(e,t){return null!=(e=n(null==(e=i[e])?void 0:e[t]))?e:t};var o={"assets.bundles.engagement.primary.screener.Assessment_Screener":{spanish:"assets.bundles.engagement.primary.screener.Assessment_Screener_es"},"assets.bundles.engagement.intermediate.screener.paperfrenzy.Assessment_Screener":{spanish:"assets.bundles.engagement.intermediate.screener.paperfrenzy.Assessment_Screener_es"},"assets.bundles.engagement.intermediate.screener.coolfrost.Assessment_Screener":{spanish:"assets.bundles.engagement.intermediate.screener.coolfrost.Assessment_Screener_es"},"assets.bundles.engagement.intermediate.screener.neon.Assessment_Screener":{spanish:"assets.bundles.engagement.intermediate.screener.neon.Assessment_Screener_es"},"assets.bundles.engagement.primary.screener.Assessment_ScreenerTransitions":{spanish:"assets.bundles.engagement.primary.screener.Assessment_ScreenerTransitions_es"},"assets.bundles.engagement.intermediate.screener.paperfrenzy.Assessment_ScreenerTransitions":{spanish:"assets.bundles.engagement.intermediate.screener.paperfrenzy.Assessment_ScreenerTransitions_es"},"assets.bundles.engagement.intermediate.screener.coolfrost.Assessment_ScreenerTransitions":{spanish:"assets.bundles.engagement.intermediate.screener.coolfrost.Assessment_ScreenerTransitions_es"},"assets.bundles.engagement.intermediate.screener.neon.Assessment_ScreenerTransitions":{spanish:"assets.bundles.engagement.intermediate.screener.neon.Assessment_ScreenerTransitions_es"}},i={"assets.bundles.engagement.intermediate.paperfrenzy.DBLACollections":{DBLACollectionLoading:{spanish:"DBLACollectionLoading_es"}},"assets.bundles.engagement.intermediate.coolfrost.DBLACollections":{DBLACollectionLoading:{spanish:"DBLACollectionLoading_es"}},"assets.bundles.engagement.intermediate.neon.DBLACollections":{DBLACollectionLoading:{spanish:"DBLACollectionLoading_es"}},"assets.bundles.engagement.intermediate.paperfrenzy.DBLALessonChooser":{DBLAInProgressSash_En:{spanish:"DBLAInProgressSash_Span"}},"assets.bundles.engagement.intermediate.coolfrost.DBLALessonChooser":{DBLAInProgressSash_En:{spanish:"DBLAInProgressSash_Span"}},"assets.bundles.engagement.intermediate.neon.DBLALessonChooser":{DBLAInProgressSash_En:{spanish:"DBLAInProgressSash_Span"}},"assets.bundles.engagement.intermediate.paperfrenzy.DBLAPersonalize":{DBLAPersonalizeLoading:{spanish:"DBLAPersonalizeLoading_es"}},"assets.bundles.engagement.intermediate.coolfrost.DBLAPersonalize":{DBLAPersonalizeLoading:{spanish:"DBLAPersonalizeLoading_es"}},"assets.bundles.engagement.intermediate.neon.DBLAPersonalize":{DBLAPersonalizeLoading:{spanish:"DBLAPersonalizeLoading_es"}},"assets.bundles.engagement.login.Login":{DBLAButtonPlay:{spanish:"DBLAButtonPlay_es"}},"assets.bundles.engagement.primary.games.FruitFarmer":{Logo:{spanish:"Logo_es"}},"assets.bundles.engagement.primary.Arcade":{SCATokenNoTokenTitle:{spanish:"SCATokenNoTokenTitle_es"},SCATokenTitle:{spanish:"SCATokenTitle_es"}},"assets.bundles.engagement.primary.AssignedLessons":{DBLAAssignedLessonComplete_Ongoing:{spanish:"DBLAAssignedLessonComplete_Ongoing_Spanish"},DBLAAssignedLessonComplete:{spanish:"DBLAAssignedLessonComplete_Spanish"}},"assets.bundles.engagement.primary.Exit":{DBLAExitDreamboxTitle:{spanish:"DBLAExitDreamboxTitle_es"},DBLAExitGameTitle:{spanish:"DBLAExitGameTitle_es"}},"assets.bundles.engagement.primary.FeedbackDialog":{DBLAFeedbackHeader:{spanish:"DBLAFeedbackHeader_es"}},"assets.bundles.engagement.primary.Pause":{DBLAPauseTitle:{spanish:"DBLAPauseTitle_es"}},"assets.bundles.components.decimals.DecimalsDivision":{DBLADollarPerIconMetal:{english_gb:"DBLAUKPoundPerIconMetal"},DBLADollarPerIconGlassBottle:{english_gb:"DBLAUKPoundPerIconGlassBottle"},DBLADollarPerIconCan:{english_gb:"DBLAUKPoundPerIconCan"},DBLADollarPerIcon20ozBottle:{english_gb:"DBLAUKPoundPerIcon20ozBottle"},DBLADollarPerIcon2LiterBottle:{english_gb:"DBLAUKPoundPerIcon2LiterBottle"},DBLARecyclerB:{english_gb:"DBLARecyclerB_UKPound"},DBLARecyclerA:{english_gb:"DBLARecyclerA_UKPound"},DBLARecycler_Scratch:{english_gb:"DBLARecycler_Scratch_UKPound"},DBLAIconDollar:{english_gb:"DBLAIconUKPound"},DBLADollarPerIconPaper:{english_gb:"DBLAUKPoundPerIconPaper"},DBLADollarPerIconNewspaper:{english_gb:"DBLAUKPoundPerIconNewspaper"},DBLADollarPerIconPound:{english_gb:"DBLAUKPoundPerIconKilogram"}},"assets.bundles.components.intermediate2.RationalRods":{SCAFractionsNickelUp:{english_gb:"SCAFractionsNickelUp_UK"},SCAFractionsNickelDown:{english_gb:"SCAFractionsNickelDown_UK"},SCAFractionsNickelOver:{english_gb:"SCAFractionsNickelOver_UK"},SCAFractionsNickelDisabled:{english_gb:"SCAFractionsNickelDisabled_UK"}},"assets.bundles.components.intermediate2.UnlikeFractionsBar":{DBLAButton05cent:{english_gb:"DBLAButton05cent_UK"},DBLAButton10cent:{english_gb:"DBLAButton10cent_UK"},DBLAButton25cent:{english_gb:"DBLAButton25cent_UK"},DBLAButton50cent:{english_gb:"DBLAButton50cent_UK"}},"assets.bundles.components.decimals.DecimalDials":{DBLADialLabelHundreds:{spanish:"DBLADialLabelHundreds_es"},DBLADialLabelOne:{spanish:"DBLADialLabelOne_es"},DBLADialLabelTens:{spanish:"DBLADialLabelTens_es"},DBLADialLabelTenths:{spanish:"DBLADialLabelTenths_es"},DBLADialLabelHundredths:{spanish:"DBLADialLabelHundredths_es"},DBLADialLabelThousandths:{spanish:"DBLADialLabelThousandths_es"}},"assets.bundles.components.geometry2.AngleBuilder":{DBLAWebMaker:{spanish:"DBLAWebMaker_es"},DBLAWebMakerPlain:{spanish:"DBLAWebMakerPlain_es"},DBLAWebMaker180:{spanish:"DBLAWebMaker180_es"}},"assets.bundles.components.slicingarrays.DivisionTo10k":{DBLABagomaticSignAnimation:{spanish:"DBLABagomaticSignAnimation_es"},DBLABagomaticSignFallAnimation:{spanish:"DBLABagomaticSignFallAnimation_es"},DBLAWeighomaticSignAnimation:{spanish:"DBLAWeighomaticSignAnimation_es"},DBLAWeighomaticSignFallAnimation:{spanish:"DBLAWeighomaticSignFallAnimation_es"}},"assets.bundles.components.geometry.AngleBuilder":{DBLAWebMaker:{spanish:"DBLAWebMaker_es"},DBLAWebMakerPlain:{spanish:"DBLAWebMakerPlain_es"},DBLAWebMaker180:{spanish:"DBLAWebMaker180_es"}}}})(Loc=Loc||{}),(t=>{t.COUNTRIES={US:{name:"United States",currency:"dollar",currencyPlacement:"before",measurement:{systems:["imperial","metric","other"]}},GB:{name:"Great Britain",currency:"pound",currencyPlacement:"before",measurement:{systems:["metric"]}}},t.getCountry=function(e){return(e=void 0===e?country:e)&&t.COUNTRIES[e]||(e=Lcid.LCID[lcid].countryCode),t.COUNTRIES[e]}})(Loc=Loc||{}),(a=>{var s={dollar:{majorUnitSymbol:"$",minorUnitSymbol:"¢"},pound:{majorUnitSymbol:"£",minorUnitSymbol:"p"},euro:{majorUnitSymbol:"€",minorUnitSymbol:"¢"}};a.isCurrencySymbol=function(e){for(var t in s){t=s[t];if(t.majorUnitSymbol===e||t.minorUnitSymbol===e)return!0}return!1},a.shouldUseDollars=function(){return"dollar"===a.getCountry().currency},a.currencyUnitBeforeValue=function(){return"before"===a.getCountry().currencyPlacement},a.getMajorCurrencyUnit=function(e,t){void 0===t&&(t="");var n=a.getCountry();return e&&n.currency!==e?t:s[n.currency].majorUnitSymbol},a.getMinorCurrencyUnit=function(e,t){void 0===t&&(t="");var n=a.getCountry();return(!e||n.currency===e)&&s[n.currency].minorUnitSymbol||t},a.formatCurrency=function(e,t){var n,o=a.getCountry(),r="number"==typeof e,i=r?e.toFixed(t.fractionDigits||2):e;return t.filter&&o.currency!==t.filter?i:(void 0===n&&(n=country),n=s[a.getCountry(n).currency],void 0===(t=t.useMinorUnit)&&r&&(t=e<1),n.minorUnitSymbol&&t?"".concat(i).concat(n.minorUnitSymbol):"before"===o.currencyPlacement?"".concat(n.majorUnitSymbol).concat(i):"".concat(i).concat(n.majorUnitSymbol))}})(Loc=Loc||{}),(n=>{n.LANGUAGES=n.getAllValuesOfLcidProperty("language"),n.matchLanguage=function(e,t){return void 0===t&&(t=language),"*"===(e=(e=e)?"*"!==(e=n.splitLocale(e)[0])&&-1===n.LANGUAGES.indexOf(e)?"english":e:"*")||"*"===t||e===t},n.getLanguageCode=function(e){return void 0===e&&(e=lcid),Lcid.LCID[e].languageCode},n.getLanguageTag=function(e){return void 0===e&&(e=lcid),Lcid.LCID[e].BCP47}})(Loc=Loc||{}),(t=>{function o(e,t){return void 0===e&&(e=language),(t=void 0===t?dialect:t)?"".concat(e,"_").concat(t.toLowerCase()):e}function r(e){void 0===e&&(e={});function a(e,t){var n;t&&"*"!==t||!i(e)?(n=(t=t)===(n=r)?1:"english"===t?3:n.startsWith(t)?2:void 0)<o&&i(e)?(s.length=0,o=n,s.push(e)):n===o&&i(e)&&s.push(e):l.push(e)}var o=Number.POSITIVE_INFINITY,r=e.locale||t.getLocale(),i=e.filter||function(){return!0},s=[],l=[];return{bestMatches:s,wildcards:l,getAll:function(){return __spreadArray(__spreadArray([],s,!0),l,!0)},getBest:function(){return s[0]||l[0]},hasReachedBest:function(){return 1===o},addValue:a,addFromMap:function(e,t){for(var n in e)e[n]&&a(t(e[n],n),n)},addFromList:function(e,t,n){for(var o=0,r=e;o<r.length;o++){var i=r[o];null!=n&&n(i),a(i,i[t])}}}}t.splitLocale=function(e){return e.split("_")},t.getLocale=o,t.createLocaleMatcher=r,t.getLocalizedItemFromList=function(e,t,n){return(n=r({locale:n})).addFromList(e,t),n.getBest()},t.getLocaleOptions=function(e){var t=(null==e?void 0:e.language)||language,n=[o(t,dialect),t];return"english"!==t&&n.push("english"),"reversed"===(null==e?void 0:e.order)&&n.reverse(),n}})(Loc=Loc||{}),(i=>{var o={centimeters:"cm",millimeters:"mm",meters:"m",liters:"l",milliliters:"ml",grams:"g",kilograms:"kg",inches:"in",feet:"ft",yards:"yd",ounces:"oz",pounds:"lb",miles:"mi",tons:"tons",cups:"cups",tablespoons:"tbsp",teaspoons:"tsp"},a={metric:["centimeters","millimeters","meters","liters","milliliters","grams","kilograms"],imperial:["inches","feet","yards","ounces","pounds","miles","tons"],other:["cups","tablespoons","teaspoons"]};function r(e){for(var t=[],n=0,o=(e=void 0===e?i.getCountry():e).measurement.systems;n<o.length;n++){var r=o[n];t.push.apply(t,a[r])}return e.measurement.units&&t.push.apply(t,e.measurement.units),t}i.canUseMeasurementSystem=function(e){return-1!==i.getCountry().measurement.systems.indexOf(e)},i.canUseMeasurementUnits=function(e){var t=r();return e.every(function(e){return-1!==t.indexOf(e)})},i.getMeasurementUnits=function(t){var n=r();return Array.isArray(t)?t.filter(function(e){return-1!==n.indexOf(e)}).map(function(e){return{name:e,abbr:o[e]}}):Object.keys(t).filter(function(e){return-1!==n.indexOf(e)}).map(function(e){return t[e]})}})(Loc=Loc||{}),(e=>{var t,n,o,r,i,a,s,l,c,u,d=1e4,p="public/v1/users/USERID/studentActivityPing";function h(){a&&clearTimeout(a),a=void 0,o&&clearTimeout(o),o=void 0}function g(){o&&clearTimeout(o),__noTime||(o=setTimeout(_,__fastStalls?t/10:t))}function f(){b(),stallCount=0,s||v(),r=!0,0<i&&(o&&clearTimeout(o),_())}function _(){var e,t;o=void 0,r?(DBLLog.log("Ping (Active)",DBLLog.INFO),e=!1,u||(t=Date.now(),6e4<=(t=__tLastTick?t-__tLastTick:0)&&(DBLLog.log("CPU thread appears to have been suspended for "+(t/6e4).toFixed(1)+" minutes - server may have abandoned us, pinging already...",DBLLog.INFO),e=!0)),m(e),r=!1,i=0):(n<=++i?(DBLLog.log("Skipping Ping (reason: Inactive) "+n+" time(s) - client will now exit",DBLLog.INFO),inactiveExit):(DBLLog.log("Skipping Ping (reason: Inactive "+i+")",DBLLog.INFO),g))()}function m(o){var e,r;serverURL?(e=serverURL+p.replace("USERID",__studentId),(r=new XMLHttpRequest).open("POST",e,!0),r.setRequestHeader("Content-type","application/json"),r.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&r.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),r.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),r.onreadystatechange=function(){if(4==r.readyState)if(200==r.status||204==r.status)this.responseText,g(),y();else{var e,t=DBLError.TROUBLE_COMMUNICATING;if(400<=r.status&&r.status<=499)try{var n=JSON.parse(r.response);n&&n.errorCode&&(t=n.errorCode)}catch(e){}t!=DBLError.TROUBLE_COMMUNICATING||o?(DBLLog.log("ping error "+t+" bias "+!!o+" - exiting immediately",DBLLog.INFO),n=r.status,e=0,DBLLog.log("Ping returned "+n+" "+e+". Exiting immediately.",DBLLog.INFO),e&&(__fatalErrorReached=e),h(),immediateExit()):DBLLog.log("Server did not respond to ping - code "+t+" - keeping quiet for now - user may reconnect.",DBLLog.INFO),g()}},r.send("")):(DBLLog.log("Would ping server if we had a server.",DBLLog.INFO),g(),y())}function y(){var e;c&&(e=c,c=null,e())}function v(){a=a||setTimeout(L,__fastStalls?d/10:d)}function L(){a=void 0,__noTime||l||s||(stallCount++,userStall(),v())}function b(){a&&(clearTimeout(a),a=void 0)}e.init=function(){h(),r=o=void 0,u=c=l=s=a=void(i=0),t=3e4,n=18,g(),stallCount=i=0,s=!(r=!1)},e.cleanup=h,e.willPing=function(){return!!o},e.willStall=function(){return!!a},e.addTime=function(e){if(__noTime)for(var t=Math.floor(e/1e4),n=0;n<t;n++)stallCount++,userStall(),runEventLoop()},e.userActive=f,e.onPingTimeout=_,e.openingPingServer=function(e){screenerMode&&y(),c=e,m(!1),r=!1,i=0},e.immediatePingServer=function(e){screenerMode&&y(),c=e,m(!0),r=!1,i=0},e.pingServerOnMajorLessonEvents=function(e){screenerMode&&y(),c=e,m(!1),r=!1,i=0},e.blockingNonStallEvent=function(){s=!0,b()},e.controlReturnsToUser=function(){s&&(s=!1,l||s||(stallCount=0,v()))},e.lessonFrozen=function(){l=!0,b()},e.lessonThawed=function(){!l||(l=!1,s)||(stallCount=0,v())},e.beginUserConsumingMedia=function(){u=u||setInterval(function(){f()},1e3)},e.endUserConsumingMedia=function(){u&&(clearInterval(u),u=void 0)}})(DBLActivityMonitor=DBLActivityMonitor||{}),(i=>{var e="recorda11y",t=0;function a(e){t=Math.max(0,t+e)}function r(){return rootParams[e]}function o(e){var t;return JSON.stringify({role:e.role,label:e.label,labelObject:e.labelObject,visible:e.visible,enabled:e.enabled,id:(null==(t=null==(t=e.display)?void 0:t.object)?void 0:t.id)||(null==(t=e.display)?void 0:t.id)})}i.recordConfiguration=function(){var e,t=document.activeElement;return t instanceof HTMLElement?{label:(e=t).ariaLabel||e.alt,tag:t.tagName}:{}},i.recordA11y=function(e){var t,n,o;r()&&(t=e.target,n={key:e.key,kc:e.keyCode,shift:e.shiftKey},i.accessibilityMode=!0,t instanceof HTMLElement)&&(null!=t&&t.id||"BODY"==(null==t?void 0:t.tagName))&&(e=n.key,-1!=__spreadArray([i.KEYBOARD_KEYS.TAB,i.KEYBOARD_KEYS.ENTER,i.KEYBOARD_KEYS.SPACE],i.ARROW_KEYS,!0).indexOf(e)||t instanceof HTMLInputElement)&&(e=function(){o&&(n.value=t.value,n.s=[t.selectionStart,t.selectionEnd]);var e=Object.keys(n).reduce(function(e,t){return void 0===n[t]||"boolean"==typeof n[t]&&!n[t]||(e[t]=n[t]),e},{});DBLAutomation.recordA11y(e)},(o=t instanceof HTMLInputElement&&"text"==t.type&&n.key!=i.KEYBOARD_KEYS.TAB)?setTimeout(e,0):e())},i.playbackA11y=function(e){if(!interactive)return!1;null!=(n=document.activeElement)&&n.tagName,i.updateAccessibility();var t,n=e.key,o=e.value,r=e.s;return!!document.activeElement&&(t=document.activeElement,e=new KeyboardEvent("keydown",{key:n,code:n,bubbles:!0,cancelable:!0,shiftKey:e.shift,metaKey:e.metaKey,altKey:e.altKey,ctrlKey:e.ctrlKey,keyCode:e.kc}),t instanceof HTMLInputElement&&(t.value=o,r&&t.setSelectionRange(r[0],r[1]),t.dispatchEvent(new Event("input",{bubbles:!0}))),t.dispatchEvent(e),n==i.KEYBOARD_KEYS.ENTER&&!e.defaultPrevented&&t instanceof HTMLButtonElement&&t.click(),n!=i.KEYBOARD_KEYS.TAB||e.defaultPrevented||(void 0===(o=e.shiftKey)&&(o=!1),r=Array.prototype.slice.call(document.querySelectorAll('body, a, img, button, input, textarea, select, [tabindex]:not([tabindex="-1"])')).filter(function(e){return null==(e=e.id)?void 0:e.startsWith("acc_")}).filter(function(e){return null!==e.offsetParent&&(-1!=e.tabIndex||e==document.activeElement)&&!e.disabled&&"hidden"!==getComputedStyle(e).visibility}),t=r.indexOf(document.activeElement),t=r[t+(o?-1:1)]||r[0],a(1),t.focus(),setTimeout(function(){a(-1)},1)),!0)},i.updateWaiting=a,i.isRecordingA11y=r,i.waitForA11y=function(){return runningUnattended&&!!t&&r()&&interactive},i.skipRecord=function(e){return e&&r()},i.printA11yTree=function(){var e=function t(e,n){void 0===n&&(n="");if(!e)return"";return n+o(e)+"\n"+e.children.map(function(e){return t(e,n+"  ")}).join("")}(lessonContent.accessibleData);i.logDebug(e)}})(a11y=a11y||{}),(s=>{var i,n,a,t,o,l,e,k={img:"alt",listItem:"text",span:"text",link:"text",alert:"text",alertdialog:"text",heading1:"text",heading2:"text",heading3:"text",math:"mathML"},c={presentation:{tabIndex:-1},radiogroup:{tabIndex:-1}},r="true"===localStorage.getItem("debugA11y")||"undefined"!=typeof __debugA11y&&__debugA11y,u="[a11y]",d="background-color: darkgreen; color: white",p=["%c".concat(u),"".concat(d,"; padding: 1px; border-radius: 2px")],h=(s.logInfo=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.log.apply(console,__spreadArray(__spreadArray([],p,!1),e,!1))},s.logDebug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r&&s.logInfo.apply(void 0,e)},s.logWarn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.warn.apply(console,__spreadArray(__spreadArray([],p,!1),e,!1))},s.logError=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.error.apply(console,__spreadArray(__spreadArray([],p,!1),e,!1))},0),N=100,g=!0,f=(s.accessibilityMode=!1,new createjs.Shape),_=null,m=!1,y=!1,U=100;function v(){lessonContent.removeChild(o),o=void 0}s.getLastFocused=function(){return l},s.focusAfterDialog=function(e){t=e},s.focusLastElement=function(){_&&_.visible&&_.stage&&s._focusElementInternal(_,!1,!0)},s.addProxy=function(e){o&&v(),e&&(lessonContent.addChild(e),o=e)},s.removeProxy=v,s.cleanup=function(){this.cleanupLesson(),i=null},s.cleanupLesson=function(){i&&(clearInterval(e),s.cancelScheduleInAnimationFrame(),s.focusHistory=[],_=t=a=null,s.clearLastRequestedFocus(),l=null,y=m=!1,s.clearPostponeFocusTimeouts(),g=!0,w())},s.focusHeaderButton=function(e){switch(e=void 0===e?"first":e){case"keyboardInfo":n=shell.keyboardInfoButton;break;case"skipToContent":n=shell.skipToContentButton;break;case"first":case"last":var t=shell.getAccessibilityHeaderButtons(),n=null==(t=null==(t=t["first"==e?0:t.length-1])?void 0:t.display)?void 0:t.object}n&&s.focusElement(n)},s.setInputValue=function(n,o){s.runOrDelayAfterAlert("setInputValueAfterAlert",function(){var e,t;t=o,(e=(e=n).accessible)&&(e.value=t)})},s.getInputSelection=function(e){return e=e.accessible,(e=document.getElementById(e.domId))&&"number"==typeof e.selectionStart?[e.selectionStart,e.selectionEnd]:[0,0]},s.updateInputSelection=function(i){function e(e){function n(){var e=(t=i.getSelection())[0],t=t[1];o&&"number"==typeof o.selectionStart&&o===document.activeElement&&o.setSelectionRange(e,t),fastForwarding||o!==document.activeElement||o.selectionStart==e&&o.selectionEnd==t||r--<=0||DBLSkippable.callDelayedAction("setInputSelectionInternal",n,1)}var e=e.accessible,o=document.getElementById(null==e?void 0:e.domId),r=3;n()}s.runOrDelayAfterAlert("setInputSelectionAfterAlert",function(){e(i)})},s.getInputPosition=function(e){return e=e.accessible,(e=document.getElementById(null==e?void 0:e.domId))&&"number"==typeof e.selectionStart?e.selectionStart:0},s.updateFocusGraphics=function(){a&&a.func(a.displayObject)};var L=/<(\w+)>/g;function j(e,r){e=DBLProxy.getActualsFromSignature(e).filter(function(e){return e=e.condition,t=r,null==e||!e.trim().length||(n=(o=Object.keys(t||{})).map(function(e){return JSON.stringify(t[e])}),e=e.replace(L,function(e,t){var n=o.indexOf(t);return assert(0<=n,"Can't find ".concat(t,", valid parameters are: ").concat(o,"!")),"<".concat(n+1,">")}),!!DBLProxy.evaluateCondition(e,__spreadArray([0],n,!0)));var t,o,n})[0];return null==e?void 0:e.script}function b(e,t){var n,t=j(e.id,e.params)||t||e.id;return t=t,(n=e.params)?t.replace(L,function(e,t){return void 0===n[t]?e:n[t]}):t}function D(e,t){(null!=t.label&&null!=t.label||t.labelObject)&&(e[k[t.role]||"label"]=S(t.labelObject||t.label))}function S(e){e=e?"string"==typeof e?e:b(e):null;return e?(e=s.formatFractionsToMathMlFormat(e),e=s.formatNegativeNumbers(e),s.formatMinus(e)):null}function A(e){var t=!!e.visible,t={name:e.name,tabIndex:e.tabIndex||0,visible:t,hidden:!t,checked:e.checked,pressed:e.pressed,draggable:e.draggable,enabled:!!e.enabled,hasPopUp:e.hasPopUp};return D(e,t),E(e,t),t}function E(e,t){function n(e,t){return e.children.indexOf(t)}"cell"!=e.role&&"gridcell"!=e.role||(t.colIndex=n(e.parentData,e),t.rowIndex=n(e.parentData.parentData,e.parentData)),"grid"==e.role&&(t.navigationLooping=e.navigationLooping),"grid"!=e.role&&"group"!=e.role||(t.roleDescription=e.roleDescription)}function B(){f.graphics.clear(),a11yContent.removeChild(f),n=null}function x(e){var t=null==e?void 0:e.accessibleData;t&&(f.graphics.clear(),C(e,s.__accessibilityBoundRectStyle),n=e,null!=(t=null==(e=(e=>{for(var t,n=e;n;){if(null!=(t=null==n?void 0:n.focus)&&t.drawOuterFocusRect)return n;n=n.parentData}return null})(t))?void 0:e.focus)&&t.drawOuterFocusRect&&C(e.display.object,s.__accessibilityGroupBoundRectStyle),a11yContent.addChild(f),engagementStage.children.indexOf(a11yContent)!=engagementStage.children.length-1&&(engagementStage.removeChild(a11yContent),engagementStage.addChild(a11yContent)),engagementStage.update())}function H(e,t){n=(e=e).accessibleData,o=null!=(o=n.focus)&&o.boundsDisplayObject?"function"==typeof n.focus.boundsDisplayObject?n.focus.boundsDisplayObject():n.focus.boundsDisplayObject:e,e=(null!=(e=n.focus)&&e.bounds?"function"==typeof n.focus.bounds?n.focus.bounds():n.focus.bounds:null)||o.getBounds()||new createjs.Rectangle(0,0,1,1);var n={displayObject:o,bounds:e},o=n.bounds,e=n.displayObject;return[e.localToLocal(o.x-t,o.y-t,a11yContent),e.localToLocal(o.x+o.width+t,o.y-t,a11yContent),e.localToLocal(o.x+o.width+t,o.y+o.height+t,a11yContent),e.localToLocal(o.x-t,o.y+o.height+t,a11yContent)]}function T(e,t,n){var o=!(null==(o=null==(o=null==e?void 0:e.accessibleData)?void 0:o.focus)||!o.rotated),e=H(e,o?n?t.padding:t.padding+t.highlight.thickness.inner:0),r=t.highlight,i=n?r.thickness.inner:r.thickness.outer,a=n?r.color.inner:r.color.outer;if(f.graphics.setStrokeStyle(i,r.caps,r.joints,r.miterLimit,r.ignoreScale).beginStroke(a),o){i=e[0];f.graphics.moveTo(i.x,i.y);for(var s=0,l=e;s<l.length;s++){var c=l[s];f.graphics.lineTo(c.x,c.y)}f.graphics.lineTo(i.x,i.y)}else{var a=.5*(r.thickness.inner+r.thickness.outer),o=Math.min.apply(Math,e.map(function(e){return e.x})),i=Math.min.apply(Math,e.map(function(e){return e.y})),u=Math.max.apply(Math,e.map(function(e){return e.x}))-o,e=Math.max.apply(Math,e.map(function(e){return e.y}))-i,t=t.padding+(n?0:a),n=n?Math.max(0,r.borderRadius-a):r.borderRadius;f.graphics.drawRoundRect(o-t,i-t,u+2*t,e+2*t,n)}f.graphics.endStroke()}function C(e,t){T(e,t,!0),T(e,t,!1)}function O(e){var t,n;e&&(B(),n=null==e?void 0:e.accessibleData)&&(null!=(t=n.focus)&&t.onCanvasFocus?(n.focus.onCanvasFocus(),null!=(t=n.focus)&&t.alwaysShowFocusRect&&x(e)):s.accessibilityMode&&x(e),_=this,le())}function R(e){var t,e=null==e?void 0:e.accessibleData;e&&(B(),null!=(t=e.focus)&&t.onCanvasBlur&&e.focus.onCanvasBlur(),le(),a=null)}function K(e){var t,n,o,r;e=e.target,(r=null==e?void 0:e.accessibleData)&&e.accessible&&(l=e,s.pushToHistory({element:e}),t=document.getElementById(e.accessible.domId),n=e.name||S(r.labelObject||r.label),o=(o=M(t))&&(o===n?"":', "'.concat(o,'"')),s.logDebug("handleFocus() -> ".concat(r.role,", ").concat(n).concat(o,"\n"),{a11yData:r,domEl:t}),O(e),a={func:O,displayObject:e},g)&&s.clearPostponeFocusTimeouts()}function G(e){R(e.target)}function q(e){e.target}function Y(e){e=e.target,l===e&&R(e)}function V(e,t){s.setExpanded(e,t),w(),e.display.object.accessible.tabIndex=t?-1:0,s.focusFirstElement(e.display.object,!0)}function W(e){var t,n=e.target,n=null==n?void 0:n.accessibleData;n&&(t=s.getExpanded(n),"Enter"!=e.key&&"Space"!=e.key||t||(V(n,!0),e.preventDefault()),"Escape"==e.key)&&t&&(V(n,!1),e.preventDefault())}function X(e){var t,n=e.target,o=null==n?void 0:n.accessibleData;!o||o.input.keyAllowed(t=e.key)&&(o.input.onKeyDown(t,e),!s.isSimulatedInput(n))||e.preventDefault()}function J(e){var t=e.target,t=null==t?void 0:t.accessibleData;t&&t.input.onChange(e.newValue)}function z(e){var t=e.target,t=null==t?void 0:t.accessibleData;t&&(t.onKeydown(e.key,e)&&e.preventDefault(),r)&&"h"==e.key&&ge()}function Q(e){var t=e.target,t=null==t?void 0:t.accessibleData;t&&t.onKeyup(e.key)&&e.preventDefault()}function $(e){e=e.target,e=null==e?void 0:e.accessibleData;e&&e.onChange()}function Z(e){var t=e.target,t=null==t?void 0:t.accessibleData;t&&null!=(t=t.focus)&&t.onHTMLFocus(e)}function ee(e){var t=e.target,t=null==t?void 0:t.accessibleData;t&&null!=(t=t.focus)&&t.onHTMLBlur(e)}function te(e){function t(e,t){(n.events=n.events||[]).push({eventName:e,listener:t}),"keydown"==e&&(n.accessibleOptions.enableKeyEvents=!0)}var n={role:s.matchRole(e.role),value:e.value,name:e.name,displayObject:e.display.object,parent:e.parent,accessibleOptions:A(e)},o=(e.expandable&&t("keydown",W),e.input&&(t("keydown",X),t("valueChanged",J),e.input.onSelectionChanged&&t("selectionChanged",e.input.onSelectionChanged),n.accessibleOptions.maxLength=e.input.maxLength,n.accessibleOptions.autoComplete="off"),e.onKeydown&&t("keydown",z),e.onChange&&t("change",$),e.onKeyup&&t("keyup",Q),null!=(o=e.focus)&&o.onHTMLFocus&&t("focus",Z),null!=(o=e.focus)&&o.onHTMLBlur&&t("blur",ee),n);if(i){for(var r=o.parent||o.displayObject.parent;r&&!r.accessible;)r=r.parent;o.parent=r||i.root,AccessibilityModule.register(o)}(o=(o=e).display.object).addEventListener("focus",K),o.addEventListener("blur",G),o.addEventListener("enabled",q),o.addEventListener("disabled",Y)}function ne(e){if(e){var t=e.display.object,n=t.accessible;if(n&&null!=(o=e.parentData)&&o.display.object&&n.parent!=e.parentData.display.object.accessible&&(n=null,s.clearAccessible(t)),n){var o=e,r=(i=o.display.object).accessible;D(r,o);try{o.value&&(r.value=o.value)}catch(e){}o.name&&(r.name=o.name);var i=(void 0===o.visible?i:o).visible,i=(r.visible=i,r.hidden=!i,r.enabled=void 0===o.enabled||o.enabled,s.matchRole(o.role));r._role!=i&&(r._role=i),void 0!==(o=c[i]?Object.assign(c[i],o):o).checked&&(r.checked=o.checked),void 0!==o.pressed&&(r.pressed=o.pressed),void 0!==o.draggable&&(r.draggable=o.draggable),void 0!==o.tabIndex&&(r.tabIndex=o.tabIndex),void 0!==(null==(i=o.input)?void 0:i.maxLength)&&(r.maxLength=o.input.maxLength),void 0!==o.live&&(r.live=o.live),void 0!==o.atomic&&(r.atomic=o.atomic),void 0!==o.href&&(r.href=o.href),E(o,r)}else te(e);(t.accessibleData=e).children.forEach(function(e){ne(e)}),n&&s.updateAccessibleChildren(e)}}function oe(e){i&&e.stage&&ne(s.getAccessibilityData(e,{}))}function re(){var e,n,o;return m||y?((n=lesson&&m&&s.isAccessibilityLesson(lesson)?lesson.getAccessibilityData():null)?(o={},lessonContent.children.forEach(function(t){s.isAccessibilityComponent(t)&&(components[t.name]?n.components.some(function(e){return e.name===t.name})||t.getAccessibilityData()&&(o[t.name]=t):n.components.push(t))}),0<Object.keys(o).length&&console.warn("[A11y] There are missing accessible components in lesson.getAccessibilityData():",o)):n={components:lessonContent.children},n=__assign(__assign({},n),{components:null==(e=n.components)?void 0:e.filter(function(e){return null==e?void 0:e.stage})})):null}function ie(){var e,t=lessonContent,n=[],a=(s.isAccessibilityHeader(a11yContent)&&n.push(a11yContent.getAccessibilityDataHeader()),re());return a&&n.push(a),engagementContent.children.forEach(function(e){s.isAccessibilityComponent(e)&&n.push(e.getAccessibilityData())}),null!=a&&a.isVisualBias&&0===h&&(e={label:b({id:"visualBiasWarning"}),cancelAllAlerts:!0},s.playAlert(e),h=Date.now()),s.isAccessibilityFooter(a11yContent)&&n.push(a11yContent.getAccessibilityDataFooter()),s.convertToInternal({role:"group",display:{object:t},onKeydown:function(e,r){e==s.KEYBOARD_KEYS.TAB&&(null!=a&&a.cancelMouseDragOnTab&&!s.isA11yDrag()&&DBLDragManager.isDragging&&null!=(t=DBLDragManager.dragProxy)&&t.cancelDrag(),s.accessibilityMode=!0);var t=[DBLTextInputEvent.ENTER_KEY,DBLTextInputEvent.SPACE_KEY],n=[DBLTextInputEvent.BACKSPACE_KEY,DBLTextInputEvent.DELETE_KEY],o=__spreadArray(__spreadArray([],t,!0),n,!0);if(-1!=o.indexOf(e)){var i=null==l?void 0:l.accessibleData;if((null!=l&&l.stage||null!=l&&l.isAllyCreated)&&i){o=function(e){var t,n,o=i.onSubmit||i.startDrag;switch(e){case"submit":t=o;break;case"submitdelete":t=i.onDelete||o;break;case"delete":t=i.onDelete}if(t)return null!=(n=null==r?void 0:r.preventDefault)&&n.call(r),(n=t())&&s.processDragTarget(i,n,"submitdelete"==e),!0};if(-1!=t.indexOf(e))return o("submit");if(-1!=n.indexOf(e))return o("delete")}else l=null}return!1},tabIndex:-1,children:n,enabled:!0},{})}s.findMappingAndReplace=b,s.transformLabel=S,s.accessibilityOptions=A,s.showFocusRect=x,s.updateComponentAccessibility=oe,s.lessonReady=function(){m=!0},s.screenReady=function(){y=!0},s.doOverlapLessonContent=function(e){var t,n,o,r=e.getBounds();return!(r&&(t=e.localToLocal(r.x,r.y,lessonContent),e=e.localToLocal(r.x+r.width,r.y+r.height,lessonContent),r=lessonContent.getBounds(),n=lessonContent.localToLocal(r.x,r.y,lessonContent),r=lessonContent.localToLocal(r.x+r.width,r.y+r.height,lessonContent),t=t,e=e,n=n,r=r,o=Math.max(t.x,n.x),t=Math.max(t.y,n.y),n=Math.min(e.x,r.x),e=Math.min(e.y,r.y),n<=o||e<=t))},s.getLessonAccessibility=re;var I,ae,P=!(s.findFirstActiveDisplayObject=function e(t){if(t)for(var n=0,o=t;n<o.length;n++){var r=o[n];if(r&&r.visible&&r.enabled&&-1!=r.tabIndex&&r.display.object)return r.display.object;if(r&&r.visible&&(r=e(r.children)))return r}return null});function se(e){var t,n=(t=a11yContent.openModalDialogs)&&t[t.length-1];null==(t=null==n?void 0:n.accessible)||!t.displayObject||e&&n.modalFocused||DBLSkippable.callDelayedAction("focusModalDialog",function(){var e;s._focusElementInternal(null==(e=n.accessible)?void 0:e.displayObject,!0),n.modalFocused=!0},1)}function w(){function e(){if(i){(e=lessonContent).getAccessibilityData=e.getAccessibilityData||ie,n&&!n.accessible&&B(),oe(e);try{i.root&&i.update(),P&&(lessonStage.update(),engagementStage.update(),P=!1),t?(s._focusElementInternal(t,!0),t=null):se(!0)}catch(e){r&&s.logError("Error updating accessibility",e)}}var e}s.runOrDelayAfterAlert("updateAccessibilityAfterAlert",function(){e()},!interactive||skippable?N:0)}function le(){P=!0}function ce(e){F(e)&&!interactive&&e.stopImmediatePropagation()}function ue(){var e=s.isRecordingA11y()?{capture:!0}:void 0;document.removeEventListener("keydown",pe,e),document.addEventListener("keydown",pe,e)}function de(e){var t;s.accessibilityMode&&(t=e.target,F(e))&&s.isAccessibleDisplayObject(t)&&(null!=(t=null==(t=(e=t.accessibleData).focus)?void 0:t.event)&&t.id?s.updateFocusInternal(e.focus.event.id,!0):null!=(t=null==(t=e.focus)?void 0:t.event)&&t.nextObject&&(t=null,t=e.focus.event.nextObject instanceof Array?e.focus.event.nextObject.filter(function(e){return e.enabled&&e.visible})[0]:e.focus.event.nextObject)&&s.focusTo(t))}function pe(e){var t;DBLActivityMonitor.userActive(),s.recordA11y(e),__screenReaderEnabled&&!s.isPreviousAlertFinished()&&s.lastAlertAction+U<Date.now()?(s.lastAlertAction=0,(t=s.getPostponeFocusAction())&&t(),DBLSkippable.callDelayedAction("postpone_focus",function(){},0),DBLSkippable.callDelayedAction("postponeCancelAllAlert",function(){},0),DBLSkippable.callDelayedAction("postponeNormalAlert",function(){},0),s.updateAccessibility()):e.key!==s.KEYBOARD_KEYS.TAB||interactive||a11yContent.openModalDialogs&&0!==a11yContent.openModalDialogs.length||(e.preventDefault(),I=I||document.querySelector('[role="banner"]'),t=e.shiftKey?"previous":"next",(e=(e=s.getTabbableElement(I,ae,t))||s.getTabbableElement(I,null,t))&&(e.focus(),ae=e))}function he(e){var t;s.accessibilityMode&&(s.accessibilityMode=!1,__keyPadController&&!__keyPadController.shouldBlur({stageX:e.stageX,stageY:e.stageY})||"input"==(null==(t=null==l?void 0:l.accessibleData)?void 0:t.role)&&mouseInside(e,l)||s._focusElementInternal(lessonContent,!0))}s.updateAccessibility=w,s.updateLessonInteractive=function(e){function t(e){e!==g&&(g=e,lessonContent.accessible)&&e&&(DBLTextInputFocusManager.__deferredFocus||(w(),s.focusFromHistory()))}__screenReaderEnabled?e?DBLSkippable.callDelayedAction("interactive_change",function(){return t(e)},0):DBLSkippable.callDelayedAction("interactive_change",function(){return t(e)},100):t(e)},s.getComponent=function e(t){return t?components[t.name]==t?t:e(t.parent):null},s.setupAccessibility=function(){s.ignoreA11yCanvasTextStyles(),(i=lessonStage.accessibilityTranslator)&&(w(),i.root=lessonContent,ue(),lessonStage.removeEventListener("stagemousedown",he),lessonStage.addEventListener("stagemousedown",he),lessonStage.removeEventListener("click",de),lessonStage.addEventListener("click",de),lessonStage.removeEventListener("click",ce,!0),lessonStage.addEventListener("click",ce,!0),document.documentElement.lang=Loc.getLanguageTag())},s.setupDragDropSupport=ue;var M=function(e){var t;return null!=(e=null!=(t=null!=(t=e.ariaLabel)?t:e.alt)?t:null==(t=e.firstChild)?void 0:t.nodeValue)?e:""};function ge(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o="".concat(d,"; font-size: 1.05em; padding: 2px; border-radius: 3px");console.log.apply(console,__spreadArray(["%c".concat(u," ").concat(e),o],t,!1))}console.log("\n\n");var t,n=null==(n=lessonContent.accessibleContainers)?void 0:n.find(function(e){return"lesson"===e.name}),o=null==n?void 0:n.accessible.domId;o?((t=(null==lesson?void 0:lesson.__data.base)||(null==lesson?void 0:lesson.__data.aka))&&(e("Lesson: ".concat(t)),console.log("\n")),e("lesson.getAccessibilityData():",null==(t=null==lesson?void 0:lesson.getAccessibilityData)?void 0:t.call(lesson)),e("A11y children data:",n.accessibleData.children),[{title:"Component",selector:"#".concat(o)},{title:"Dialog",selector:'[role="dialog"]'},{title:"Alert",selector:'[role="alert"]',skipEmptyElements:!0},{title:"AlertDialog",selector:'[role="alertdialog"]',skipEmptyElements:!0}].forEach(function(e){var t=e.selector,n=e.title,o=e.skipEmptyElements,e="#jscontent ".concat(t,", #jscontent ").concat(t,' [id^="acc_"]'),t=document.querySelectorAll(e),e=Array.from(t).filter(function(e){return!o||!!M(e)});console.log("\n"),console.groupCollapsed.apply(console,__spreadArray(__spreadArray([],p,!1),["".concat(n," DOM elements:"),e.length],!1)),e.length&&e.forEach(function(e){console.log('%c"'.concat(M(e),'"'),"color: ".concat((e=>!((e=e.getBoundingClientRect()).top<0&&e.left<0)&&0<e.width&&0<e.height)(e)?"unset":"#8f8f8f"),e)}),console.groupEnd()}),console.log("\n\n")):s.logWarn("Could not find the lesson element.\nlessonContent:",lessonContent)}function F(e){return!!e["isKeyboardClick"]}function fe(e){s.accessibilityMode=e}s.showLessonSRElements=ge,s.isKeyboardClick=F,s.setAccessibilityMode=fe,s.clearFocus=function(){s.accessibilityMode&&(fe(!1),s._focusElementInternal(lessonContent,!0))},s.getLessonOptions=function(){var e=null==lesson?void 0:lesson.getAccessibilityData();return null==e?void 0:e.options}})(a11y=a11y||{}),(a11y||(a11y={})).getTabbableElement=function(e,t,n){if(void 0===n&&(n="next"),e=Array.from(e.querySelectorAll('select:not([disabled]), [tabindex="0"]')),null===t){if("next"===n)return e[0]||null;if("previous"===n)return e[e.length-1]||null}if(0<=(t=e.indexOf(t))){if("next"===n&&t<e.length-1)return e[t+1];if("previous"===n&&0<t)return e[t-1]}return null},(s=>{var l=null,t=null,c=2e3,u=0,d=0,p=null,h=100;function g(e,t,n){return void 0===t&&(t=!1),(n=void 0===n?!1:n)&&s.updateAccessibility(),function t(e,n){void 0===n&&(n=!1);var o=e.accessible,r=e.accessibleData;r="grid"==(null==r?void 0:r.role);if(r&&s.focusGridCell(e))return!0;return 0<=(null==o?void 0:o.tabIndex)&&e.stage&&e.visible?(L(e,n),!0):null==o?void 0:o.children.some(function(e){return t(e,n)})}(e,t)}function f(e,t,n){if(void 0===n&&(n="all"),e){if("group"==e.role||"main"==e.role){var t=e.children.indexOf(t),o=e.children.slice(t+1),r=e.children.slice(0,t).reverse(),i=[];switch(n){case"forward":i=o;break;case"backward":i=r;break;default:i=o.concat(r)}t=i.filter(function(e){return e.visible&&e.display.object.stage});if(t.length)for(var a=0,s=t;a<s.length;a++)if(g(s[a].display.object))return!0}f(e.parentData,e,n)}}function n(){null!=t&&(window.cancelAnimationFrame(t),t=null,s.updateWaiting(-1))}function _(e){n(),s.updateWaiting(1),t=window.requestAnimationFrame(function(){t=null,e(),s.updateWaiting(-1)})}function m(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);for(var o,r=s.getParentAccessibleContainer(e);r;){var i=(()=>{if(null!=(o=null==(o=r.accessible)?void 0:o.focus)&&o.reFocus){var e=r.accessible.focus.reFocus(r);if(e)return l=e,_(function(){L(e,t,n)}),{value:!0}}r=s.getParentAccessibleContainer(r)})();if("object"==typeof i)return i.value}}function y(e){var t=s.focusHistory.map(function(e){return e.element}).indexOf(e.element);-1!==t&&s.focusHistory.splice(t,1),s.focusHistory.push(e),s.focusHistory.length>s.FOCUS_HISTORY_MAX_SIZE&&s.focusHistory.shift()}function o(e){var t=e.accessible;return!!(0<=(null==t?void 0:t.tabIndex)&&e.stage&&e.visible)||(null==t?void 0:t.children.some(o))}function i(e){var t=e instanceof Array?(s.logDebug("FocusEvent components: focus from history"),null==(t=e.filter(function(e){return(null==e?void 0:e.visible)&&(null==e?void 0:e.stage)}).map(function(e){var t=s.getAccessibilityData(e,{}),e=(t.canFocus=o(e),s.logDebug("component -> ".concat(e.name,"\n, { interactive: ").concat(e.interactive,", enabled: ").concat(t.enabled,", canFocus: ").concat(t.canFocus," }")),[e.interactive,t.enabled,t.canFocus,t.canFocus].reduce(function(e,t){return e+(t?1:0)},0));return{component:null==(t=t.display)?void 0:t.object,score:e}}).sort(function(e,t){return t.score-e.score})[0])?void 0:t.component):e;return t}function v(){for(var e,t=s.focusHistory.pop();t&&(null==(e=t.element)||!e.stage)&&!t.components;)t=s.focusHistory.pop();var n,o,r=i(null==t?void 0:t.components);r?(n=!1,null!=(o=null==(o=r.accessibleData)?void 0:o.focus)&&o.reFocus&&(o=r.accessibleData.focus.reFocus(null))&&(L(o,!0,!1),n=!0),n||_(function(){g(r,!0,!0)})):t&&L(t.element,!0,!1)}function L(e,t,n,o){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===o&&(o=0);function i(e,t,n,o){if(void 0===t&&(t=!1),void 0===n&&(n=!1),h<(o=void 0===o?0:o))return!1;if(!e)return!1;if(Date.now(),n){if(e!==l)return!1;if(e.accessibleData&&!e.accessibleData.enabled||!e.stage)return m(e,!0,!0)||interactive&&(e=>{function t(){var e=function e(t){var n=null==(t=t.accessible)?void 0:t.children;if(n)for(var o=n.length-1;0<=o;o--){var r=n[o];if(r.accessible){var i=document.getElementById(r.accessible.domId);if(0===(null==i?void 0:i.tabIndex))return r;if(0<r.accessible.children.length){i=e(r);if(i)return i}}}return null}(n);if(e)return l=e,_(function(){L(e)}),{value:!0};n=s.getParentAccessibleContainer(n)}for(var n=s.getParentAccessibleContainer(e);n;){var o=t();if("object"==typeof o)return o.value}})(e),!1}var r=e.accessible;if(!r){if(n){if(m(e,!1,!0))return!1;v()}else l=e,_(function(){i(e,!1,!0,o+1)});return!1}if(t||r.requestFocus(),document.activeElement.id!=(null==r?void 0:r.domId)||t){if(l===e&&!e.parent)return m(e,!1,!0)||v(),!1;l=e,_(function(){r.requestFocus(),document.activeElement.id!=(null==r?void 0:r.domId)&&i(e,null===l,null!==l,o+1)})}return!0}var r,a;return!__screenReaderEnabled||(r=Date.now(),a=!1,0===u&&(0!==o||!skippable&&interactive||(u=c,a=!0),s.lastAlertAction&&s.lastAlertAction+s.remainingReadingTime>r&&(u=Math.max(u,s.lastAlertAction+s.remainingReadingTime-r),a=!1),0===u))?i(e,t,n):(0===d&&(d=r),p=function(){0!==u&&(d=u=0,p=null,L(e,t,n,a?1:0))},DBLSkippable.callDelayedAction("postpone_focus",p,u-(r-d)),!0)}function r(e,t){var n=s.getComponent(e.initiator);!a(((null==n?void 0:n.name)||"noComponent")+t,!0)&&e.focusInitiator&&n&&_(function(){g(n,!0,!0)})}function a(e,t){void 0===t&&(t=!1);var n=lessonContent.accessible;if(n&&s.accessibilityMode){s.logDebug("focusEvent ->",e);var o,r,i,a=s.isAccessibilityLesson(lesson)?lesson.getAccessibilityData():null;if(null!=a&&a.focusOn&&a.focusOn[e])return i=void 0,(o=a.focusOn[e])instanceof Array&&(o=(r=o).filter(function(e){return e.visible})[0]),s.isAccessibilityComponent(o)&&(i=o=null!=(e=(a=o.getAccessibilityData()).display)&&e.object?a.display.object:o),o instanceof createjs.DisplayObject?(interactive&&(t?_(function(){g(o,!0,!0)}):g(o)),i&&y({element:o,components:r||i})):"lesson"===o&&n.requestFocus(),!0}return!1}s.clearPostponeFocusTimeouts=function(){d=u=0,p=null},s.getPostponeFocusAction=function(){return p},s.clearLastRequestedFocus=function(){l=null},s.focusElement=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),y({element:e}),L(e,t,n)},s.focusTo=function(e){return s.accessibilityMode&&g(e,!0,!0)},s.focusFirstElement=g,s.getFirstContentObjectHref=function(){var e=s.findFirstActiveDisplayObject(null==(e=null==(e=null==(e=lessonContent.accessibleData)?void 0:e.children)?void 0:e.find(function(e){return"main"==e.role}))?void 0:e.children);return e?"#acc_".concat(e.id):"#"},s.focusFirstContentObject=function(){var e=s.getLessonAccessibility(),t=null;(t=e?s.findFirstActiveDisplayObject(e.components.map(function(e){return e.accessibleData})):t)&&g(t)},s.focusOut=function(e){void 0===e&&(e="all");var t=s.getLastFocused().accessibleData;f(t.parentData,t,e)},s.reFocusElement=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),L(lessonContent),L(e,t,n)},s.dispatchFocusEvent=function(e,t){s.accessibilityMode&&r({initiator:e},t)},s.getFocusedElement=function(){var e;return null==(e=null==s.focusHistory?void 0:s.focusHistory[s.focusHistory.length-1])?void 0:e.element},s.focusNext=f,s.postponeFocus=function(e){u=e},s.cancelScheduleInAnimationFrame=n,s.scheduleInAnimationFrame=_,s.pushToHistory=y,s.canFocusElement=o,s.getInteractiveComponent=i,s.clearFocusHistory=function(){s.focusHistory=s.focusHistory.filter(function(e){return null==(e=e.element)?void 0:e.visible})},s.focusFromHistory=v,s._focusElementInternal=L,s.updateFocusComponent=r,s.onEnterState=function(e){a(e+"StateEvent")},s.updateFocus=function(e,t){return a(e,t=void 0===t?!1:t)},s.updateFocusInternal=a})(a11y=a11y||{}),(r=>{var t={"×":"times","*":"times","÷":"divided by","/":"divided by","=":"equals",">":"greater than","<":"less than","+":"plus","-":"minus","^":"raised to the power of",_:"blank","|":"separator","|(":"absoluate value start",")|":"absoluate value end","(":"parenthesis start",")":"parenthesis end","fraction start":"fraction start","fraction end":"fraction end",over:"over","or:":"or:"},e=["x","y","z","a","b","c","X","Y","Z","A","B","C","PI","Pi","π"].map(function(e){return"".concat(e)}).join(""),n={},o=new RegExp("(^|[^\\w])-(?=\\d|[".concat(e,']|\\[|\\(|"|d)'),"g"),i=new RegExp("(\\d+|\\)|[".concat(e,"])\\s*(-)\\s*(\\d+|\\(|[").concat(e,"])"),"g");function a(e){return e instanceof Array?e.map(c).join(", "):c(e)}function s(e){return"number"==typeof(e=t.hasOwnProperty(e)?t[e]:e)||null!=e&&e.match(/^(\d|\.)+$/)?e:translate(e,!1)}function l(e){return'"'.concat("string"==typeof e?s(e):e,'"')}function c(e){if("string"==typeof e||"number"==typeof e)return l(e);if(e.hasOwnProperty("type"))switch(e.type){case"fract":return u(e);case"const":case"var":return l(e.value);case"op":return(n=e).operands.map(a).join(" ".concat(a(n.operator)," "));case"abs":return n=e,"".concat(s("|("),", ").concat(a(n.value),", ").concat(s(")|"));case"parens":return t=e,"".concat(s("("),", ").concat(a(t.value),", ").concat(s(")"));case"blank":return s("blank");default:return"".concat(e)}var t,n}function u(e){var t=e.whole?"".concat(a(e.whole),", "):"",n=a(e.numerator),e=a(e.denominator);return"".concat(t).concat(s("fraction start"),", ").concat(n," ").concat(s("over")," ").concat(e,", ").concat(s("fraction end"))}function d(e){if("string"==typeof e||"number"==typeof e)return p(e);if(e.hasOwnProperty("type"))switch(e.type){case"fract":return n=(t=e).whole?"".concat(d(t.whole)):"",o=h(t.numerator),t=h(t.denominator),"".concat(n,"<mfrac>").concat(o).concat(t,"</mfrac>");case"const":case"var":return p(e.value);case"op":return o=(n=e).operands.map(d),"^"!=n.operator?o.join(d("<mo>".concat(n.operator,"</mo>"))):"<msup>".concat(o.join(""),"</msup>");case"abs":return"<mrow><mo>|</mo>".concat(d(e.value),"<mo>|</mo></mrow>");case"parens":return"<mrow><mo>(</mo>".concat(d(e.value),"<mo>)</mo></mrow>");case"blank":return s("blank");default:return"".concat(e)}var t,n,o}function p(e){return"string"==typeof e||isNaN(e)?"<mi>".concat(e,"</mi>"):"<mn>".concat(e,"</mn>")}function h(e){return"string"==typeof e||"number"==typeof e||"fract"!=e.type&&"op"!=e.type?d(e):"<mrow>".concat(d(e),"</mrow>")}function g(e){var t=n[e];return t||(n[e]=t=translate(e,!1)),t}r.toMathString=a,r.mathTranslate=s,r.fractionToMathString=u,r.toMathMlString=d,r.formatFractionsToMathMlFormat=function(e){return null==e?null:e.replace(/(-?\d+\s+)?(-?\d+)\s*\/\s*(-?\d+)/g,function(e,t,n,o){return t=null==t?void 0:t.trim(),r.fractionToMathString({type:"fract",numerator:n,denominator:o,whole:t})})},r.formatNegativeNumbers=function(e){return e.replace(/-\(-/g,"- (".concat(g("negative")," ")).replace(/-\[-/g,"- [".concat(g("negative")," ")).replace(o,"$1".concat(g("negative")," "))},r.formatMinus=function(e){for(var t=e;null!=t.match(i);)t=t.replace(i,function(e,t,n,o){return"".concat(t," ").concat(translate("minus")," ").concat(o)});return t},r.translateCached=g})(a11y=a11y||{}),(e=>{var n,o=!1,r=(e.ignoreA11yCanvasTextStyles=function(){var e,t;o||(e=document.head||document.getElementsByTagName("head")[0])&&((t=document.createElement("style")).appendChild(document.createTextNode("#lrt4BackgroundCanvas, #lrt4SpriteCanvas, #lrt4LessonCanvas, #lrt4EngagementCanvas  {\n    line-height: normal !important;\n    letter-spacing: normal !important;\n    word-spacing: 0px !important;\n}")),e.appendChild(t),o=!0)},document.createElement("span"));function i(e){if(!e)return null;var t=(t=document.getElementById("lrt4EngagementCanvas"))?getComputedStyle(t):null;if(!t)return null;r.style.letterSpacing=t.letterSpacing,r.style.wordSpacing=t.wordSpacing,r.style.font=e.font||"10px sans-serif",r.style.textAlign=e.textAlign||"left",r.style.position="absolute",r.style.visibility="hidden",r.style.whiteSpace="nowrap";t=e.text.replace(/ /g,"&nbsp;"),r.innerHTML=t,document.body.appendChild(r),e=r.offsetWidth,t=r.offsetHeight;return document.body.removeChild(r),{width:e,height:t}}function t(){return null!==n&&n.apply(this,arguments)||this}e.measureTextSize=i,n=createjs.Text,__extends(t,n),t.prototype.getBounds=function(){var e=(null==(e=n.prototype.getBounds.call(this))?void 0:e.clone())||new createjs.Rectangle,t=i(this);return t&&(e.width=t.width,e.height=t.height),e},t.prototype.getMeasuredWidth=function(){var e;return null==(e=this.getBounds())?void 0:e.width},t.prototype.getMeasuredHeight=function(){var e;return null==(e=this.getBounds())?void 0:e.height},e.TextA11y=t})(a11y=a11y||{}),(c=>{c.FOCUS_HISTORY_MAX_SIZE=10,c.focusHistory=[],c.__accessibilityBoundRectStyle={padding:3,highlight:{color:{inner:"#004B55",outer:"#FFFFFF"},thickness:{inner:3,outer:2},caps:"butt",joints:"miter",miterLimit:10,ignoreScale:!1,borderRadius:3}},c.__accessibilityGroupBoundRectStyle={padding:5,highlight:{color:{inner:"#004B55",outer:"#FFFFFF"},thickness:{inner:2,outer:1},caps:"butt",joints:"miter",miterLimit:10,ignoreScale:!1,borderRadius:3}};var e={button:AccessibilityModule.ROLES.BUTTON,link:AccessibilityModule.ROLES.LINK,input:AccessibilityModule.ROLES.SINGLELINETEXTBOX,checkbox:AccessibilityModule.ROLES.CHECKBOX,radio:AccessibilityModule.ROLES.RADIO,radiogroup:AccessibilityModule.ROLES.RADIOGROUP,switch:AccessibilityModule.ROLES.SWITCH,group:AccessibilityModule.ROLES.GROUP,span:AccessibilityModule.ROLES.SPAN,orderedList:AccessibilityModule.ROLES.ORDEREDLIST,listItem:AccessibilityModule.ROLES.LISTITEM,math:AccessibilityModule.ROLES.MATH,img:AccessibilityModule.ROLES.IMG,slider:AccessibilityModule.ROLES.SLIDER,heading1:AccessibilityModule.ROLES.HEADING1,heading2:AccessibilityModule.ROLES.HEADING2,heading3:AccessibilityModule.ROLES.HEADING3},t=__assign(__assign({},e),{main:AccessibilityModule.ROLES.MAIN,dialog:AccessibilityModule.ROLES.DIALOG,table:AccessibilityModule.ROLES.TABLE,tableBody:AccessibilityModule.ROLES.TABLEBODY,row:AccessibilityModule.ROLES.ROW,cell:AccessibilityModule.ROLES.CELL,singleSelectList:AccessibilityModule.ROLES.SINGLESELECTLISTBOX,singleSelectOption:AccessibilityModule.ROLES.SINGLESELECTOPTION,grid:AccessibilityModule.ROLES.GRID,gridcell:AccessibilityModule.ROLES.GRIDCELL,alert:AccessibilityModule.ROLES.ALERT,alertdialog:AccessibilityModule.ROLES.ALERTDIALOG,presentation:AccessibilityModule.ROLES.PRESENTATION,region:AccessibilityModule.ROLES.REGION,header:AccessibilityModule.ROLES.BANNER,footer:AccessibilityModule.ROLES.CONTENTINFO});function n(e){return"accessibleData"in e&&"accessible"in e}function i(e){if(e instanceof createjs.Container)for(var t=0,n=e.children;t<n.length;t++)i(n[t]);AccessibilityModule.cleanup(e)}function u(e,t,n){if(void 0===n&&(n=null),e){if(!p(e)){if(!e.display)return void c.logError("Missing a display object in:",e,"\nParent data:",n);e.display.object&&e.display.object.id in t?(c.logError("We already converted to internal the displayObject with id: ".concat(e.display.object.id," and name: ").concat(t[e.display.object.id].name,",\n                               now we are trying to convert the display object with name: ").concat(e.display.object.name)),c.logError(e.display.object)):e.display.object?t[e.display.object.id]=e.display.object:e.display.id&&e.display.id in t?(c.logError("We already converted to internal the stage object with id: ".concat(e.display.id," and name: ").concat(t[e.display.id].name,",\n                                now we are trying to use the same id again from:")),c.logError(e)):e.display.id?t[e.display.id]=null:c.logError("We need to have at least one of the display.object or display.id specified!")}e=h(e)?c.getGridAccessibilityData(e):g(e)?c.getArrowGroupAccessibilityData(e):_(e)?c.getTableAccessibilityData(e):f(e)?c.getInputAccessibilityData(e):m(e)?c.getSwitchAccessibilityData(e):y(e)?c.getModalDialogAccessibilityData(e):p(e)?c.getLessonData(e):v(e)?c.getImgAccessibilityData(e):L(e)?c.getRadioAccessibilityData(e):b(e)?c.getAlertData(e):D(e)?c.getLinkAccessibilityData(e):e;if(n&&(e.parentData=n,e.parent=n.display.object,null==(n=e.display)||!n.object)){if(null==(n=e.display)||!n.id)return void console.error("accessibility data without specifying displayObject or id: ".concat(e.role,", ").concat(e.label),e);e.display.object=l(e),t[e.display.id]=e.display.object}var o,n=e.display.object,n=(!e.display.id&&n&&(void 0===e.enabled&&(e.enabled=(e=>{if(!e.mouseEnabled)return!1;for(var t=e.parent;t;){if(!t.mouseEnabled||!t.mouseChildren)return!1;t=t.parent}return!0})(n)),void 0===e.visible)&&(e.visible=!(!n.visible||!n.stage)),void 0===e.draggable&&(e.draggable=!!e.startDrag),e),r=n.expandable&&!d(n),t=(n.children=((t,n)=>(t.children||[]).map(function(e){return u(e,n,t)}).filter(function(e){return!!e}))(n,t),n.display.object?n.display.object.accessible:null);if(n.expandable&&t){var i=document.getElementById(t.domId);if(i)for(var a=0;a<i.children.length;a++){var s=i.children[a];s instanceof HTMLElement&&(s.inert=r)}}return n.labelObject&&(o=n.labelObject).overrideChildLabel&&(t=n.children,(t="grid"===n.role?c.getFlattenedGridChildren(n):t).map(function(e,t){t=o.overrideChildLabel(e,t);e.labelObject=t||e.labelObject,void 0!==(null==t?void 0:t.label)&&(e.label=t.label)})),e}function l(e){var t,n,o,r=null==(r=(t=e).parent&&t.parent.accessibleContainers)?void 0:r.find(function(e){return e.name==t.display.id});return r||(n=(e=e).parent.accessibleContainers=e.parent.accessibleContainers||[],(o=new createjs.Container).name=e.display.id,o.isAllyCreated=!0,e=e.parent.getBounds(),o.setBounds(null==e?void 0:e.x,null==e?void 0:e.y,null==e?void 0:e.width,null==e?void 0:e.height),n.push(o),r=o),r}}function d(e){return e.display.object.a11yExpanded}function p(e){return e&&void 0!==e.components}function h(e){return"grid"==e.type}function g(e){return"arrow-group"==e.type}function f(e){return!!e&&"input"==e.type}function _(e){return"table"==e.type}function m(e){return"switch"==e.type}function y(e){return"modaldialog"==e.type}function v(e){return"img"==e.type}function L(e){return"radio"==e.type}function b(e){return"alert"==e.type}function D(e){return"link"==e.type}c.matchRole=function(e){return t[e]},c.isAccessibleDisplayObject=function(e){return"accessibleData"in e&&"accessible"in e},c.isAccessibleContainer=n,c.isAccessibilityDropTarget=function(e){return"function"==typeof e.getDropAccessibilityData},c.isDragTarget=function(e){return"function"==typeof e.acceptDragDrop},c.isAccessibilityLesson=function(e){return e&&"function"==typeof e.getAccessibilityData},c.isAccessibilityComponent=function(e){return e&&"function"==typeof e.getAccessibilityData},c.isAccessibilityHeader=function(e){return e&&"function"==typeof e.getAccessibilityDataHeader},c.isAccessibilityFooter=function(e){return e&&"function"==typeof e.getAccessibilityDataFooter},c.isDropDynamicAction=function(e){return e&&void 0!==e.events},c.clearAccessible=i,c.getParentAccessibleContainer=function(e){return e&&(e=null==(e=e instanceof createjs.DisplayObject?e.accessibleData:e)?void 0:e.parent)instanceof createjs.Container&&n(e)?e:null},c.updateAccessibleChildren=function(e){var n,t=e.display.object,o=t.accessible,r=e.children.filter(function(e){return e}).map(function(e){return null==(e=e.display)?void 0:e.object}).filter(function(e){return e});o&&o.children&&((o=(e=o.children).filter(function(e){return-1==r.indexOf(e)})).length&&(n=t.accessibleContainers||[],o.forEach(function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1),i(e)})),e.sort(function(e,t){return r.indexOf(e)-r.indexOf(t)}))},c.convertToInternal=u,c.setExpanded=function(e,t){e.display.object.a11yExpanded=t},c.getExpanded=d,c.isLesson=p,c.isGrid=h,c.isArrowGroup=g,c.isInput=f,c.isTable=_,c.isSwitch=m,c.isModalDialog=y,c.isImg=v,c.isRadio=L,c.isAlert=b,c.isLink=D,c.isButton=function(e){return"role"in e&&"button"===e.role},c.getAccessibilityData=function(e,t){try{var n=e.getAccessibilityData();return n.display||(n.display={object:e}),u(n,t)}catch(e){console.error(e)}},c.KEYBOARD_KEYS={ENTER:"Enter",ESCAPE:"Escape",ARROW_UP:"ArrowUp",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",SPACE:" ",SHIFT:"Shift",TAB:"Tab"},c.ARROW_KEYS=[c.KEYBOARD_KEYS.ARROW_DOWN,c.KEYBOARD_KEYS.ARROW_LEFT,c.KEYBOARD_KEYS.ARROW_RIGHT,c.KEYBOARD_KEYS.ARROW_UP],c.isArrowKey=function(e){return-1!==c.ARROW_KEYS.indexOf(e)},c.isLeftRightKey=function(e){return c.KEYBOARD_KEYS.ARROW_LEFT===e||c.KEYBOARD_KEYS.ARROW_RIGHT===e}})(a11y=a11y||{}),(o=>{o.initSkipToContentButton=function(e,t,n){DBLAsset.setNameAndBounds(t,"button_SkipToContent",t),t=n.getBounds(),n=e.getBounds(),e.x=.6*n.width,e.y=t.height+.6*n.height+50,e.visible=!1,e.addEventListener("click",function(e){o.focusFirstContentObject()}),e.getAccessibilityData=function(){return{display:{object:e},role:"button",labelObject:{id:"shellSkipToContent"},enabled:!0,visible:!0,onSubmit:o.focusFirstContentObject,focus:{onHTMLFocus:function(){o.setAccessibilityMode(!0),e.visible=!0,engagementStage.update()},onHTMLBlur:function(){e.visible=!1}}}},engagementStage.addChild(e)}})(a11y=a11y||{}),(r=>{r.initKeyboardInfoButton=function(e,t,n,o){DBLAsset.setNameAndBounds(t,"button_KeyboardInfo",t),t=n.getBounds(),n=e.getBounds(),e.x=.6*n.width,e.y=t.height+.6*n.height,e.visible=!1,e.addEventListener("click",function(e){o()}),e.getAccessibilityData=function(){return{display:{object:e},role:"button",labelObject:{id:"shellKeyboardInfo"},enabled:!0,visible:!0,onSubmit:o,focus:{onHTMLFocus:function(){r.setAccessibilityMode(!0),e.visible=!0,engagementStage.update()},onHTMLBlur:function(){e.visible=!1}}}},engagementStage.addChild(e)}})(a11y=a11y||{}),(r=>{var i="a11yActionMenu",n="14px Arial",o="#333",t="#CCC",a=26,s=8,l=6,c=5,u=4;r.showActionMenu=function(e,t,n,o){if(e&&e.length)return e=new p(e,t,n,o),lessonContent.addChild(e),r.updateAccessibility(),r.focusFirstElement(e,!0),e;console.warn("Can't create action menu without items.")},d=createjs.Container,__extends(e,d),e.prototype.cleanup=function(){this._listItems.forEach(function(e){return e.removeAllEventListeners()}),this.removeAllChildren()},e.prototype.focusElement=function(e){r.focusElement(this._listItems[e],!0)},e.prototype.createActionsList=function(e){this._listItems=e.map(function(e,t){var n=new g(e);return n.name=i+t,n.y=t*a,n.on("click",function(){r.closeDialog(),e.eventHandler()}),n}),this.addChild.apply(this,this._listItems);var t=this.getBounds(),n=c;this._listItems.forEach(function(e){return e.width=t.width-n})},e.prototype.positionMenu=function(e,t){var n,o=new createjs.Point(0,0),r=e.localToLocal(0,0,lessonContent);t?o=t:(t=e.getBounds()||{width:0,height:0,x:0,y:0},e=this.getBounds()?this.getBounds().width:0,n=lessonContent.getBounds().width,r.x+t.width+t.x+e<n?o.x=t.width+t.x:o.x=t.x-e,o.y=t.y),this.x=r.x+o.x,this.y=r.y+o.y},e.prototype.createBackgrounds=function(){var e=this.getBounds(),t=e.width,e=e.height,n=2*c,o=new createjs.Shape;o.graphics.beginFill("#FFF").setStrokeStyle(1).beginStroke("#AAA").drawRoundRect(c,c,t-n,e-n,u),this.addChildAt(o,0),this.setBounds(0,0,t,e)},e.prototype.getAccessibilityData=function(){var o=this,e=this._listItems.map(function(t,e){return{role:"singleSelectOption",display:{object:t},value:t.text,focus:{onCanvasFocus:function(){t.selected=!0,t.itemData.onOver&&t.itemData.onOver(o._data)},onCanvasBlur:function(){t.selected=!1,t.itemData.onExit&&t.itemData.onExit(o._data)}},onExit:function(){o.dispatchEvent("exit"),r.closeDialog()},onKeydown:function(e){if("Escape"==e&&(o.dispatchEvent("exit"),r.closeDialog()),"Enter"==e)return r.closeDialog(),t.itemData.eventHandler(),!0}}});return{type:"modaldialog",display:{object:this},tabIndex:-1,children:[{role:"singleSelectList",display:{id:"globalSingleSelectList"},name:i,tabIndex:-1,children:e,onKeydown:function(e){function t(){return o._listItems.findIndex(function(e){return e.selected})}switch(e){case"ArrowUp":var n=Math.max(0,t()-1);return o.focusElement(n),!0;case"ArrowDown":n=Math.min(o._listItems.length-1,t()+1);return o.focusElement(n),!0}return!1}}]}};var d,p=e;function e(e,t,n,o){var r=d.call(this)||this;return r._data=n,r.name=i,r.createActionsList(e),r.createBackgrounds(),r.positionMenu(t,o),r}h=createjs.Container,__extends(f,h),Object.defineProperty(f.prototype,"width",{set:function(e){this._width=e,this.updateBackground()},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"selected",{get:function(){return this._background.visible},set:function(e){this._textfield.color=e?t:o,this._background.visible=e},enumerable:!1,configurable:!0}),f.prototype.updateBackground=function(){this.removeChild(this._background);var e=this._width||this._textfield.getMeasuredWidth()+2*s,t=2*c,e=(this._background=new createjs.Shape,this._background.visible=!1,this._background.graphics.beginFill(o).drawRoundRect(c,c,e,a,u),this.addChildAt(this._background,0),this.setBounds(0,0,e+t,a+t),new createjs.Shape);e.graphics.beginFill("#FFF").drawRect(0,0,this.getBounds().width,this.getBounds().height),this.hitArea=e};var h,g=f;function f(e){var t=h.call(this)||this;return t.itemData=e,t._width=0,t.text=e.text,t._textfield=new createjs.Text(t.text,n,o),t._textfield.x=c+s,t._textfield.y=c+l,t.addChild(t._textfield),t.updateBackground(),t}})(a11y=a11y||{}),(E=>{var B=!1;function x(e){var t=DBLDragManager.dragProxy;t.removeAllChildren(),e.x=e.y=0,t.addChild(e)}function T(e){B&&(createjs.MouseCapture.clear(e),B=!1)}E.isA11yDrag=function(){var e;return!(null==(e=DBLDragManager.dragProxy)||!e.isA11yDrag)},E.getA11yDragData=function(){var e;return null==(e=null==(e=DBLDragManager.dragProxy)?void 0:e.dragData)?void 0:e.accessibilityData},E.processDragTarget=function(o,d,r){var i,e,n,a,g,f,s,_,m,t,y,l,c,v,L,b,D,S,A,u,p,h;void 0===r&&(r=!1),d&&!DBLDragManager.isDragging&&((h=new DBLDragProxy({dragData:(e=d).data})).isA11yDrag=!0,h.dragInitiator=e.initiator,DBLDragManager.dragProxy=h,e.proxy&&x(e.proxy),i=e.proxy=h,DBLDragManager.populateChildDragTargets(e=[],lessonContent),d.onDragStart&&(E.addProxy(i),h=d.onDragStart())&&x(h),(n=e.filter(function(e){return e.acceptDragDrop(i)&&E.isAccessibilityDropTarget(e)}).map(function(e){return{target:e,dropData:e.getDropAccessibilityData(d)}}).filter(function(e){var e=e.dropData;return null==(e=null==e?void 0:e.options)?void 0:e.length}).reverse()).find(function(e){e=e.dropData;return void 0!==(null==e?void 0:e.dropIndex)})&&(a=function(e){return null!=(e=e.dropIndex)?e:1/0},n.sort(function(e,t){return a(e.dropData)-a(t.dropData)})),g=n.map(function(e){return e.target}),f=[],s=[],m=_=null,t=[],y=function(e,t){_!=e&&(_=e,m=t||A(_))},l=function(){var e;return null!=(e=null==d?void 0:d.onDragCancel)&&e.call(d),null!=d&&d.dragCancelLabel&&E.playAlert({labelObject:d.dragCancelLabel}),(DBLDragManager.dragProxy=i).cancelDrag(),E.removeProxy(),!(DBLDragManager.dragProxy=null)},g.length?(c=function(e,t){return e.onDragDrop&&e.onDragDrop(t.data),t.dropLabelObject&&E.playAlert({labelObject:t.dropLabelObject}),null!=_&&_.dragDrop&&((DBLDragManager.dragProxy=i).dragData.accessibilityData=t.data,_.dragDrop(i)),e.manuallyRemoveProxy||(E.removeProxy(),DBLDragManager.dragProxy=null),E.updateFocusComponent(d,"DragDrop"),T(),!0},v=function(e,t){var n;T(),E.removeProxy(),null!=(n=e.onDragExit)&&n.call(e,t.data)},B||(B=!0,createjs.MouseCapture.set({captureMouseUp:!0,onMouseDown:function(e){var t,n;T(!0),null!=(n=null==(t=null==(t=E.getLastFocused())?void 0:t.accessibleData)?void 0:t.onExit)&&n.call(t)}})),L=function(e,t,n){void 0===n&&(n=!1),(DBLDragManager.dragProxy=i).dragData.accessibilityData=t.data;var o=d.proxy,r=(E.addProxy(i),null==(r=e.onDragEnter)?void 0:r.call(e,t.data));r&&o&&r.getBounds()&&o.getBounds()&&(o.visible=!0,e=r.localToLocal(r.getBounds().width/2,0,o.parent),r=o.getBounds(),o.x=e.x-r.width/2-r.x,o.y=e.y-r.height/2),n&&t.labelObject&&E.playAlert({labelObject:t.labelObject,ignoreSimilarityCheck:!0,alertId:"_dragOverOption",alertDelay:1e3})},b=function(e){t[g.indexOf(_)]=e},D=function(){var e=g.indexOf(_);return t[e]||m.options[0]},S=function(){var e=m;return E.isDropDynamicAction(e)?{dropAccessibilityData:e,option:D()}:null},A=function(t){var e;return(null==(e=n.find(function(e){return e.target==t}))?void 0:e.dropData)||t.getDropAccessibilityData(d)},u=function(){function e(){p();var e=DBLUtils.isDefined(d.dragCancelOptionData);e&&(n=d.initiator,E.isAccessibilityDropTarget(n)&&E.isDragTarget(n)?(y(n),b({data:d.dragCancelOptionData,label:"",labelObject:{id:"cancelAction"}})):e=!1);var t=(n=S()).dropAccessibilityData,n=n.option;e?c(t,n):(fastForwarding=!0,l(),null!=(e=null==t?void 0:t.onDragCancel)&&e.call(t,n.data),E.updateFocusComponent(d,"DragCancel"))}function t(){fastForwarding=!0;var e,t=(n=S()).dropAccessibilityData,n=n.option;return d.deleteCancelsDrag?(l(),null!=(e=null==t?void 0:t.onDragCancel)&&e.call(t,n.data),E.updateFocusComponent(d,"DragCancel"),!0):!!t.onDragDelete&&(t.onDragDelete(n.data),E.updateFocusComponent(d,"DragDelete"),!0)}function n(e){if(d.navigateTargetsAsGrid){var t=e;(o=S()).dropAccessibilityData;for(var n,o=o.option.gridPosition,r={down:{row:1,column:0},up:{row:-1,column:0},right:{row:0,column:1},left:{row:0,column:-1}}[t],i=__assign({},o),a=null;i.row+=r.row,i.column+=r.column,a=null==(n=f[i.row])?void 0:n[i.column],0<=i.row&&0<=i.column&&i.row<f.length&&(0==r.column||i.column<(null==(n=f[i.row])?void 0:n.length))&&!a;);return a&&(p(),y(a.target),b(a.option),h()),!0}var s,l,c;return d.navigateTargetsAsList?u(g,e):(o=(t=S()).dropAccessibilityData,s=t.option,"topDown"==(l=o.events)||"leftRight"==l||"all"==l?u([_],e):void((l=l[e])&&(p(),c=l&&l(s.data),e=o.options.find(function(e){return e.data===c})||__assign(__assign({},s),{data:c}),b(e),h())))}function u(e,t){var n,o={down:1,right:1,up:-1,left:-1};if("topDown"==m.events&&(o.left=o.right=0),"leftRight"==m.events&&(o.up=o.down=0),0!=o[t]){for(var r=[],i=0,a=e;i<a.length;i++)for(var s=a[i],l=0,c=(null==(n=A(s))?void 0:n.options)||[];l<c.length;l++){var u=c[l];r.push([s,u])}var d=D(),e=r.findIndex(function(e){return e[0]==_&&e[1].data==d.data}),o=(assert(0<=e,"Unable to match current target/option pair"),(e+o[t]+r.length)%r.length);e!=o&&(e=(t=r[o])[0],o=t[1],p(),y(e),b(o),h())}return!0}var p=function(){var e=S(),t=e.dropAccessibilityData;v(t,e.option)},h=function(){var e=S(),t=e.dropAccessibilityData;L(t,e.option,!0)};E.showArrowPopup({text:"",onSubmit:function(){var e=S(),t=e.dropAccessibilityData;c(t,e.option)},onDelete:t,onCancel:e,onTab:function(e){d.navigateTargetsAsList||(p(),e=(g.indexOf(_)+(e?-1:1)+g.length)%g.length,y(g[e]),b(D()),h())},events:{left:function(){return n("left")},right:function(){return n("right")},up:function(){return n("up")},down:function(){return n("down")}}},o.display.object,d.dragStartLabel),h(),r&&(E.hideArrowPopup(),(t()?p:e)())},p=0,g.forEach(function(r){var e,t,n,i=A(r);E.isDropDynamicAction(i)?i.options.forEach(function(e,t){var n,o;d.navigateTargetsAsGrid&&(o=e.gridPosition)&&(f[n=o.row]||(f[n]=[]),f[o.row][o.column]={target:r,option:e}),p||i.firstOptionIndex!=t||(p=i.firstOptionIndex),s.push({text:e.label,autoSubmit:e.autoSubmit||"string"==typeof i.events,eventHandler:function(){return y(r,i),b(e),u(),!1}})}):(n=r,e=(t=i).options.map(function(e){return{onOver:function(){return L(t,e)},onExit:function(){return v(t,e)},text:e.label,eventHandler:function(){return y(n),c(t,e)}}}),s.push.apply(s,e))}),d.cancelLabel&&s.push({text:d.cancelLabel,eventHandler:l}),s[p]&&s.every(function(e){return e.autoSubmit})?s[p].eventHandler():(y(g[0]),null!=(h=E.showActionMenu(s,o.display.object,d.data,o.popupOffset?o.popupOffset():void 0))&&h.on("exit",function(){var e;null!=(e=d.onDragCancel)&&e.call(d)}))):l())}})(a11y=a11y||{}),(o=>{var r,i="a11yArrowPopup",n={ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right",Enter:"submit",Delete:"delete",Backspace:"delete",Tab:"tab"," ":"submit",Escape:"cancel"},a=(r=createjs.Container,__extends(e,r),e.prototype.cleanup=function(){this.removeAllEventListeners(),this.removeAllChildren()},e.prototype.doEvent=function(e){var t,n,o;if("delete"===e)return!(null==(n=(t=this._data).onDelete)||!n.call(t))&&(s(),!0);switch(e){case"submit":s(),o=this._data.onSubmit;break;case"cancel":s(),o=this._data.onCancel;break;case"tab":o=this._data.onTab;break;default:o=this._data.events[e]}return!!o&&(o(),!0)},e.prototype.getAccessibilityData=function(){var t=this;return{display:{object:this},role:"button",labelObject:this._a11yLabel,onKeydown:function(e){return t.doEvent(n[e])},onExit:function(){t.doEvent("cancel")},focus:{onCanvasFocus:function(){},onCanvasBlur:function(){DBLSkippable.callDelayedAction("blurArrowDragAndDropMenu",function(){o.getLastFocused()!=t&&t.doEvent("cancel")},1)}}}},e);function e(e,t){var n=r.call(this)||this;return n._data=e,n._a11yLabel=t,n.name=i,n}function s(){var e=lessonContent.getChildByName(i);e&&(e.cleanup(),lessonContent.removeChild(e),o.updateAccessibility(),o.focusFromHistory())}o.ArrowPopup=a,o.hideArrowPopup=s,o.showArrowPopup=function(e,t,n){t=t.localToLocal(0,0,lessonContent),(e=new a(e,n)).x=t.x,e.y=t.y,lessonContent.addChild(e),o.updateAccessibility(),o.focusElement(e,!0)}})(a11y=a11y||{}),(s=>{var u=175,n=80,o=99,l=null,c=null,d=(s.lastAlertAction=0,s.remainingReadingTime=0);function p(e){return void 0===e&&(e=Date.now()),s.lastAlertAction+s.remainingReadingTime<e}function a(e){return e.toLowerCase().match(/\b(\w+)\b/g)}function h(e){var t={};return e&&e.forEach(function(e){t[e]=(t[e]||0)+1}),t}function g(n){return Math.sqrt(Object.keys(n).reduce(function(e,t){return e+n[t]*n[t]},0))}function r(e,t){var n,o,r,e=a(e),t=a(t),e=h(e),t=h(t),i=(n=e,o=t,r=0,Object.keys(n).forEach(function(e){e in o&&(r+=n[e]*o[e])}),r),e=g(e),t=g(t);return 0<e&&0<t?i/(e*t)*100:0}function f(e,t){if(null==e||!e.ignoreSimilarityCheck)return t=r(t.label,e.label),null!=e&&e.ignoreOnlyIfCompletelySimilar?o<=t:n<=t}s.isPreviousAlertFinished=p,s.getAlertData=function(e){var t={role:e.type,live:"assertive",atomic:!0,display:e.display,children:null};return s.copyBaseProperties(t,e)},s.playAlert=function e(t){if(__screenReaderEnabled){var n,o,r,i=Date.now(),a="string"==typeof t?{labelObject:{id:t}}:t;if(void 0!==a.alertId&&void 0!==a.alertDelay)delete(n=__assign({},a)).alertDelay,DBLSkippable.callDelayedAction(a.alertId,function(){return s.playAlert(n)},a.alertDelay);else if(!a.labelObject||"label"in a||(a.label=s.transformLabel(a.labelObject)),!a.label.includes("(SFX)")&&(null!=(t=a.label)&&t.match(/<(?!br\b)\S+>/)&&s.logError("playAlert(): Missing parameters! ","\n".concat(a.label),"\n\nalertMsg object:",a),""!==a.label)){if(a.cancelAllAlerts){if(null!==l&&l.cancelAllAlerts&&!p(i))return null===c||f(a,c)||(a.label=c.label+"<br><br>"+a.label),DBLSkippable.callDelayedAction("postponeCancelAllAlert",function(){return e(a)},s.remainingReadingTime-(i-s.lastAlertAction)),void(c=a);l=null,d++,s.remainingReadingTime=0}else if(!p(i))return null===c||f(a,c)||(a.label=c.label+"<br><br>"+a.label),DBLSkippable.callDelayedAction("postponeNormalAlert",function(){return e(a)},s.remainingReadingTime-(i-s.lastAlertAction)),void(c=a);null!==l&&f(a,l)||(l=a,c=null,s.remainingReadingTime=(e=>{for(var o=u/60/1e3,r=e.trim().split(/\s+/),i=0,t=(i+=100,r.forEach(function(e,t){var n=1/o,e=(/^\d+([.,]\d+)?$/.test(e)&&(n*=2),10<e.length&&(n*=1+.1*(e.length-10)),(e=e.toLowerCase()).length<=3||!(e=e.match(/[aeiouy]{1,2}/g))?1:e.length);i+=n*=e/2,t<r.length-1&&(i+=50)}),{",":200,".":400,"?":400,"!":400,";":300,":":300}),n=0,a=Object.keys(t);n<a.length;n++){var s=a[n],l=new RegExp("\\".concat(s),"g"),l=(e.match(l)||[]).length;i+=l*t[s]}var c=e.match(/[.!?]/g)||[],i=i+200*c.length+200;return Math.ceil(i)})(a.label),s.lastAlertAction=i,s.logDebug("playAlert():",'\n"'.concat(a.label,'"'),"\n\nalertMsg object:",a),(o=document.querySelector('[role="alert"]'))&&(r=document.activeElement,o.innerHTML=a.label+(d%2==0?"":"."),DBLSkippable.callDelayedAction("preserve_current_focus_after_alert",function(){document.activeElement===o&&null!=r&&r.focus()},100)))}}},s.runOrDelayAfterAlert=function e(t,n,o){var r=Date.now();__screenReaderEnabled&&s.lastAlertAction+s.remainingReadingTime>r?(r=s.lastAlertAction+s.remainingReadingTime-r,o&&(r+=o),DBLSkippable.callDelayedAction(t,function(){e(t,n,o)},r)):n()}})(a11y=a11y||{}),(()=>{function n(e){return void 0!==e}(a11y||(a11y={})).copyBaseProperties=function(e,t){return n(t.label)&&(e.label=t.label),n(t.visible)&&(e.visible=t.visible),n(t.value)&&(e.value=t.value),t.display&&n(t.display.object)&&(e.display={object:t.display.object}),n(t.enabled)&&(e.enabled=t.enabled),n(t.tabIndex)&&(e.tabIndex=t.tabIndex),n(t.checked)&&(e.checked=t.checked),n(t.expandable)&&(e.expandable=t.expandable),n(t.labelObject)&&(e.labelObject=t.labelObject),n(t.name)&&(e.name=t.name),n(t.navigationLooping)&&(e.navigationLooping=t.navigationLooping),n(t.roleDescription)&&(e.roleDescription=t.roleDescription),t.onKeydown&&(e.onKeydown=t.onKeydown),t.onSubmit&&(e.onSubmit=t.onSubmit),t.startDrag&&(e.startDrag=t.startDrag),t.onDelete&&(e.onDelete=t.onDelete),t.onExit&&(e.onExit=t.onExit),t.focus&&(e.focus=__assign(__assign({},e.focus),t.focus)),t.popupOffset&&(e.popupOffset=t.popupOffset),e}})(),(c=>{function s(e){return!e||DBLUtils.isDefined(e.enabled)&&!e.enabled}function u(e){var o=[];return e.forEach(function(e,n){e.forEach(function(e,t){s(e)||o.push({rowIndex:n,colIndex:t})})}),o}function o(e,t){t.rowIndex=Math.max(0,Math.min(t.rowIndex,e.length-1));var n=e[t.rowIndex];t.colIndex=Math.max(0,Math.min(t.colIndex,(null==n?void 0:n.length)-1||0)),s(null==n?void 0:n[t.colIndex])&&(n=u(e),t.rowIndex=(null==(e=n[0])?void 0:e.rowIndex)||0,t.colIndex=(null==(e=n[0])?void 0:e.colIndex)||0)}function n(e){var t=e.display.object,t=t&&t.accessible,n=e.initialFocus,t=null==t?void 0:t.currentFocus,t={rowIndex:(null==t?void 0:t.rowIndex)||(null==n?void 0:n.rowIndex)||0,colIndex:(null==t?void 0:t.colIndex)||(null==n?void 0:n.colIndex)||0};return o(e.gridData,t),t}function l(n){return{reFocus:function(e){var t=null==e?void 0:e.accessibleData.children[0];if(!t)return null;var e=(null==(e=e.accessible)?void 0:e.currentFocus)||{rowIndex:0,colIndex:0},t=(o(n,e),e.rowIndex>t.children.length-1&&(e.rowIndex=t.children.length-1),t.children[e.rowIndex]);if(!t)return null;e.colIndex>t.children.length-1&&(e.colIndex=t.children.length-1);t=t.children[e.colIndex];return null==(e=null==t?void 0:t.children[0])?void 0:e.display.object},drawOuterFocusRect:!0}}function d(e,t,n,o){var r=t.display.object,i=null,i=e instanceof createjs.Rectangle?{role:"button",tabIndex:o,display:{id:"emptyCell_".concat(n)},label:"Empty cell",focus:{bounds:e}}:__assign(__assign({},e),{tabIndex:o});return t.respectInteractiveProperties||(i.enabled=!0,i.visible=!0),!1!==t.enabled&&!1!==(null==(n=null==r?void 0:r.accessibleData)?void 0:n.enabled)||(i.enabled=!1,i.tabIndex=-1),i}function p(s){for(var e=s.gridData,t="all"==s.navigationLooping,n=t||null==s.navigationLooping||"row-column"==s.navigationLooping,o=u(e),r=0;r<o.length;r++){var i=o[r],a=o[(r+1)%o.length];(i.rowIndex==a.rowIndex||t||n&&i.rowIndex<a.rowIndex)&&((i.right=a).left=i)}o.sort(function(e,t){return e.colIndex-t.colIndex||e.rowIndex-t.rowIndex});for(r=0;r<o.length;r++){i=o[r],a=o[(r+1)%o.length];(i.colIndex==a.colIndex||t||n&&i.colIndex<a.colIndex)&&((i.down=a).up=i)}function l(e){return s.gridData[e.rowIndex][e.colIndex].display.object}e.forEach(function(e,n){e.forEach(function(e,t){var i,a;e instanceof createjs.Rectangle||e.arrowKeyNavigationAdded||(i=o.find(function(e){return e.rowIndex==n&&e.colIndex==t}))&&(i.left||i.right||i.up||i.down)&&(a=e.onKeydown,e.onKeydown=function(e,t){var n,o,r;return!((null==a||!a(e,t))&&(t=i.left,n=i.right,o=i.up,r=i.down,"ArrowLeft"===e&&t?(s.display.object.accessible.currentFocus=t,c.focusFirstElement(l(t),!1,!0),0):"ArrowRight"===e&&n?(s.display.object.accessible.currentFocus=n,c.focusFirstElement(l(n),!1,!0),0):"ArrowUp"===e&&o?(s.display.object.accessible.currentFocus=o,c.focusFirstElement(l(o),!1,!0),0):"ArrowDown"!==e||!r||(s.display.object.accessible.currentFocus=r,c.focusFirstElement(l(r),!1,!0),0)))},e.arrowKeyNavigationAdded=!0)})})}c.positionObjectsInGrid=function(e,n){void 0===n&&(n=10);for(var o=function(e){var t;return(null==(t=null==e?void 0:e.gridPosition)?void 0:t.x)||(null==e?void 0:e.x)||0},i=function(e){var t;return(null==(t=null==e?void 0:e.gridPosition)?void 0:t.y)||(null==e?void 0:e.y)||0},a=function(e,t){return Math.abs(e-t)<n},s=[],t=(e.forEach(function(e){for(var t=void 0,n=0,o=s;n<o.length;n++){var r=o[n];a(i(r[0]),i(e))&&(t=r)}t||s.push(t=[]),t.push(e)}),s.sort(function(e,t){return i(e[0])-i(t[0])}),s.forEach(function(e){return e.sort(function(e,t){return o(e)-o(t)})}),0);t<Math.max.apply(Math,s.map(function(e){return e.length}));t++)(t=>{var n=Math.min.apply(Math,s.map(function(e){return e[t]}).filter(function(e){return!!e}).map(o));s.forEach(function(e){e[t]&&a(o(e[t]),n)||e.splice(t,0,void 0)})})(t);return s},c.getFlattenedGridChildren=function(e){return((null==(e=e.children[0])?void 0:e.children)||[]).reduce(function(e,t){return e.concat((null==(e=t.children)?void 0:e.map(function(e){return e.children[0]}).filter(function(e){return!!e}))||[])},[])},c.focusGridCell=function(e){if(e.accessible){try{var t=function t(e,n,o){void 0===o&&(o=[]);var r=e.accessible;return(null==r?void 0:r.role)==n&&o.push(e),null!=(e=null==r?void 0:r.children)&&e.forEach(function(e){return t(e,n,o)}),o}(e,"gridcell"),n=t.map(function(e){return null==(e=e.accessible)?void 0:e.children[0]}),o=t[n.findIndex(function(e){return-1!=(null==(e=null==e?void 0:e.accessible)?void 0:e.tabIndex)})];if(s(null==o?void 0:o.accessibleData)){var r=t.findIndex(function(e){return!s(e.accessibleData)}),i=t[r],a=n[r];if(i&&null!=o&&o.accessible&&(o.accessible.tabIndex=-1),null!=a&&a.accessible)return a.accessible.tabIndex=0,a.accessible.requestFocus(),!0}}catch(e){}return!1}},c.getGridAccessibilityData=function(r){var i=r.display.object,a=(e=n(r)).rowIndex,s=e.colIndex,e=r.gridData;return c.copyBaseProperties({role:"grid",tabIndex:-1,focus:l(e),children:[{role:"tableBody",display:{id:"tbody_".concat(null==i?void 0:i.id)},enabled:!0,tabIndex:-1,children:e.map(function(e,o){return{role:"row",display:{id:"row".concat(o,"_").concat(null==i?void 0:i.id)},enabled:!0,tabIndex:-1,children:e.map(function(e,t){var n="".concat(o,"_").concat(t,"_").concat(null==i?void 0:i.id),e=d(e,r,n,o===a&&t===s?0:-1);return{role:"gridcell",display:{id:"cell_".concat(null!=(t=null==(t=null==(t=null==e?void 0:e.display)?void 0:t.object)?void 0:t.id)?t:n)},enabled:e.enabled,visible:e.visible,tabIndex:-1,children:[e],focus:{bounds:null==(t=null==e?void 0:e.focus)?void 0:t.bounds}}})}})}]},r)},c.getArrowGroupAccessibilityData=function(r){var e=r.gridData,i=r.display.object,t=n(r),a=t.rowIndex,s=t.colIndex;return p(r),c.copyBaseProperties({role:"group",roleDescription:translate("Group. Use arrows to navigate."),tabIndex:-1,focus:l(e),children:e.map(function(e,o){return{role:"group",display:{id:"row".concat(o,"_").concat(null==i?void 0:i.id)},enabled:!0,tabIndex:-1,children:e.map(function(e,t){var n="".concat(o,"_").concat(t,"_").concat(null==i?void 0:i.id);return d(e,r,n,o===a&&t===s?0:-1)})}})},r)}})(a11y=a11y||{}),(n=>{n.getImgAccessibilityData=function(e){var t={role:"img",display:e.display,children:null};return n.copyBaseProperties(t,e)}})(a11y=a11y||{}),(c=>{function n(e){return!!webview}c.isSimulatedInput=n,c.getInputAccessibilityData=function(s){var t,l,e={role:"input"!==(null==s?void 0:s.role)&&n(s.display.object)?"group":"input",display:s.display,input:{onChange:s.onChange,onSelectionChanged:s.onSelectionChanged,maxLength:s.maxLength,keyAllowed:s.keyAllowed,onKeyDown:s.onKeyDown},children:[]};return s.insideGrid&&(t=e.onSubmit,l=e.onKeydown,e.onKeydown=function(e,t){var n,o,r=null==l?void 0:l(e,t),i=e==c.KEYBOARD_KEYS.ARROW_LEFT,e=e==c.KEYBOARD_KEYS.ARROW_RIGHT,a=s.display.object;return(i||e)&&a instanceof DBLTextInputA11y&&(n=(o=c.getInputSelection(a))[0])==(o=o[1])&&(i&&0!=n||e&&o!=a.text.length)&&t.stopImmediatePropagation(),r},e.onSubmit=function(){var e=null==t?void 0:t();return c.focusOut("forward"),e}),c.copyBaseProperties(e,s)}})(a11y=a11y||{}),(o=>{o.getLessonData=function(n){var e=o.copyBaseProperties({role:"main",tabIndex:-1,display:{id:"lesson"},children:n.components.map(function(e){return"string"==typeof e?components[e]:e}).filter(o.isAccessibilityComponent).map(function(e){var t=e.getAccessibilityData();return n.hideOutsideComponents&&(t.visible||void 0===t.visible&&e.visible)&&(t.visible=o.doOverlapLessonContent(e)),t.display||(t.display={object:e}),t})},n);return n.labels&&(e.labelObject={id:"lesson",overrideChildLabel:function(e){var t=n.labels[e.display.object.name];return t&&e.labelObject&&(t.params=t.params||e.labelObject.params),t}}),e}})(a11y=a11y||{}),(n=>{n.getLinkAccessibilityData=function(e){var t={role:"link",href:n.getFirstContentObjectHref(),display:e.display,children:null};return n.copyBaseProperties(t,e)}})(a11y=a11y||{}),(l=>{function n(){var e,n,t=null==(t=a11yContent.openModalDialogs)?void 0:t.pop();return t?((n=function(e){var t;e&&(null!=(t=e.accessible)&&t.children.forEach(function(e){var e=e.accessible;e&&(e=document.getElementById(e.domId))&&(e.inert=!1)}),e.accessible&&e.accessible.role===l.matchRole("dialog")?(t=document.getElementById(e.accessible.domId))&&(t.inert=!1):n(null==(t=e.accessibleData)?void 0:t.parent))})(null==(e=t.accessibleData)?void 0:e.parent),t.modalFocused=!1,l.focusFromHistory()):__debugA11y&&console.warn("There are no open dialogs! So we can't hide or close one!"),t}l.doOnDialogHide=n,l.closeDialog=function(){var e,t=n();null!=(e=null==t?void 0:t.parent)&&e.removeChild(t),l.updateAccessibility()},l.getModalDialogAccessibilityData=function(e){var t,n=e.display,o=e.onKeydown,r=e.onEsc,i=void 0===(i=e.visible)?n.object.visible:i,a=(a=n.object.getBounds())&&0<a.width&&0<a.height,s={onCanvasFocus:function(){var e,o,r;(null==(e=n.object.accessible)?void 0:e.role)===l.matchRole("dialog")&&((o=function(e){if(e)for(var t=0;t<e.length;t++){var n=e[t].accessible;if(n){var n=n.domId,n=document.getElementById(n);if(0===(null==n?void 0:n.tabIndex))return void l.focusElement(e[t],!0)}o(null==(n=e[t].accessible)?void 0:n.children)}})(null==(e=n.object.accessible)?void 0:e.children),(r=function(e,n){var t;e&&(null!=(t=e.accessible)&&t.children.forEach(function(e){var t=e.accessible;t&&e!==n&&(e=document.getElementById(t.domId))&&!e.hasAttribute("aria-live")&&(e.inert=!0)}),r(null==(t=null==(t=e.accessible)?void 0:t.parent)?void 0:t.displayObject,e))})(null==(e=null==(e=n.object.accessible)?void 0:e.parent)?void 0:e.displayObject,n.object))}};return r&&(e.onKeydown=function(e){return"Escape"===e?(r(),!0):!!o&&o(e)}),i&&a&&(a11yContent.openModalDialogs||(a11yContent.openModalDialogs=[]),0!==(t=a11yContent.openModalDialogs).length&&t[t.length-1]===n.object||a11yContent.openModalDialogs.push(n.object)),i&&a?l.copyBaseProperties({role:AccessibilityModule.ROLES.DIALOG,tabIndex:-1,focus:s,children:e.children},e):l.copyBaseProperties({role:"span",enabled:!1,tabIndex:-1,focus:s},e)}})(a11y=a11y||{}),(o=>{o.getRadioAccessibilityData=function(t){var e={role:"radio",display:t.display,onSubmit:function(){var e;null!=(e=t.display.object)&&e.dispatchEvent("click")},onChange:function(){var e;t.noCheckOnFocus||null==(e=t.display.object)||e.dispatchEvent("click")},children:null},n=null==(n=t.display.object)?void 0:n.group;return n&&(e.name="radiogroup-".concat(n)),o.copyBaseProperties(e,t)}})(a11y=a11y||{}),(n=>{n.getSwitchAccessibilityData=function(t){return n.copyBaseProperties({role:"switch",onKeydown:function(e){return(e==n.KEYBOARD_KEYS.ENTER||e==n.KEYBOARD_KEYS.SPACE)&&(t.toggle(),!0)}},t)}})(a11y=a11y||{}),(n=>{n.getTableAccessibilityData=function(e){var t={role:"table",tabIndex:-1,children:[{role:"tableBody",display:{id:"tbody"},enabled:!1,tabIndex:-1,children:e.tableData.map(function(e,t){return{role:"row",display:{id:e.id},enabled:!1,tabIndex:-1,children:e.cells.map(function(e,t){return{role:"gridcell",display:{id:e.id},enabled:!1,tabIndex:-1,children:[e]}})}})}]};return n.copyBaseProperties(t,e)}})(a11y=a11y||{}),(DBLAlign||(DBLAlign={})).align=function(e){var t,n,o,r;switch(e.containerBounds||(e.containerBounds=e.container.getBounds()),e.childBounds||(e.childBounds=e.child.getBounds()),e.padding||(e.padding=0),e.horizontal){case"left":t=e.containerBounds.x,o=-e.childBounds.x+e.padding;break;case"center":t=e.containerBounds.x+.5*e.containerBounds.width,o=-e.childBounds.x-.5*e.childBounds.width;break;case"right":t=e.containerBounds.x+e.containerBounds.width,o=-e.childBounds.x-e.childBounds.width-e.padding}switch(e.vertical){case"top":n=e.containerBounds.y,r=-e.childBounds.y+e.padding;break;case"center":n=e.containerBounds.y+.5*e.containerBounds.height,r=-e.childBounds.y-.5*e.childBounds.height;break;case"bottom":n=e.containerBounds.y+e.containerBounds.height,r=-e.childBounds.y-e.childBounds.height-e.padding}var i=e.container.localToGlobal(null!=t?t:0,null!=n?n:0),i=e.child.parent.globalToLocal(i.x,i.y);e.horizontal&&(e.child.x=i.x+o),e.vertical&&(e.child.y=i.y+r)},(c=>{function o(t,e,n){var o,r;if(void 0===n&&(n={}),e?("string"==typeof e?(r=a(e))||DBLLog.log("Can't find a loaded bundle "+e+" - has it been declared as a dependency, and do the FLA publish settings use "+e+"?",DBLLog.ERROR):r=e,r&&!(o=r[n=""==(n=t=n.localizeSymbol&&"string"==typeof t?Loc.localizeAsset(r.fqn,t):t)&&"string"==typeof e?e.split(".").pop():n])&&DBLLog.log("Can't find asset "+n+" in bundle "+e+" - is this a linkage identifier in the FLA?",DBLLog.ERROR)):(t||DBLLog.log("Please ensure that any assets required by the component have been specified.",DBLLog.ERROR),o=t),o){try{var i=new o}catch(e){DBLLog.log("Failed to create asset "+t,DBLLog.ERROR)}return i instanceof createjs.DisplayObject&&i.nominalBounds&&""!=t?i.setBounds(i.nominalBounds.x,i.nominalBounds.y,i.nominalBounds.width,i.nominalBounds.height):i&&r&&r.properties&&i.setBounds(0,0,r.properties.width,r.properties.height),i}}function t(e,t){var n;if(t=void 0===t?void 0:t){if("string"==typeof t){if(!(n=a(t)))return}else n=t;n=n[e=""==e?t.split(".").pop():e]}else n=e;return n}function a(e){return window[e.split(".").join("_")]}function r(e,t){(t=void 0===t?!1:t)?e.gotoAndPlay(e.currentFrame-1):e.advance();for(var n=0;n<e.children.length;n++)e.children[n]instanceof createjs.MovieClip&&r(e.children[n],t)}function n(e,t){if(t(e))return e;for(var n=e instanceof createjs.Container?e.children:[];0<n.length;){for(var o=[],r=0,i=n;r<i.length;r++){var a=i[r];if(t(a))return a;a instanceof createjs.Container&&o.push.apply(o,a.children)}n=o}return null}c.createArtFromBundle=function(e,t,n){return o(e,t,n=void 0===n?{}:n)},c.createArt=function(e){return"function"==typeof e?o(e):o("",e)},c.create=o,c.loadBundle=function(e,t,n){if(void 0===n&&(n=onStaticLoadFailed),(e=(e="string"==typeof e?[e]:e).filter(function(e){return!objectFromFQN(e)})).length){var o=new createjs.LoadQueue;o.stopOnError=!0,o.on("error",n),o.on("fileload",resetStaticLoadCount),o.on("complete",function(){o.removeAllEventListeners(),o.destroy(),t()}),o.on("fileload",onPotentialAnimateFileLoad);for(var r=0,i=e;r<i.length;r++){var a=i[r],s=fileFromFQN(a);DBLLog.log("Loading "+s,DBLLog.INFO),o.loadFile({src:s,id:a,loadTimeout:DEFAULT_LOAD_TIMEOUT},!1)}o.load()}else t()},c.resolveArtFromBundle=t,c.resolveArt=function(e){return"function"==typeof e?t(e):t("",e)},c.resolve=t,c.resolveBundle=a,c.setChildrenBounds=function e(t){t instanceof createjs.MovieClip&&t.gotoAndStop(0);for(var n=0;n<t.numChildren;n++){var o=t.children[n];o instanceof createjs.DisplayObject&&o.nominalBounds&&o.setBounds(o.nominalBounds.x,o.nominalBounds.y,o.nominalBounds.width,o.nominalBounds.height),o instanceof createjs.Container&&e(o)}},c.calculateBoundsFromChildren=function(e){for(var t=null,n=0,o=e.children;n<o.length;n++){var r,i=o[n];i instanceof createjs.DisplayObject&&((r=i.getTransformedBounds())||(i=i.nominalBounds)&&i instanceof createjs.Rectangle&&(r=i),r)&&(t=t?t.union(r):r)}t&&e.setBounds(t.x,t.y,t.width,t.height)},c.recalculateBounds=function(e){var t=e.nominalBounds;t?e.setBounds(t.x,t.y,t.width,t.height):c.calculateBoundsFromChildren(e)},c.recalculateChildrenBounds=function(e){(e.children||[]).forEach(function(e){e instanceof createjs.MovieClip&&c.recalculateBounds(e)})},c.playMovieClip=function e(t){t.play();for(var n=0;n<t.children.length;n++)t.children[n]instanceof createjs.MovieClip&&e(t.children[n])},c.advanceMovieClip=r,c.advancePlayingMovieClip=function e(t){if(t){!t.paused&&1<t.totalFrames&&t.advance();for(var n=0,o=t.children;n<o.length;n++){var r=o[n];r instanceof createjs.MovieClip&&e(r)}}},c.advanceAllClipsIn=function e(t){for(var n=0;n<t.children.length;n++)t.children[n]instanceof createjs.MovieClip?r(t.children[n]):t.children[n]instanceof createjs.Container&&e(t.children[n])},c.stopAllMovieClips=function e(t){t.stop();for(var n=0;n<t.children.length;n++)t.children[n]instanceof createjs.MovieClip&&e(t.children[n])},c.setNameAndBounds=function(e,t,n,o){void 0===o&&(o=1);var r,i,n=n instanceof createjs.Rectangle?n:n.nominalBounds;1!=o&&(r=(n=n.clone()).x+n.width/2,i=n.y+n.height/2,n.width*=o,n.height*=o,n.x=r-n.width/2,n.y=i-n.height/2),n?(e.name=t,e.setBounds(n.x,n.y,n.width,n.height)):DBLLog.log("No usable bounds available for object.",DBLLog.ERROR)},c.setChildrenNames=function(e){for(var t in e){var n;e.hasOwnProperty(t)&&e[t]instanceof createjs.DisplayObject&&(n=e[t]).parent===e&&(n.name=t)}},c.findNestedChild=n,c.findNestedChildByName=function(e,t){return n(e,function(e){return e.name==t})},c.findNestedChildByType=function(e,t){return n(e,function(e){return e instanceof t})},c.implement=function(e,t,n,o){void 0===n&&(n=null);var r=e.parent,o=((o=void 0===o?!0:o)&&r instanceof createjs.MovieClip&&r.gotoAndStop(0),r.getChildIndex(e)),i=(c=[e.x,e.y,e.scaleX,e.scaleY,e.rotation])[0],a=c[1],s=c[2],l=c[3],c=c[4],t=(e.x=0,e.y=0,e.scaleX=1,e.scaleY=1,new(t.bind.apply(t,__spreadArray([void(e.rotation=0)],n||[e],!1))));return r.addChildAt(t,o),e.parent==r&&r.removeChild(e),t.x=i,t.y=a,t.scaleX=s,t.scaleY=l,t.rotation=c,t},c.implementTextInput=function(e,t,n,o,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===o&&(o=null),void 0===r&&(r=!0);(e=c.findNestedChildByType(e,createjs.Text)).visible=!1;var i=e.x,a=e.getBounds().clone(),s=DBLFont.parseFontDescriptor(e.font),l=[a.width,a.height,s.name,s.size,e.textAlign,e.color];return(l=c.implement(e,DBLTextInput,l,r)).x="center"==e.textAlign?i-.5*a.width:i,l.fontWeight=s.weight,l.fixTextBaseline=!0,t&&l.setBackground(l.parent),n&&l.on(DBLTextInputEvent.CHANGE,n),o&&l.on(DBLTextInputEvent.ENTER_KEY,o),l},c.playSound=function(t,n){if(!__suppressIESFX&&!sfxMuted&&t){var o=__audioInstances[t];if(o)try{o.volume=1,o.stop(),o.play(n)}catch(e){o=__audioInstances[t]=createjs.Sound.play(t,n)}else o=__audioInstances[t]=createjs.Sound.play(t,n);return o}},c.stopSound=function(e){var t=__audioInstances[e],n=!!t;return t&&(n=!t.paused,t.stop(),t.removeAllEventListeners(),delete __audioInstances[e]),n},c.pauseSound=function(e){return!(!(e=__audioInstances[e])||e.getPaused())&&(e.paused=!0)},c.resumeSound=function(e){return!(!(e=__audioInstances[e])||!e.getPaused()||(e.play(),0))},c.getBundleAudioIds=function(e){if((e=a(e))&&e.properties){e=e.properties.manifest;if(e)return e.filter(function(e){return"string"==typeof e.src&&-1!=e.src.indexOf(".mp3")}).map(function(e){return e.id})}return[]}})(DBLAsset=DBLAsset||{}),(e=>{function R(e){return null==(e=t(e))?void 0:e.script}function t(e){for(var t=Loc.createLocaleMatcher(),n=0,o=mappings;n<o.length;n++){var r=o[n][e];r&&DBLUtils.isArray(r)&&0!=r.length&&r[0].language&&(r[0].file||__ttsInLesson)&&t.addFromList(r,"language")}return t.getBest()}function r(e,t){return!!e&&1==n(o(e),t)}function i(e,t){return!!e&&2==n(o(e),t)}function n(e,t){if(void 0===t&&(t=!0),!e)return 0;for(var n,o=!1,r=0;r<mappings.length;r++){var i=mappings[r].mappingfqn;!i||-1==i.indexOf(".Gender")||(o=!0,n=mappings[r][e])||(DBLLog.log("There is a Gender mapping file, but it does not contain '"+e+"' - assuming neutral (if this is an english word then no wonder - it means there is also no translation found for it)",t?DBLLog.WARN:DBLLog.INFO),mappings[r][e]="0")}return n||o||DBLLog.log("Please add a assets.translations.shared.Gender mapping - runtime had to assume '"+e+"' was neutral",DBLLog.WARN),n||0}function o(e){return DBLUtils.isAlpha(e.trim().substr(0,1))?e.trim().split(" ")[0].toLowerCase():""}function I(e){return"one"==e||"twentyone"==e||"thirtyone"==e||"fortyone"==e||"fiftyone"==e||"sixtyone"==e||"seventyone"==e||"eightyone"==e||"ninetyone"==e}function P(e,t){if("spanish"===language&&0<e.length&&t){var n;I(e[e.length-1].trim())&&(i(t,!1)?e[e.length-1]+="fem":r(t,!1)&&(e[e.length-1]+="alt"));for(var o=0;o<e.length;o++)"two hundred"!=(n=e[o].trim())&&"three hundred"!=n&&"four hundred"!=n&&"five hundred"!=n&&"six hundred"!=n&&"seven hundred"!=n&&"eight hundred"!=n&&"nine hundred"!=n||i(t,!1)&&(e[o]+="fem")}return e}function w(e,t,n,o){e.charAt(0)==DBLUtils.PLUS_SYMBOL.charAt(0)?(t.push("positive"),e=e.substr(1)):e.charAt(0)==DBLUtils.MINUS_SYMBOL.charAt(0)&&(t.push("negative"),e=e.substr(1));if(null!=e.match(/^(\d|\.)+$/)){if(o)t.push(e.toString());else for(var o=e.indexOf("."),r=0,i=0,a=k(+e,r=-1!=o?e.length-o-1:r);i<a.length;i++){var s=a[i];t.push(s)}return 1}N("Number (integer) expected: '"+e+"'",n?DBLLog.ERROR:DBLLog.INFO)}function M(e){return 0<=".-0123456789".indexOf(e)}function F(e){return 0<="abcdefghijklmnopqrstuvwxyz".indexOf(e)}function k(e,t){void 0===t&&(t=0);var n,o=["","thousand","million","billion","trillion","quadrillion","quintillion","sextillion","septillion"],r=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],i=["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],a=0,s=[],l=!1,c=0;if(0===e)s.push("zero");else{for(e<0&&(l=!0,e=Math.abs(e)),e!=Math.floor(e)&&(c=e-Math.floor(e),e=Math.floor(e));0<e;){if(o.length<=a)return N(e+" is too large to be converted!",DBLLog.DEBUG),null;var u,d=[],p=(u=e%1e3)%100,h=u%10,g=Math.floor(u/100),f=Math.floor(p/10);0<g?(d.push(r[g]+"hundred"),"GB"===dialect&&0!=p&&d.push("and")):"GB"===dialect&&100<e&&0!=p&&0===a&&d.push("and"),p<20?d.push(r[p]):(g=i[f],0<h&&(g+=r[h]),d.push(g)),0<d.length&&(0<o[a].length&&(1==u&&1==a?(d.pop(),d.push("onethousand")):1==d.length&&0==d[0].length||d.push(o[a])),s=d.concat(s)),e=Math.floor(e/1e3),a++}if(l&&s.unshift("negative"),0<c||0<t)if(c=Math.round(1e9*c)/1e9,"spanish"!=language)for(s.push("point"),m=1;m<=10&&(c*=10,n=Math.floor(c),c-=Math.floor(c),c=Math.round(1e9*c)/1e9,0==n?s.push("zero"):s.push(r[n]),m!=t)&&(0!=c||0!=t);m++);else{s.push("point");for(var _="",m=1;m<=10&&(c*=10,n=Math.floor(c),c-=Math.floor(c),c=Math.round(1e9*c)/1e9,0==n?s.push("zero"):_+=n.toString(),m!=t)&&(0!=c||0!=t);m++);l=k(parseInt(_)),s=s.concat(l)}for(var y=0;y<s.length;y++)0==s[y].length&&(s.splice(y,1),y--);if("spanish"===language)for(y=0;y<s.length;y++){var v=!1;if(y<s.length-1)for(var L=0;L<o.length;L++)if(s[y+1]==o[L]){v=!0;break}"onehundred"==s[y]&&(s[y]="hundred"),"hundred"==s[y]&&y<s.length-1&&(v||(s[y]+="alt")),I(s[y])&&y<s.length-1&&v&&(s[y]+="alt"),"onethousand"==s[y]&&(s[y]="thousand")}}return s}function N(e,t){void 0===t&&(t=0),DBLLog.log(e,t||DBLLog.ERROR)}function U(e){for(var t,n=[],o=!1,r="",i="",a=0;a<e.length;a++){var s=e.charAt(a);if("/"==s){if(o||0==i.length)return n;o=!0}else{if(!M(s))return n;0==o?i+=s:r+=s}}return 0<i.length&&0<r.length?((t=[]).push(i),t.push(r),t):n}e.lookupVariableAudioFile=function(e){return null==(e=t(e))?void 0:e.file},e.lookupVariableAudioScript=R,e.isMasculine=r,e.isFeminine=i,e.numberToStringArray=function(e,t,n,o){if(void 0===t&&(t=""),void 0===n&&(n=!1),void 0===o&&(o=!1),"number"==typeof(e="string"==typeof e&&e.match(/^(\d|\.)+$/)?parseFloat(e):e))return P(k(e),t);var r=!1,i=-1,a=-2,s=e;if(0==(s=s.trim()).length)return null;if(s.match(DBLPlay.SCI_EXP_FILTER_WRITTEN))return null;var l=-1!=(s=(s=(s=s.replace(/(\d) +\/ +(\d)/g,"$1/$2")).replace(/divided by/g,"dividedby")).replace(/÷/g," dividedby ")).indexOf(":"),c=(s=s.replace(/:00/g,""),"english"===language?s=s.replace(/:0/g," oh "):"spanish"===language&&(s=s.replace(/:0/g," zero ")),-1!=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/:/g," ")).replace(/\(-(\d+)\)/g,"-$1")).replace(/¹/g," tothefirstpower ")).replace(/²/g," squared ")).replace(/³/g," cubed ")).replace(/%/g," % ")).replace(/\(/g," ( ")).replace(/\)/g," ) ")).replace(/\+/g," + ")).replace(/\|/g," | ")).replace(/\^/g," ^ ")).replace(/(-?√)/g," $1 ")).indexOf("^")&&(s+=" ",s=(s=(s=Math.random()<.5?(s=(s=(s=(s=s.replace(/ \^ 1 /g," tothefirstpower ")).replace(/ \^ 2 /g," squared ")).replace(/ \^ 3 /g," cubed ")).replace(/ \^ 4 /g," tothefourthpower ")).replace(/ \^ 5 /g," tothefifthpower "):s).replace(/ \^ /g," tothepowerof ")).substr(0,s.length-1)),(s=s.replace(/^\s+|\s+$/g,"")).split(/[\s]+/));if(null==c||0==c.length)return null;for(var u=[],d=(R(s.replace(/\s+/g," ").toLowerCase())&&(u.push(s.replace(/\s+/g," ").toLowerCase()),c=[]),"spanish"==language&&l&&0<c.length&&"1"==c[0]&&(c[0]="onefem"),0);0<c.length;){i++;var p=c.shift().toString().toLowerCase(),h=(e=>{for(var t=1,n="",o="",r=0;r<e.length;r++){var i=e.substr(r,1);if(M(i)&&1==t)n+=i;else{if(!F(i))return[];t=2,o+=i}}return 0<n.length&&0<o.length?[n,o]:[]})(p);switch(2==h.length&&(p=h[0],c.unshift(h[1])),p){case"x":u.push("x");break;case"n":u.push("n");break;case"double":_=f=g=void 0;var g=c,f=u;if(0==g.length)f.push("doublethenumber");else{f.push("doublethenumberthen");var _=g.shift();switch(_){case DBLUtils.PLUS_SYMBOL:f.push("add");break;case DBLUtils.MINUS_SYMBOL:f.push("subtract");break;default:N("Unknown item in double sentence: "+_)}}break;case"+":u.push("plus");break;case"-":u.push("minus");break;case DBLUtils.TIMES_SYMBOL:case"*":case"times":u.push("times");break;case"%":u.push("percent");break;case"(":u.push("thequantityof");break;case")":break;case"|":++d%2==1&&u.push("theabsolutevalueof");break;case DBLUtils.LT_SYMBOL:u.push("islessthan");break;case DBLUtils.GT_SYMBOL:u.push("isgreaterthan");break;case DBLUtils.LE_SYMBOL:case"le":case"<=":u.push("islessthanorequalto");break;case DBLUtils.GE_SYMBOL:case"ge":case">=":u.push("isgreaterthanorequalto");break;case DBLUtils.EQUAL_SYMBOL:u.push("equals");break;case DBLUtils.NE_SYMBOL:case"ne":case"!=":u.push("doesnotequal");break;case"point":u.push("point");break;case"√":u.push("squarerootof");break;case"-√":u.push("negativesquarerootof");break;default:if(R(p))u.push(p);else if("$"==p.charAt(0)){v=y=m=g=void 0;var g=p.substr(1),m=u,y=o,g=+g,v=Math.floor(g),g=Math.round(100*(g-v));1<=v&&(w(v.toString(),m,!0,y),"spanish"===language&&0<m.length&&"one"==m[m.length-1]&&(m[m.length-1]="onealt"),1==v?m.push("dollar"):m.push("dollars"),0!=g)&&("spanish"===language?m.push("with"):m.push("and")),0!=g&&(w(g.toString(),m,!0,y),1==g?m.push("cent"):m.push("cents"))}else if(2==U(p).length)if("spanish"===language){b=m=y=L=v=void 0;var v=p,L=u,y=a==i-1,m=o,b="1"==(v=U(v))[0]||"-1"==v[0];if(y&&L.push("and"),w(v[0],L,!1,m),I(L[L.length-1])&&(L[L.length-1]+="alt"),1<=parseInt(v[1])&&parseInt(v[1])<=10)switch(v[1]){case"1":L.push(b?"whole":"wholes");break;case"2":L.push(b?"half":"halves");break;case"3":L.push(b?"third":"thirds");break;case"4":L.push(b?"fourth":"fourths");break;case"5":L.push(b?"fifth":"fifths");break;case"6":L.push(b?"sixth":"sixths");break;case"7":L.push(b?"seventh":"sevenths");break;case"8":L.push(b?"eighth":"eighths");break;case"9":L.push(b?"ninth":"ninths");break;case"10":L.push(b?"tenth":"tenths")}else w(v[1],L,!1,!1),b?L.push("avo"):L.push("avos")}else{T=x=B=A=S=D=E=void 0;var D=u,S=a==i-1,A=o,E=U(E=p),B=new Array,x="1"==E[0]||"-1"==E[0],T=null;if(S&&D.push("and"),w(E[0],D,false,A),"1"==E[1])D.push(x?"whole":"wholes");else if("2"==E[1])D.push(x?"half":"halves");else{S=E[1];for(2<=S.length&&"0"!=(A=S.charAt(S.length-2))&&"1"!=A&&"0"!=S.charAt(S.length-1)&&(T=S.charAt(S.length-1),S=S.substr(0,S.length-1)+"0"),w(S,B,!1,!1);1<B.length;)D.push(B.shift());if("one"==(E=B.shift()).substr(0,3)&&(E=E.substr(3)),null!=T){for(D.push(E),w(T,B,!1,!1);1<B.length;)D.push(B.shift());E=B.shift()}j[E];E in j?D.push(j[E]+(x?"":"s")):D.push(E)}}else if(w(p,u,!1,o))a=i;else{var C=!1;if((e=>{for(var t=0;t<e.length;t++)if(!F(e.substr(t,1)))return;return 1})(p))for(var C=!0,O=0;O<p.length;O++)if(!R(p.substr(O,1))){C=!1;break}if(C)for(O=0;O<p.length;O++)u.push(p.substr(O,1));else{A=n?DBLLog.ERROR:DBLLog.INFO;DBLLog.log("Unable to convert part '"+p+"' to string. Input was '"+e+"'",A),r=!0}}}}return r?null:P(u,t)},e.aaa=function(){console.log("aaa")},e.isLetter=F;var j={one:"first",two:"second",three:"third",four:"GB"===dialect?"quarter":"fourth",five:"fifth",six:"sixth",seven:"seventh",eight:"eighth",nine:"ninth",ten:"tenth",eleven:"eleventh",twelve:"twelfth",thirteen:"thirteenth",fourteen:"fourteenth",fifteen:"fifteenth",sixteen:"sixteenth",seventeen:"seventeenth",eighteen:"eighteenth",nineteen:"nineteenth",twenty:"twentieth",thirty:"thirtieth",forty:"fortieth",fifty:"fiftieth",sixty:"sixtieth",seventy:"seventieth",eighty:"eightieth",ninety:"ninetieth",hundred:"hundredth",thousand:"thousandth"};function a(e){var t;return"hour"==e||(F(t=e.substr(0,1).toLowerCase())||DBLLog.log("needsA/An expecting a word - got "+e,DBLLog.WARN),0<="aeiou".indexOf(t))}e.needsAn=a,e.needsA=function(e){return!a(e)}})(DBLAudioUtils=DBLAudioUtils||{}),!function(DBLAutomation){var lastConfiguration;function init(){lastConfiguration={}}function recordClick(e,t,n){var o,r;void 0===t&&(t=null),a11y.skipRecord("click")||(recordConfiguration(),r="> click"+((o=getToolNameFromObject(e))?" "+o:""),null!=t&&(r+=" at "+toStringValue(t)),n&&(r+=" with "+toStringValue(n)),logAutomation(r),window.DfhgSgh&&e&&("boolean"==typeof e.isHintButton&&e.isHintButton?window.DfhgSgh.htcfwm():window.DfhgSgh.mpajt(o)))}function logScreenClick(e){logShellAction('> click screen at "'+e+'"')}function recordSnapshot(){logAutomation("snapshot")}function recordDrag(e,t,n,o,r){var i;void 0===n&&(n=null),void 0===o&&(o=void 0),void 0===r&&(r=void 0),a11y.skipRecord("drag")||(t==DBLAutomation.START&&recordConfiguration(),i="> drag "+t+" in "+(e=getToolNameFromObject(e)),"start"!=t&&"drop"!=t&&"over"!=t||(i+=": "+toStringValue(n),null!=o&&null!=r&&(i+=" "+o+" "+toStringValue(r))),logAutomation(i),window.DfhgSgh&&window.DfhgSgh.mpajt(3<__asDataVersion?e:void 0))}function toStringValue(e){return"string"==typeof e?'"'+e+'"':"number"==typeof e||"boolean"==typeof e?e.toString():JSON.stringify(e)}function fromStringValue(e){return'"'==e.substr(0,1)?e.substr(1,e.length-2):"{"==e.substr(0,1)?JSON.parse(e):parseFloat(e)}function recordEdit(e,t,n){var o,r;void 0===n&&(n=void 0),a11y.skipRecord("edit")||(recordConfiguration(),o=getToolNameFromObject(e),r="> edit ",e&&(r+=o),r=(r=(r+=" ")+(null!=n?toStringValue(n):"value")+" = ")+toStringValue(t),logAutomation(r),window.DfhgSgh&&window.DfhgSgh.mpajt(3<__asDataVersion?o:void 0))}function recordMouse(e,t,n,o){t==DBLAutomation.DOWN&&recordConfiguration();var r=getToolNameFromObject(e),t="> mouse "+t+" in "+getToolNameFromObject(e)+" at "+n+","+o;logAutomation(t),window.DfhgSgh&&window.DfhgSgh.mpajt(3<__asDataVersion?r:void 0)}function recordHighlight(e,t){void 0===t&&(t=null),recordConfiguration();e="highlight "+getToolNameFromObject(e);t&&(e+=" ("+t+")"),logAutomation(e)}function recordAnimation(e,t){void 0===t&&(t=null),recordConfiguration();e="animate "+getToolNameFromObject(e);t&&(e+=" ("+t+")"),logAutomation(e)}function getTopLevelComponent(e){for(;e;){if(e.parent==lessonContent)return e;e=e.parent}return null}function recordUserExit(){recordConfiguration(),logAutomation("> exit")}function isRunningAutomation(){return isRunningAutomationTop()}function recordA11y(e){recordConfiguration(!0),logAutomation("> a11y ".concat(JSON.stringify(e)))}function recordConfiguration(e){void 0===e&&(e=!1);var t,n,o={},r=!1,i=components;for(t in screencur&&(i={screen:screencur},shell)&&(i.shell=shell),i){var a,s,l=i[t];"function"==typeof l.recordConfiguration&&((a=l.recordConfiguration.call(l))&&0==l.visible&&(a="hidden"),s=delta(lastConfiguration[t],a))&&(r=!0,o[t]=s,lastConfiguration[t]=a)}e&&(e="a11y",n=a11y.recordConfiguration(),s=delta(lastConfiguration[e],n))&&(o[e]=s,lastConfiguration[e]=n,r=!0),r&&logConfiguration(getConfigurationString(o))}function getConfigurationString(t){var e=Object.keys(t).sort().map(function(e){return"".concat(e,": ").concat(JSON.stringify(t[e]))}).join(", ");return e=0<e.length?"{"+e+"}":e}function delta(e,t){return deltaIsHash(e)&&deltaIsHash(t)?JSON.stringify(e)!=JSON.stringify(t)?deltaRecurse(e,t):null:e!=t?t:null}function deltaIsHash(e){return null!=e&&"object"==typeof e}function deltaIsLiteral(e){return null==e||"object"!=typeof e}function deltaRecurse(e,t){var n,o={};for(n in t){var r=deltaIsLiteral(e[n]),i=deltaIsLiteral(t[n]);(!r&&!i&&JSON.stringify(e[n])!=JSON.stringify(t[n])||r&&i&&e[n]!=t[n]||r!=i)&&(deltaIsHash(e[n])&&deltaIsHash(t[n])?o[n]=deltaRecurse(e[n],t[n]):o[n]=t[n])}return o}function splitCommands(e){var t=new Array,n=0,o=0,r=!1,i=!1;e=e.concat(" ");for(var a=0;a<e.length;a++){var s=e.charAt(a),l=r||i;" "!=s||0!=o||l||(n<a&&t.push(e.substring(n,a)),n=a+1),"{"!=s||l||o++,"}"!=s||l||o--,'"'!=s||r||(i=!i),"'"!=s||i||(r=!r)}return t}function run(line){var ret,a=(assert(!replayMode),splitCommands(line)),s,component,location,value,relation,event,x,y,n;if(">"==a[0]){if(!__interactive)return!1;if(1==a.length)return commandFormatError();var cmd=a[1],obj,obj,s,value,component,x,y,obj,event,comment,response;switch(cmd){case"exit":return userExit(),!0;case"click":if(2==a.length)return clickFormatError();if(component=a[2],3<a.length){if("at"!=a[3])return clickFormatError();if(4==a.length)return clickFormatError();s=a[4],location=fromStringValue(s)}if(5<a.length){if("with"!=a[5]||6==a.length)return clickFormatError();value=fromStringValue(a[6])}return"shell"==component?shell.playbackClick.call(shell,location):"screen"==component?!!screencur&&("function"!=typeof screencur.playbackClick?automationSupportError("screen"):screencur.playbackClick.call(screencur,location)):"debugPanel"==component?void(lesson&&"function"==typeof lesson.playbackDebugPanelClick&&lesson.playbackDebugPanelClick.call(lesson,location)):(obj=components[component],obj?"function"!=typeof obj.playbackClick?automationSupportError(component):obj.playbackClick.call(obj,location,value):unknownComponentError(component));case"drag":if(2==a.length)return dragFormatError();if(s=a[2],s!=DBLAutomation.START&&s!=DBLAutomation.DROP&&s!=DBLAutomation.CANCELED&&s!=DBLAutomation.OVER)return dragFormatError();if(event=s,3==a.length||"in"!=a[3])return dragFormatError();if(4==a.length)return dragFormatError();if(s=a[4],":"==s.substr(s.length-1,1)&&(s=s.substr(0,s.length-1)),component=s,!(4<a.length&&event==DBLAutomation.CANCELED)){if(5==a.length)return dragFormatError();if(s=a[5],value=fromStringValue(s),6<a.length){if(a[6]!=DBLAutomation.AT&&a[6]!=DBLAutomation.AFTER&&a[6]!=DBLAutomation.BEFORE&&a[6]!=DBLAutomation.AWAY)return dragFormatError();if(relation=a[6],7==a.length)return dragFormatError();if(location=fromStringValue(a[7]),8<a.length)return dragFormatError()}}var obj=components[component];return obj?"function"!=typeof obj.playbackDrag?automationSupportError(component):obj.playbackDrag.call(obj,event,value,relation,location):unknownComponentError(component);case"edit":return 2==a.length?editFormatError():(component=a[2],3==a.length||("value"!=a[3]&&(location=fromStringValue(a[3])),4==a.length)||"="!=a[4]||5==a.length||(s=a[5],value=fromStringValue(s),6<a.length)?editFormatError():(obj=components[component],obj?"function"!=typeof obj.playbackEdit?automationSupportError(component):obj.playbackEdit.call(obj,value,location):unknownComponentError(component)));case"mouse":return 2==a.length||"down"!=a[2]&&"over"!=a[2]&&"up"!=a[2]?mouseFormatError():(event=a[2],3==a.length||"in"!=a[3]||4==a.length||(component=a[4],5==a.length)||"at"!=a[5]||6==a.length||(s=a[6],7<a.length)||2!=s.split(",").length?mouseFormatError():(x=s.split(",")[0],y=s.split(",")[1],obj=components[component],obj?"function"!=typeof obj.playbackMouse?automationSupportError(component):obj.playbackMouse.call(obj,event,x,y):unknownComponentError(component)));case"wait":return 2==a.length?waitFormatError():(logAutomation("> wait "+a[2]),addTime(eval(a[2])),!(3<a.length)||waitFormatError());case"help":return userHelp(),!0;case"answer":return 2==a.length?answerFormatError():(recordConfiguration(),extendedRun("correct"==a[2]?"correct":"incorrect"),!(3<a.length)||waitFormatError());case"restart":return 2<a.length?restartFormatError():(recordConfiguration(),extendedRun("restart"),!0);case"pass":return 2<a.length?passFormatError():(recordConfiguration(),extendedRun("pass"),!0);case"fail":return 2<a.length?failFormatError():(recordConfiguration(),extendedRun("fail"),!0);case"comment":return 2==a.length?commentFormatError():(comment=a[2],3<a.length?commentFormatError():(recordConfiguration(),extendedRun("comment",comment.substr(1,comment.length-2)),!0));case"sim":return!0;case"a11y":return a11y.playbackA11y(JSON.parse(a[2]));default:return DBLLog.log("Unknown command '"+a[1]+"'.",DBLLog.ERROR),!1}}}function automationInputLineToJSON(e){var t,n,o,r,i,a,s,l=splitCommands(e);if(assert(">"==l[0]),1==l.length)return commandFormatError();switch(l[1]){case"click":if(2==l.length)return clickFormatError();if(o=l[2],3<l.length){if("at"!=l[3])return clickFormatError();if(4==l.length)return clickFormatError();t=fromStringValue(i=l[4])}if(5<l.length){if("with"!=l[5]||6==l.length)return clickFormatError();s=fromStringValue(l[6])}return"shell"!==o&&"screen"!==o?components[o]?(n={component:o,type:"click"},void 0!==t&&(n.location=t),void 0!==s&&(n.value=s),n):(debug&&unknownComponentError(o),null):null;case"drag":if(2==l.length)return dragFormatError();if((i=l[2])!=DBLAutomation.START&&i!=DBLAutomation.DROP&&i!=DBLAutomation.CANCELED&&i!=DBLAutomation.OVER)return dragFormatError();if(a=i,3==l.length||"in"!=l[3])return dragFormatError();if(4==l.length)return dragFormatError();if(o=i=":"==(i=l[4]).substr(i.length-1,1)?i.substr(0,i.length-1):i,!(4<l.length&&a==DBLAutomation.CANCELED)){if(5==l.length)return dragFormatError();if(s=fromStringValue(i=l[5]),6<l.length){if(l[6]!=DBLAutomation.AT&&l[6]!=DBLAutomation.AFTER&&l[6]!=DBLAutomation.BEFORE&&l[6]!=DBLAutomation.AWAY)return dragFormatError();if(r=l[6],7==l.length)return dragFormatError();if(t=fromStringValue(l[7]),8<l.length)return dragFormatError()}}return components[o]?(n={type:"drag-"+a,component:o},void 0!==s&&(n.value=s),void 0!==r&&(n.relation=r),void 0!==t&&(n.location=t),n):unknownComponentError(o);case"edit":return 2==l.length?editFormatError():(o=l[2],3==l.length||("value"!=l[3]&&(t=fromStringValue(l[3])),4==l.length)||"="!=l[4]||5==l.length||(s=fromStringValue(i=l[5]),6<l.length)?editFormatError():components[o]?(n={component:o,type:"edit"},void 0!==s&&(n.value=s),void 0!==t&&(n.location=t),n):unknownComponentError(o));case"mouse":return 2==l.length||"down"!=l[2]&&"over"!=l[2]&&"up"!=l[2]?mouseFormatError():(a=l[2],3==l.length||"in"!=l[3]||4==l.length||(o=l[4],5==l.length)||"at"!=l[5]||6==l.length||(i=l[6],7<l.length)||2!=(r=i.split(",")).length?mouseFormatError():{type:"mouse",component:o,x:r[0],y:r[1],event:a});case"help":return{type:"help"};case"answer":return 2==l.length?answerFormatError():{type:"answer",result:l[2]};case"restart":return 2<l.length?restartFormatError():{type:"restart"};case"pass":return 2<l.length?passFormatError():{type:"pass"};case"fail":return 2<l.length?failFormatError():{type:"fail"};case"comment":return 2==l.length?commentFormatError():(s=l[2],3<l.length?commentFormatError():{type:"comment",comment:s.substr(1,s.length-2)})}}function runParsed(e){if(assert(replayMode),!__interactive)return!1;switch(e.type){case"exit":return!0;case"click":return"shell"==e.component||"screen"==e.component?(assert(!1),!1):(n=components[e.component])?"function"!=typeof n.playbackClick?automationSupportError(e.component):n.playbackClick.call(n,e.location,e.value):unknownComponentError(e.component);case"drag-start":case"drag-drop":case"drag-canceled":var t=e.type.substr(5);return(n=components[e.component])?"function"!=typeof n.playbackDrag?automationSupportError(e.component):n.playbackDrag.call(n,t,e.value,e.relation,e.location):unknownComponentError(e.component);case"edit":return(n=components[e.component])?"function"!=typeof n.playbackEdit?automationSupportError(e.component):n.playbackEdit.call(n,e.value,e.location):unknownComponentError(e.component);case"mouse":var n;return(n=components[e.component])?"function"!=typeof n.playbackMouse?automationSupportError(e.component):n.playbackMouse.call(n,e.event,e.x,e.y):unknownComponentError(e.component);case"wait":return assert(!1),!0;case"help":return userHelp(),!0;case"answer":return recordConfiguration(),extendedRun(e.result),!0;case"restart":return recordConfiguration(),extendedRun("restart"),!0;case"pass":return recordConfiguration(),extendedRun("pass"),!0;case"fail":return recordConfiguration(),extendedRun("fail"),!0;case"comment":return recordConfiguration(),extendedRun("comment",e.comment),!0;case"sim":return assert(!1),!0;default:return DBLLog.log("Unknown command '"+e.type+"'.",DBLLog.ERROR),!1}}function getTranscriptEntry(e){var t,n,o,r;return">"==e.substr(0,1)?automationInputLineToJSON(e):"exit lesson"==e.substr(0,11)?{type:"exit"}:'play "'==e.substr(0,6)?{type:"play",text:e.substr(6,e.length-6-1)}:'playTTS "'==e.substr(0,9)?{type:"play",text:e.substr(9,e.length-9-1)}:'playText "'==e.substr(0,10)?{type:"play-text",text:e.substr(10,e.length-10-1)}:'playTextPlus "'==e.substr(0,14)?{type:"play-text-plus",text:e.substr(14,e.length-14-1)}:'playTextPlusAuto "'==e.substr(0,18)?{type:"play-text-plus-auto",text:e.substr(18,e.length-18-1)}:"playAcademic "==e.substr(0,13)?{type:"play-academic",text:(r=JSON.parse("["+e.substr(13)+"]"))[0],args:r.slice(1)}:'playPopup("'==e.substr(0,11)?{type:"play-popup",id:e.substr(11,e.length-11-2)}:'playPopin("'==e.substr(0,11)?{type:"play-popin",id:e.substr(11,e.length-11-2)}:"progress "==e.substr(0,9)?(t=void 0,n=e.substr(9),DBLUtils.isDigit(n.substr(0,1))?(t=parseInt(n),n="complete"):"payoff"!=n&&(t=parseInt(n.split(",")[1].trim()),n=n.split(",")[0]),o={type:"progress-"+n},"payoff"!=n&&(o.value=t),o):"new problem"==e?{type:"new-problem"}:"new question"==e?{type:"new-question"}:"correct"==e?{type:"correct"}:"mistake "==e.substr(0,8)?{type:"mistake",ids:r=e.substr(8).split(",").map(function(e){return e.trim()})}:"strategy "==e.substr(0,9)?{type:"strategy",ids:r=e.substr(9).split(",").map(function(e){return e.trim()})}:"snapshot"==e?{type:"snapshot"}:"phase "==e.substr(0,6)?{type:"phase",n:parseInt(e.substr(6))}:null}function unknownComponentError(e){return DBLLog.log("Component '"+e+"' not found in lesson.",DBLLog.ERROR),!1}function automationSupportError(e){return DBLLog.log("Component '"+e+"' does not implement IDBLAutomation.",DBLLog.ERROR),!1}function commandFormatError(){return DBLLog.log("Expecting command, e.g. click, drag, edit",DBLLog.ERROR),!1}function clickFormatError(){return DBLLog.log("Click command format is: > click tool [at location]",DBLLog.ERROR),!1}function dragFormatError(){return DBLLog.log("Drag command format is: > drag event in target [: value [at location|before location|after location]]",DBLLog.ERROR),!1}function editFormatError(){return DBLLog.log("Edit command format is: > edit target location|value = value",DBLLog.ERROR),!1}function mouseFormatError(){return DBLLog.log("Mouse command format is: > mouse up|over|down in target at x,y",DBLLog.ERROR),!1}function waitFormatError(){return DBLLog.log("Wait command format is: > wait (ms)",DBLLog.ERROR),!1}function answerFormatError(){return DBLLog.log("Answer command format is: > answer correct|incorrect",DBLLog.ERROR),!1}function simFormatError(){return DBLLog.log("Sim command format is: > sim api, return",DBLLog.ERROR),!1}function commentFormatError(){return DBLLog.log('Comment command format is: > comment "Comment string."',DBLLog.ERROR),!1}function restartFormatError(){return DBLLog.log("Restart command format is: > restart",DBLLog.ERROR),!1}function passFormatError(){return DBLLog.log("Pass command format is: > pass",DBLLog.ERROR),!1}function failFormatError(){return DBLLog.log("Fail command format is: > fail",DBLLog.ERROR),!1}function getToolNameFromObject(e){if(e===screencur)return"screen";if(e===shell)return"shell";if("debugPanel"===e)return"debugPanel";for(var t in components)if(components[t]==e)return t}function snapshot(){var e=new createjs.Container,e=(e.cache(0,0,SNAPSHOT_CANVAS_DIMENSIONS.width,SNAPSHOT_CANVAS_DIMENSIONS.height,1),e.cacheCanvas);return drawScreen(e,SNAPSHOT_CANVAS_DIMENSIONS.width/(1024*lessonContent.scaleX)),e.toDataURL("image/jpeg")}function drawScreen(e,t){e.getContext("2d").scale(t/dblDevicePixelRatio,t/dblDevicePixelRatio),isVisualCheckSave()&&updateCanvasData(),backgroundStage!=lessonStage&&e.getContext("2d").drawImage(backgroundStage.canvas,0,0),spriteStage&&(spriteStage.update(),e.getContext("2d").drawImage(spriteStage.canvas,0,0)),e.getContext("2d").drawImage(lessonStage.canvas,0,0),e.getContext("2d").drawImage(engagementStage.canvas,0,0)}function snapshotSimple(){var e=new createjs.Container,e=(e.cache(0,0,SNAPSHOT_CANVAS_DIMENSIONS.width,SNAPSHOT_CANVAS_DIMENSIONS.height,1),e.cacheCanvas);return drawScreenSimple(e,SNAPSHOT_CANVAS_DIMENSIONS.width/(1024*lessonContent.scaleX)),e.toDataURL("image/jpeg")}function drawScreenSimple(e,t){e.getContext("2d").scale(t/dblDevicePixelRatio,t/dblDevicePixelRatio),spriteStage&&(spriteStage.update(),e.getContext("2d").drawImage(spriteStage.canvas,0,0)),lessonContent.draw(e.getContext("2d"))}function updateCanvasData(){lessonStage&&engagementStage&&backgroundStage&&(lessonStage.update(),engagementStage.update(),backgroundStage!==lessonStage)&&backgroundStage.update()}DBLAutomation.AT="at",DBLAutomation.AFTER="after",DBLAutomation.BEFORE="before",DBLAutomation.AWAY="away",DBLAutomation.START="start",DBLAutomation.DROP="drop",DBLAutomation.CANCELED="canceled",DBLAutomation.DOWN="down",DBLAutomation.OVER="over",DBLAutomation.UP="up",DBLAutomation.init=init,DBLAutomation.recordClick=recordClick,DBLAutomation.logScreenClick=logScreenClick,DBLAutomation.recordSnapshot=recordSnapshot,DBLAutomation.recordDrag=recordDrag,DBLAutomation.recordEdit=recordEdit,DBLAutomation.recordMouse=recordMouse,DBLAutomation.recordHighlight=recordHighlight,DBLAutomation.recordAnimation=recordAnimation,DBLAutomation.getTopLevelComponent=getTopLevelComponent,DBLAutomation.recordUserExit=recordUserExit,DBLAutomation.isRunningAutomation=isRunningAutomation,DBLAutomation.recordA11y=recordA11y,DBLAutomation.recordConfiguration=recordConfiguration,DBLAutomation.getConfigurationString=getConfigurationString,DBLAutomation.splitCommands=splitCommands,DBLAutomation.run=run,DBLAutomation.runParsed=runParsed,DBLAutomation.getTranscriptEntry=getTranscriptEntry,DBLAutomation.snapshot=snapshot,DBLAutomation.snapshotSimple=snapshotSimple,DBLAutomation.updateCanvasData=updateCanvasData}(DBLAutomation=DBLAutomation||{}),(e=>{function t(){return!/(CrOS)/.test(navigator.userAgent)&&!(iOS||android||1==rootParams.mobile||1==rootParams.webview)}e.hasMouse=t,e.hasKeyboard=t})(DBLCapabilities=DBLCapabilities||{}),(e=>{var n,o,t,r,i,a=[],s="public/v1/users/USERID/clientEvents";function l(){c(),r=setTimeout(u,1e4)}function c(){r&&clearTimeout(r),r=0}function u(){authSession&&__studentId?(r=0)<a.length&&(n?t=!0:d()):0<a.length&&l()}function d(e){void 0===e&&(e=void 0),c(),i=e;e=serverURL+s.replace("USERID",__studentId),(n=new XMLHttpRequest).open("POST",e,!0),n.setRequestHeader("Content-type","application/json"),n.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&n.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),n.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),n.onreadystatechange=function(){try{var e;4==n.readyState&&(204==n.status?(o=[],n=null,i?(e=i,i=null,e()):t&&d()):0!=n.status&&p())}catch(e){throw dblRecordError(e),e}},n.onerror=function(){p()},e=rootParams.clienteventsmaxoverride||100;t=a.length<=e?(o=a,!(a=[])):(o=a.slice(0,e),a=a.slice(e),!0),n.send(JSON.stringify({events:o}))}function p(){var e=DBLError.TROUBLE_COMMUNICATING;if(400<=n.status&&n.status<=499)try{var t=JSON.parse(n.response);t&&t.errorCode&&(e=t.errorCode)}catch(e){}a=o.concat(a),o=[],DBLLog.log(s+" was unreachable: "+n.status+" "+e,DBLLog.ERROR),n=null,i&&(t=i,i=null,t())}e.cleanup=function(){c()},e.getUnsentEvents=function(){return c(),a},e.setUnsentEvents=function(e){a=e,l()},e.recordClientEvent=function(e,t,n,o){void 0===t&&(t=void 0),void 0===n&&(n=void 0),void 0===o&&(o=void 0),__clientEvents&&(e={id:uuidv4(),createdAt:(new Date).getTime(),type:e,key:t,value:void 0===n||"string"==typeof n?n:JSON.stringify(n)},o?e.pageName=o:lesson?(e.pageName=lessonfqn,e.lessonId=__lessonid,e.lessonInstanceUuid=__lessonuuid,__lessonpid&&(e.lessonPlayUuid=__lessonpid)):screencur?e.pageName=screenfqn:e.pageName="none",DBLLog.log("recordClientEvent: "+JSON.stringify(e),DBLLog.INFO),serverURL)&&(0==a.length&&l(),a.push(e))},e.sendNow=function(e){!n&&0<a.length&&authSession&&__studentId?d(e):e()}})(DBLClientEventManager=DBLClientEventManager||{}),(o=>{function r(e,t,n){t=o.call(this,r.COMPONENT_EVENT,t=void 0===t?!1:t,n=void 0===n?!1:n)||this;return t._subtype=e,t}return __extends(r,o),r.prototype.getSubtype=function(){return this._subtype},r.COMPONENT_EVENT="component_event",r})(createjs.Event)),DBLColorConverter,DBLColorManager,DBLCSVUtils,DBLCursor,DBLDictionary=((()=>{function i(e){return e<=0?0:1<=e?1:e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055}function a(e){return Math.min(1,Math.max(0,e))}(DBLColorConverter||(DBLColorConverter={})).oklchToHex=function(e){if(!(r=e.match(/oklch\s*\(([^)]+)\)/i)))return e;if((r=r[1].split("/")[0].replace(/,/g," ").trim().split(/\s+/)).length<3)throw new Error("Invalid OKLCH: missing components");var t,n=(e=>{var t;if(e=e.trim().match(/^([-+]?[\d.]+)(%)?$/i))return t=parseFloat(e[1]),e[2]&&(t/=100),a(t);throw new Error("Invalid L")})(r[0]),o=(e=>{if(/^none$/i.test(e))return 0;if(e=parseFloat(e),isFinite(e))return Math.max(0,e);throw new Error("Invalid C")})(r[1]),r=(e=>{if(/^none$/i.test(e))return 0;if(!(e=e.trim().match(/^([-+]?[\d.]+)(deg|rad|grad|turn)?$/i)))throw new Error("Invalid hue");var t=parseFloat(e[1]);switch((e[2]||"deg").toLowerCase()){case"deg":break;case"rad":t*=180/Math.PI;break;case"grad":t*=.9;break;case"turn":t*=360}return(t%360+360)%360})(r[2]),e=(e=>e=""!=(e=-1!=e.indexOf("/")?e.substring(e.indexOf("/")+2,e.indexOf("%")):"")&&1==(e=Math.round(2.55*Number(e)).toString(16)).length?"0"+e:e)(e);return o=(n={l:n,c:o,h:r}).l,r=n.c,n=n.h,t=r*Math.cos(n*Math.PI/180),r*=Math.sin(n*Math.PI/180),n=(e=>{var t=e.L,n=e.a,o=t+.3963377774*n+.2158037573*(e=e.b),r=t-.1055613458*n-.0638541728*e,t=t-.0894841775*n-1.291485548*e;return[4.0767416621*(n=o*o*o)-3.3077115913*(e=r*r*r)+.2309699292*(o=t*t*t),-1.2684380046*n+2.6097574011*e-.3413193965*o,-.0041960863*n-.7034186147*e+1.707614701*o]})({L:o,a:t,b:r}),o=n[0],t=n[1],r=n[2],n=Math.round(255*i(a(o))),o=Math.round(255*i(a(t))),t=Math.round(255*i(a(r))),((e,t,n)=>{function o(e){var e=e.toString(16),t=2,n="0";if(e.length>=t)return e;for(var o=t-e.length,r="";r.length<o;)r+=n;return r.slice(0,o)+e}return"#".concat(o(255&(0|e))).concat(o(255&(0|t))).concat(o(255&(0|n))).toUpperCase()})(n,o,t)+e}})(),(t=>{function e(){return"undefined"!=typeof CSS&&"function"==typeof CSS.supports&&CSS.supports("color","oklch(60% 0.15 200)")}function a(e){return t.supportingOklch?e:DBLColorConverter.oklchToHex(e)}function s(e,t){var n=.03*t,t=.004*t,e=e.toString(),n=(1-n).toString(),t=(.006+t).toString();return"oklch(".concat(n," ").concat(t," ").concat(e,")")}function l(e,t){e=e.match(/\d*\.?\d+/g);return a("oklch(".concat(e[0]," ").concat(e[1]," ").concat(e[2]," / ").concat(t.toString(),"% )"))}function c(e,t){e+=t;return 360<e&&(e-=360),e<0&&(e+=360),e}t.DEFAULT_PRIMARY_HUE=300,t.DEFAULT_ACCENT_HUE=178,t.supportingOklch=e(),t.supportsOklch=e,t.oklchToHex=function(e){return DBLColorConverter.oklchToHex(e)};var u={},d={},n=(t.color=function(e){var t=u[e]||d[e];return null==t&&console.error("missing color",e),t},t.assignColors=function(e,t,n){void 0===n&&(n=!1),n=e,u.engagement_surface_stroke="oklch(0.49 0.068 ".concat(n.toString(),")"),u.engagement_surface_1="oklch(0.14 0.077 ".concat(n.toString(),")"),u.engagement_surface_2="oklch(0.23 0.065 ".concat(n.toString(),")"),u.engagement_surface_3="oklch(0.28 0.070 ".concat(n.toString(),")"),u.engagement_surface_4="oklch(0.38 0.070 ".concat(n.toString(),")"),u.engagement_surface_5="oklch(0.50 0.068 ".concat(n.toString(),")"),u.engagement_surface_avatar_top="oklch(0.72 0.175 ".concat(n,")"),u.engagement_surface_avatar_bottom="oklch(0.67 0.216 ".concat(n,")"),u.engagement_surface_accent="oklch(0.91 0.130 ".concat(t.toString(),")");for(var o=0;o<=90;o+=10)u["engagement_surface_1_alpha_"+o]=l(u.engagement_surface_1,o);for(u.engagement_surface_3_alpha_0=l(u.engagement_surface_3,0),u.engagement_accent_top="oklch(0.91 0.130 ".concat(t.toString(),")"),u.engagement_accent_bottom="oklch(0.88 0.140 ".concat(c(t,25).toString(),")"),o=0;o<=90;o+=10)u["engagement_accent_top_alpha_"+o]=l(u.engagement_accent_top,o);u.engagement_status_default_top="#73FFD2",u.engagement_status_default_bottom="#06C9FF",u.engagement_status_new_top="#FF35CD",u.engagement_status_new_bottom="#FF8975",u.engagement_status_assigned_top="#B823C9",u.engagement_status_assigned_bottom="#45ADFF",u.engagement_status_duesoon_top="#FF8D02",u.engagement_status_duesoon_bottom="#FFD859",u.engagement_status_inprogress_top="#48FF69",u.engagement_status_inprogress_bottom="#21A795",u.engagement_on_surface_title=u.engagement_accent_top,u.engagement_on_surface_body="#FFFFFF",u.engagement_on_accent_title="#000000",u.engagement_on_accent_body="#000000",u.wallpaper_primary_1="oklch(0.16 0.087 ".concat(n.toString(),")"),u.wallpaper_primary_2="oklch(0.32 0.169 ".concat(n.toString(),")"),u.wallpaper_primary_3="oklch(0.35 0.181 ".concat(n.toString(),")"),u.wallpaper_primary_4="oklch(0.45 0.197 ".concat(n.toString(),")"),u.wallpaper_primary_5="oklch(0.48 0.224 ".concat(n.toString(),")"),d.lesson_surface_stroke=s(Number(e.toString()),0),d.lesson_surface_1=s(Number(e.toString()),0),d.lesson_surface_2=s(Number(e.toString()),1),d.lesson_surface_3=s(Number(e.toString()),2),d.lesson_surface_4=s(Number(e.toString()),3),d.lesson_surface_5=s(Number(e.toString()),4),d.lesson_surface_primary=s(Number(e.toString()),5);for(var r=0;r<=90;r+=10)d["lesson_surface_1_alpha_"+r]=l(d.lesson_surface_1,r);d.lesson_primary_main="oklch(0.38 0.093 ".concat(e.toString(),")"),d.lesson_primary_active="oklch(0.62 0.203 ".concat(c(e,10).toString(),")"),d.lesson_primary_disabled="oklch(0.56 0.077 ".concat(c(e,-10).toString(),")"),d.lesson_primary_reverse="#FFFFFF";for(var i,r=0;r<=90;r+=10)d["lesson_primary_main_alpha_"+r]=l(d.lesson_primary_main,r);for(i in d.lesson_secondary_1_1="oklch(0.45 0.238 ".concat(c(e,90).toString(),")"),d.lesson_secondary_1_2="oklch(0.63 0.175 ".concat(c(e,90).toString(),")"),d.lesson_secondary_1_3="oklch(0.75 0.117 ".concat(c(e,90).toString(),")"),d.lesson_secondary_1_4="oklch(0.87 0.056 ".concat(c(e,90).toString(),")"),d.lesson_secondary_1_stroke="oklch(0.52 0.223 ".concat(c(e,90).toString(),")"),d.lesson_secondary_1_alpha_75=l(d.lesson_secondary_1_1,75),d.lesson_secondary_1_alpha_50=l(d.lesson_secondary_1_1,50),d.lesson_secondary_1_alpha_25=l(d.lesson_secondary_1_1,25),d.lesson_secondary_1_alpha_0=l(d.lesson_secondary_1_1,0),d.lesson_secondary_2_1="oklch(0.45 0.238 ".concat(c(e,-90).toString(),")"),d.lesson_secondary_2_2="oklch(0.63 0.175 ".concat(c(e,-90).toString(),")"),d.lesson_secondary_2_3="oklch(0.75 0.117 ".concat(c(e,-90).toString(),")"),d.lesson_secondary_2_4="oklch(0.87 0.056 ".concat(c(e,-90).toString(),")"),d.lesson_secondary_2_stroke="oklch(0.52 0.223 ".concat(c(e,-90).toString(),")"),d.lesson_secondary_2_alpha_75=l(d.lesson_secondary_2_1,75),d.lesson_secondary_2_alpha_50=l(d.lesson_secondary_2_1,50),d.lesson_secondary_2_alpha_25=l(d.lesson_secondary_2_1,25),d.lesson_secondary_2_alpha_0=l(d.lesson_secondary_2_1,0),d.lesson_secondary_3_1="oklch(0.45 0.238 ".concat(c(e,180).toString(),")"),d.lesson_secondary_3_2="oklch(0.63 0.175 ".concat(c(e,180).toString(),")"),d.lesson_secondary_3_3="oklch(0.75 0.117 ".concat(c(e,180).toString(),")"),d.lesson_secondary_3_4="oklch(0.87 0.056 ".concat(c(e,180).toString(),")"),d.lesson_secondary_3_stroke="oklch(0.52 0.223 ".concat(c(e,180).toString(),")"),d.lesson_secondary_3_alpha_70=l(d.lesson_secondary_3_1,75),d.lesson_secondary_3_alpha_50=l(d.lesson_secondary_3_1,50),d.lesson_secondary_3_alpha_20=l(d.lesson_secondary_3_1,25),d.lesson_secondary_3_alpha_0=l(d.lesson_secondary_3_1,0),u)u[i]=a(u[i]);for(i in d)d[i]=a(d[i])},t.swatchBrightColor=function(e){return a("oklch(0.60 0.120 ".concat(e,")"))},t.swatchStrokeColor=function(e){return a("oklch(0.90 0.095 ".concat(e,")"))},t.swatchColor=function(e){return a("oklch(0.90 0.130 ".concat(e,")"))},t.swatchDarkColor=function(e){return a("oklch(0.19 0.040 ".concat(e-10,")"))},t.platform_logo_type=a("oklch(1 0 0)"),t.platform_logo_brand=a("oklch(1 0 0)"),"oklch(1 0 0)"),n=(t.platform_white_alpha_100=a(n),t.platform_white_alpha_90=l(n,90),t.platform_white_alpha_80=l(n,80),t.platform_white_alpha_70=l(n,70),t.platform_white_alpha_60=l(n,60),t.platform_white_alpha_50=l(n,50),t.platform_white_alpha_40=l(n,40),t.platform_white_alpha_30=l(n,30),t.platform_white_alpha_20=l(n,20),t.platform_white_alpha_10=l(n,10),t.platform_white_alpha_0=l(n,0),"oklch(0 0 0)");t.platform_black_alpha_100=a(n),t.platform_black_alpha_90=l(n,90),t.platform_black_alpha_80=l(n,80),t.platform_black_alpha_70=l(n,70),t.platform_black_alpha_60=l(n,60),t.platform_black_alpha_50=l(n,50),t.platform_black_alpha_40=l(n,40),t.platform_black_alpha_30=l(n,30),t.platform_black_alpha_20=l(n,20),t.platform_black_alpha_10=l(n,10),t.platform_black_alpha_0=l(n,0),t.platform_status_correct_fill="#D1FFD1",t.platform_status_correct_stroke="#00BA00",t.platform_status_correct_text="#006A00",t.platform_status_incorrect_fill="#FFEBD6",t.platform_status_incorrect_stroke="#FC6F08",t.platform_status_incorrect_text="#9E3500",t.platform_status_sign_positive="null",t.platform_status_sign_negative="null",t.platform_buttonsshared_icon="#FFFFFF",t.platform_buttonsshared_action="#0B88A8",t.platform_buttonsshared_confirm="#678731",t.platform_buttonsshared_caution="#CC6900",t.platform_buttonsshared_warning="#C6413B",t.platform_buttonsshared_help="#CC6900",t.splatform_buttonsshared__stroke="#FFFFFF",t.platform_highlight_user_fill_1="#33EDFF",t.platform_highlight_user_fill_2="#98F6FF",t.platform_highlight_user_stroke="#0087FF",t.platform_highlight_inner="#FFFF00",t.platform_highlight_outer="#B87700",t.platform_keynav_inner="#FFFFFF",t.platform_keynav_outer="#004B55",t.platform_text_on_mode="#000000"})(DBLColorManager=DBLColorManager||{}),(p=>{function a(e){return e.split(/\r?\n/).filter(function(e){return""!=e.trim()})}function s(e,t){var n=!1,o=[],r=[],i=e.split(""),a=0;do{if(0!=r.length||n||'"'!==i[a])if(n&&'"'===i[a]&&'"'===i[a+1])r.push(i[a]),a++;else if(!n||'"'!==i[a]||i[a+1]!==t&&void 0!==i[a+1])if(n||i[a]!==t)r.push(i[a]);else for(o.push(l(r.join("").trim())),r=[];" "===i[a+1]||"\t"===i[a+1];)a++;else for(n=!n,o.push(l(r.join(""))),r=[],a++;" "===i[a+1]||"\t"===i[a+1];)a++;else n=!n}while(++a<i.length);return o.push(l(r.join(""))),o}function l(e){return-1<e.indexOf("\\n")?e.replace(/\\n/g,"\n"):e}p.csvToJson=function(e,t,n){void 0===t&&(t=","),void 0===n&&(n={});var r,i,o=(e=a(e).map(function(e){return s(e,t)}))[0];return e=e.slice(1),r=o,i=n,e.map(function(o){return r.reduce(function(e,t,n){return e[t]=((t,e)=>{switch(e){case"boolean":return"true"==t.toLowerCase();case"number":return new Number(t);case"json":var n=void 0;if(t)try{n=JSON.parse(t)}catch(e){return void DBLLog.log("The string ".concat(t," cannot be parsed to JSON. Returning undefined."),DBLLog.INFO)}return n;default:return t}})(o[n],i[t]),e},{})})},p.splitIntoRows=a,p.parseRow=s,p.createIndexedCSVStructure=function(e,t){var n=p.csvToJson(e,",");if(!n)return null;if(0==n.length)return{};for(var o=-1==e.indexOf(",")?"":e.substr(0,e.indexOf(",")).trim(),r=-1<o.indexOf("unique"),i=null,a={},s={},l=0,c=n;l<c.length;l++){var u=c[l],d=u[o],u=(delete u[o],-1<o.indexOf("english")&&null==u.english&&(u.english=d),null!=i&&d==i||(a[d]?DBLLog.log(t+": all lines beginning with '"+d+"' should be grouped together.",DBLLog.ERROR):a[d]=!0,i=d),1==Object.keys(u).length?u[Object.keys(u)[0]]:u);s[d]?r?DBLLog.log("Key '"+d+"' is not unique.",DBLLog.ERROR):s[d].push(u):s[d]=r?u:[u]}return s}})(DBLCSVUtils=DBLCSVUtils||{}),(e=>{e.AUTO="auto",e.POINTER="pointer",e.TEXT="text",e.HIDDEN="none",e.DEFAULT="default",e.setCursor=function(e){DBLDragManager.isDragging||(document.body.style.cursor=e)}})(DBLCursor=DBLCursor||{}),(()=>{function e(){this._dictId="dictId"+e.DICT_ID++,this._hashes={},this._id=0}return e.prototype.putValue=function(e,t){return!!DBLUtils.isObject(e)&&(e[this._dictId]=this._id.toString(),this._hashes[this._id.toString()]=t,this._id++,!0)},e.prototype.getValue=function(e){return this._hashes[e[this._dictId]]},e.prototype.deleteValue=function(e){this.hasValue(e)&&delete this._hashes[e[this._dictId]]},e.prototype.hasValue=function(e){return null!=this._hashes[e[this._dictId]]},Object.defineProperty(e.prototype,"values",{get:function(){return this._hashes},enumerable:!1,configurable:!0}),e.DICT_ID=0,e})()),DBLDragHandler,DBLDragManager,DBLDragProxy=((l=>{var r;function c(t,n,e){r&&i(r);var o={running:!0,downTime:0,initX:engagementStage.mouseX/dblDevicePixelRatio,initY:engagementStage.mouseY/dblDevicePixelRatio};iOS||android||1==rootParams.mobile||1==rootParams.webview||(o.fxTimeout=setTimeout(function(){(o.fxTimeout=null)!=shell&&shell.showStickyDragFx()},50),o.timeout=setTimeout(function(){o.timeout=null,i(o),e(t,{initX:o.initX,initY:o.initY})},l.stickyDragTime)),o.over=engagementStage.addEventListener("stagemousemove",function(e){!o.running||u(o)||(i(o),n(t))}),o.up=engagementStage.addEventListener("stagemouseup",function(e){o.running&&i(o)}),r=o}function u(e){var t=e.initX-engagementStage.mouseX/dblDevicePixelRatio,e=e.initY-engagementStage.mouseY/dblDevicePixelRatio;return t*t+e*e<=l.stickyDeadZone*l.stickyDeadZone}function i(e){e===r&&(r=null),e.running=!1,null!=shell&&shell.removeStickyDragFx(),e.fxTimeout&&(clearTimeout(e.fxTimeout),e.fxTimeout=null),null!=e.timeout&&(clearTimeout(e.timeout),e.timeout=null),engagementStage.removeEventListener("stagemousemove",e.over),engagementStage.removeEventListener("stagemouseup",e.up)}function d(e,t){t.mousemoveListener&&(e.stage.removeEventListener("stagemousemove",t.mousemoveListener),t.mousemoveListener=null)}function p(e,t){t.pressupListener&&((t.allowDropAway?e.stage:e).removeEventListener("pressup",t.pressupListener),t.pressupListener=null)}function h(e,t){t.mousemoveStickyListener&&(e.stage.removeEventListener("stagemousemove",t.mousemoveStickyListener),t.mousemoveStickyListener=null)}function g(e,t){t&&(d(e,t),p(e,t),h(e,t),t.mouseDownListener)&&(e.removeEventListener("mousedown",t.mouseDownListener),t.mouseDownListener=null)}l.stickyDragTime=750,l.stickyDeadZone=25,l.DragHandlersDataProp="DragHandlersData",l.isDragging=!1,l.addDragDetectHelper=c,l.isMouseInDeadZone=u,l.removeDragHandlers=function(e){g(e,e[l.DragHandlersDataProp])},l.addDragHandlers=function(o,r){function i(e){"inStickyStart"==a.dragType?u(a)||(a.dragType="inNormal",h(o,a)):h(o,a)}function t(e,t){a.dragType=e,a.initX=engagementStage.mouseX/dblDevicePixelRatio,a.initY=engagementStage.mouseY/dblDevicePixelRatio;var n=r.allowDropAway?o.stage:o;a.pressupListener=n.addEventListener("pressup",s),"inStickyStart"===e&&(a.mousemoveStickyListener=o.stage.addEventListener("stagemousemove",i)),r.onMove&&(a.mousemoveListener=o.stage.addEventListener("stagemousemove",r.onMove)),r.onStart(t),l.isDragging=!0}var e,a=o[l.DragHandlersDataProp]=null!=(e=o[l.DragHandlersDataProp])?e:{},n=(g(o,a),a.dragType="none",a.initX=engagementStage.mouseX/dblDevicePixelRatio,a.initY=engagementStage.mouseY/dblDevicePixelRatio,a.allowDropAway=!0===r.allowDropAway,!1),s=function(e){"inStickyStart"===a.dragType?(a.dragType="inSticky",h(o,a),createjs.MouseCapture.set({captureMouseUp:!0,onMouseDown:function(e){return s(e)}}),n=!0):"inNormal"!==a.dragType&&"inSticky"!==a.dragType||(a.dragType="none",d(o,a),p(o,a),h(o,a),r.onStop(e),l.isDragging=!1,n&&(createjs.MouseCapture.clear(!0),n=!1))};a.mouseDownListener=o.on("mousedown",function(e){"none"!==a.dragType||DBLDragManager.isAnyDragging()||r.canDrag&&!r.canDrag(e)||c(e,function(e){t("inNormal",e)},function(e){t("inStickyStart",e)})}),a.doInterrupt=function(){l.isDragging&&(l.isDragging=!1,a.dragType="none",d(o,a),p(o,a),h(o,a),n)&&(createjs.MouseCapture.clear(!1),n=!1)}},l.interruptDragWithHandlers=function(e){null!=(e=e[l.DragHandlersDataProp])&&e.doInterrupt&&e.doInterrupt()}})(DBLDragHandler=DBLDragHandler||{}),(u=>{function i(){return DBLDragHandler.isDragging||!!u.dragProxy}function r(e){return!!e.isDragTarget}function d(e,t){for(var n=t.numChildren-1;0<=n;n--){var o=t.getChildAt(n);o.visible&&o.mouseEnabled&&(o instanceof createjs.Container&&d(e,o),r(o))&&e.push(o)}}function a(){"function"==typeof engagementStage[u.MouseMoveDragHandlerProp]&&(engagementStage.removeEventListener("stagemousemove",engagementStage[u.MouseMoveDragHandlerProp]),engagementStage[u.MouseMoveDragHandlerProp]=null)}function s(e){"function"==typeof e[u.StartDragHandlerProp]&&(e.removeEventListener("mousedown",e[u.StartDragHandlerProp]),e[u.StartDragHandlerProp]=null)}u.StartDragHandlerProp="DBLDragManagerStartDragHandler",u.MouseMoveDragHandlerProp="DBLDragManagerMouseMoveDragHandler",u.isAnyDragging=i,u.reset=function(){u.dragProxy&&(u.dragProxy.parent&&u.dragProxy.parent.removeChild(u.dragProxy),u.dragProxy=null),u.isDragging=!1},u.startDrag=function(e,t,n,o,r,i,a,s,l,c){return void 0===i&&(i=NaN),void 0===a&&(a=NaN),void 0===s&&(s=NaN),void 0===l&&(l=NaN),void 0===c&&(c=!1),u.dragProxy=new DBLDragProxy,n&&(u.dragProxy.addChild(n),n.x=0,n.y=0),u.dragProxy.dragData=t,u.dragProxy.dragInitiator=e,u.dragProxy.showMode=c,u.dragProxy.name="dragproxy",d(t=[],lessonContent),u.dragProxy.dragTargets=t,engagementStage.addChildAt(u.dragProxy,0),t=e.localToGlobal(o,r),u.dragProxy.x=t.x/dblDevicePixelRatio,u.dragProxy.y=t.y/dblDevicePixelRatio,e=n.getTransformedBounds(),isNaN(i)?(u.dragProxy.pickupX=e?e.width/2:25,u.dragProxy.pickupY=e?e.height/2:25):(u.dragProxy.pickupX=i,u.dragProxy.pickupY=a),isNaN(s)?(u.dragProxy.centerX=e?e.width/2:25,u.dragProxy.centerY=e?e.height/2:25):(u.dragProxy.centerX=s,u.dragProxy.centerY=l),c||u.dragProxy.startDrag(),DBLCursor.setCursor(DBLCursor.POINTER),u.isDragging=!0,u.dragProxy},u.isDragTarget=r,u.populateChildDragTargets=d,u.stopDrag=function(){u.dragProxy&&(a(),u.dragProxy.parent)&&(u.dragProxy.parent.removeChild(u.dragProxy),u.dragProxy=null),u.isDragging=!1,DBLCursor.setCursor(DBLCursor.AUTO)},u.addStartDragListener=function(e,t,n){void 0===n&&(n=200);var o=NaN,r=e.on("mousedown",function(e){clearTimeout(o),u.isDragging||(o=setTimeout(function(){return t(e)},n))});e.cleanupDragListener=function(){clearTimeout(o),e.removeEventListener("mousedown",r)}},u.addStartDragHandler=function(e,t){s(e),n=t.doDrag;var n,o,r=(o=t.onMove)?function(e){n(e),i()&&(engagementStage[u.MouseMoveDragHandlerProp]=engagementStage.addEventListener("stagemousemove",function(e){i()?o(e):a()}))}:n;e[u.StartDragHandlerProp]=e.on("mousedown",function(e){i()||t.canDrag&&!t.canDrag(e)||DBLDragHandler.addDragDetectHelper(e,r,function(e,t){r(e),u.dragProxy&&(u.dragProxy.stickyMouseInit=t)})})},u.removeStartDragHandler=s,u.isStartDragHandler=function(e){return"function"==typeof e[u.StartDragHandlerProp]}})(DBLDragManager=DBLDragManager||{}),(n=>{function e(e){void 0===e&&(e={});var t=n.call(this)||this;return t._inStickyDrag=!1,t.target=null,t.canceled=!1,t._targetRects=null,e.dragData&&(t.dragData=e.dragData),e.target&&(t.target=e.target),t}return __extends(e,n),e.prototype.startDrag=function(){this._inStickyDrag=!1,this._pressMoveCallback=engagementStage.addEventListener("stagemousemove",this.handlePressMove.bind(this)),this._pressUpCallback=engagementStage.addEventListener("stagemouseup",this.handlePressUp.bind(this))},e.prototype.fakePressMove=function(){this.onMoveActual()},e.prototype.fakePressUp=function(){this.handlePressUp(null)},e.prototype.setDragBoundary=function(e,t){var n=t.localToLocal(e.x,e.y,engagementStage),t=t.localToLocal(e.x+e.width,e.y+e.height,engagementStage);this._dragBounds=new createjs.Rectangle(n.x,n.y,t.x,t.y)},e.prototype.handlePressMove=function(e){var t=e.stageX/dblDevicePixelRatio-this.pickupX,e=e.stageY/dblDevicePixelRatio-this.pickupY;this.x=this._dragBounds?Math.max(Math.min(t,this._dragBounds.width),this._dragBounds.x):t,this.y=this._dragBounds?Math.max(Math.min(e,this._dragBounds.height),this._dragBounds.y):e,this.onMoveActual(),this.stickyMouseInit&&!DBLDragHandler.isMouseInDeadZone(this.stickyMouseInit)&&(this.stickyMouseInit=null)},e.prototype.cleanupEvents=function(){this._pressMoveCallback&&engagementStage.removeEventListener("stagemousemove",this._pressMoveCallback),this._pressMoveCallback=void 0,this._pressUpCallback&&engagementStage.removeEventListener("stagemouseup",this._pressUpCallback),this._pressUpCallback=void 0},e.prototype.handlePressUp=function(e){var t=this;this.stickyMouseInit&&(this.handlePressMove(e),!this._inStickyDrag)&&DBLDragHandler.isMouseInDeadZone(this.stickyMouseInit)?(this._inStickyDrag=!0,createjs.MouseCapture.set({captureMouseUp:!0,onMouseDown:function(e){t.handlePressUp(e),createjs.MouseCapture.clear(!0)}})):(this.cleanupEvents(),this.target?this.target.dragDrop(this):(this.canceled=!0,this.dragInitiator.dragCanceled()))},e.prototype.endDrag=function(){this.dragInitiator.dragComplete(),DBLDragManager.stopDrag(),this.cleanupEvents()},e.prototype.cancelDrag=function(){this.canceled=!0,this.dragInitiator.dragCanceled(),this.cleanupEvents()},e.prototype.forceInitialMove=function(){this.onMoveActual()},e.prototype.getStageBounds=function(e){var t,n=e.getBounds();return null==n?new createjs.Rectangle(0,0,0,0):(t=e.localToGlobal(n.x,n.y),e=e.localToGlobal(n.x+n.width,n.y+n.height),new createjs.Rectangle(t.x,t.y,e.x-t.x,e.y-t.y))},e.prototype.onMoveActual=function(){var e,t=[];if(null==this._targetRects)for(this._targetRects=new Array(this.dragTargets.length),r=0;r<this.dragTargets.length;r++)e=this.dragTargets[r],this._targetRects[r]=this.getStageBounds(e);for(var n,o=this.getStageBounds(this),r=0;r<this.dragTargets.length;r++)o.x<=this._targetRects[r].x+this._targetRects[r].width&&o.x+o.width>=this._targetRects[r].x&&o.y<=this._targetRects[r].y+this._targetRects[r].height&&o.y+o.height>=this._targetRects[r].y&&(e=this.dragTargets[r]).acceptDragDrop(this)&&(n=this._targetRects[r].intersection(o))&&t.push({component:e,rectangle:n});var i=null;if(0==t.length)i=null;else if(1==t.length)i=t[0].component;else{for(var a=0,s=-1,l=0;l<t.length;l++){var c=t[l].rectangle.width*t[l].rectangle.height;(-1==s||a<c)&&(a=c,s=l)}i=t[s].component}i?i==this.target?this.target.dragOver(this):(this.target&&(this.target.dragExit(this),this.target=null),this.target=i,this.target.dragEnter(this)):this.target&&(this.target.dragExit(this),this.target=null)},e.TAP_OFFSET=20,e.OFF_STAGE=1e7,e})(createjs.Container)),DBLEngagementManager,DBLError,DBLFont,DBLFileLoader=((e=>{var i,a,s,l,c;function o(e,t){serverURL?u("public/v1/users/USERID/lessonFeedback","POST",e,t):setTimeout(t,100)}function u(e,t,n,o,r){void 0===n&&(n={}),void 0===o&&(o=function(e){}),void 0===r&&(r=function(e){}),e=serverURL+e.replace("USERID",__studentId);var i=new XMLHttpRequest;i.open(t,e,!0),i.setRequestHeader("Content-type","application/json"),i.setRequestHeader("DBL-AuthSessionUuid",authSession),i.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),clientInstance&&i.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),i.onreadystatechange=function(){if(i.readyState==XMLHttpRequest.DONE)if(300<=i.status)r(i.status),DBLLog.log("Unable to reach ".concat(e),DBLLog.ERROR,i.status);else try{var t=i.response&&JSON.parse(i.response);o(t)}catch(e){r("Unable to parse json data.");t=DBLError.fatalCodeFromRawResponse(i.response);DBLLog.log("Unable to parse data.",DBLLog.ERROR,t)}},i.onerror=function(){r(i.status),DBLLog.log("Unable to reach ".concat(e),DBLLog.ERROR,i.status)},"GET"==t?i.send():i.send(JSON.stringify(n))}function d(e,o,t,n){var r=serverURL+o.replace("USERID",__studentId);"GET"==e&&IE&&(r+="?time="+(new Date).getTime()),i?DBLLog.log("Concurrent Engagement Manager api detected calling "+o,DBLLog.FATAL,DBLError.INVALID_CLIENT_STATE):(s=e,a=n,l=o,c=t,(i=new XMLHttpRequest).open(e,r,!0),i.setRequestHeader("Content-type","application/json"),i.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&i.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),i.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),i.onreadystatechange=function(){try{if(4==i.readyState)if(200==i.status){var t=i.response,e=void 0,n=void 0;try{e=JSON.parse(t)}catch(e){n=DBLError.fatalCodeFromRawResponse(t),DBLLog.log(o+" - unable to parse data.",DBLLog.FATAL,n)}n||h(e)}else 204==i.status?h(null):0!=i.status&&p()}catch(e){throw dblRecordError(e),e}},i.onerror=function(){p()},"GET"==e?i.send():i.send(JSON.stringify(t)),a=n)}function p(){var e=DBLError.TROUBLE_COMMUNICATING;if(400<=i.status&&i.status<=499)try{var t=JSON.parse(i.response);t&&t.errorCode&&(e=t.errorCode)}catch(e){}e==DBLError.TROUBLE_COMMUNICATING&&++__retryServerRequestCount<=(__retryServerRequests?3:0)?setTimeout(function(){DBLLog.log(l+" load failure - retry "+__retryServerRequestCount,DBLLog.INFO),i=null,d(s,l,c,a)},1e3*__retryServerRequestCount*__retryServerRequestCount):DBLLog.log(l+" was unreachable: "+i.status,DBLLog.FATAL,e)}function h(e){__retryServerRequestCount=0;var t=a;a=c=l=i=null,t&&t(e)}e.getInventory=function(t,n){var e=!!rootParams.lesson;if(!serverURL||e)setTimeout(function(){var e={tokens:1,avatars:{3001:1}};__user._data_&&(e.coins=__user._data_),DBLLog.log("getInventory("+JSON.stringify(t)+") -> "+JSON.stringify(e),DBLLog.INFO),n(e)},500);else{for(var o="",r=0;r<t.length;r++)o+="&type="+t[r];d("GET","public/v1/users/USERID/inventory",o.substr(1),function(e){e.badges&&(delete e.badges[1009],delete e.badges[1010],delete e.badges[1011]),DBLLog.log("getInventory("+JSON.stringify(t)+") -> "+JSON.stringify(e),DBLLog.INFO),n(e)})}},e.engagementEvent=function(e,t,n){if(serverURL){var o,r={engagementEventType:e,parameters:{}};for(o in t)r.parameters[o]=t[o];d("POST","public/v1/users/USERID/engagementEvent",r,function(){DBLLog.log("engagementEvent("+e+","+JSON.stringify(t)+")",DBLLog.INFO),n()})}else setTimeout(function(){DBLLog.log("engagementEvent("+e+")",DBLLog.INFO),n()},100)},e.sendLessonFeedback=function(e,t){o(__assign(__assign({},e),{userId:parseInt(__studentId),lessonId:e.lessonId||__lessonid,lessonInstanceUuid:__lessonuuid}),function(){DBLLog.log("sendLessonFeedback(".concat(JSON.stringify(e),")"),DBLLog.INFO),"function"==typeof t&&t()})},e.sendScreenerFeedback=function(e,t){var n=DBLLessonManager.getLastLessonInfo();o(__assign(__assign({},e),{userId:parseInt(__studentId),lessonId:null==n?void 0:n.lessonid,lessonInstanceUuid:null==n?void 0:n.lessonuuid}),function(){DBLLog.log("sendScreenerFeedback(".concat(JSON.stringify(e),")"),DBLLog.INFO),"function"==typeof t&&t()})},e.retrieveStudentAchievements=function(e){var t,o,r,i;return serverURL?(t="coolfrost"==engagement||"neon"==engagement?8:6,o="public/v1/users/USERID/achievements",r="POST",void 0===(i={recommendationCount:t})&&(i={}),new Promise(function(t,n){u(o,r,i,function(e){return t(e)},function(e){return n(e)})})):Promise.resolve(e)},e.doTransaction=function(t,n){serverURL?(__apiSequence++,d("POST","public/v1/users/USERID/transaction",{item:t,sequence:__apiSequence},function(e){DBLLog.log("doTransaction("+t+") -> approved: "+e.approved+", spent: "+e.spent+", newTotal: "+e.newTotal,DBLLog.INFO),n(e.spent,e.newTotal)})):setTimeout(function(){var e="primary"==engagement||"squiggly"==engagement?1:100;DBLLog.log("doTransaction("+t+") -> "+e,DBLLog.INFO),n(e,0)},100)},e.getTutorialInfo=function(t){serverURL?d("GET","public/v1/users/USERID/tutorialInfo",null,function(e){DBLLog.log("getTutorialInfo() -> "+JSON.stringify(e.tutorials),DBLLog.INFO),t(e.tutorials)}):setTimeout(function(){var e=[{lessonName:"Mathrack2WireExplorationTutorial",lessonId:127,enabled:!0}];DBLLog.log("getTutorialInfo() -> "+JSON.stringify(e),DBLLog.INFO),t(e)},100)},e.getPracticeAreas=function(t){serverURL?d("GET","public/v1/users/USERID/practiceAreas",null,function(e){DBLLog.log("getPracticeAreas() -> "+JSON.stringify(e.practiceAreas),DBLLog.INFO),t(e.practiceAreas)}):setTimeout(function(){var e=["P01A","P02A"];DBLLog.log("getPracticeAreas() -> "+JSON.stringify(e),DBLLog.INFO),t(e)},100)}})(DBLEngagementManager=DBLEngagementManager||{}),(l=>{l.UNHANDLED_ERROR=3e4,l.TROUBLE_COMMUNICATING=30001,l.NEED_NET_ACCESS=30002,l.ENGAGEMENT_LOAD_FAILURE=30003,l.TOOL_MANIFEST_LOAD_FAILURE=30004,l.UNKNOWN_TOOL=30005,l.TOOL_LOAD_FAILURE=30006,l.NON_LRT_LESSON=30007,l.GAME_LOAD_FAILURE=30008,l.LESSON_LOAD_FAILURE=30009,l.LESSON_CORRUPT=30010,l.RESPONSE_NOT_VALID_JSON=30011,l.RDOS=30012,l.STATE_MANAGER_SYNC_FAILURE=30013,l.UNIT_LOAD_FAILURE=30014,l.UNIT_CORRUPT=30015,l.TOO_MANY_LOAD_FAILURES=30016,l.UNKNOWN_ERROR=30017,l.FIREWALL=30018,l.BAD_SESSION=30019,l.LOCALIZATION_LOAD_FAILURE=30020,l.AUDIO_MODULE_LOAD_FAILURE=30021,l.NANOGAME_LOAD_FAILURE=30022,l.UNSUPPORTED_ENGAGEMENT=30023,l.JAVASCRIPT_ERROR=30024,l.UNSUPPORTED_LRT=30025,l.SEQUENCING_FAILURE=30026,l.INVALID_CLIENT_STATE=30027,l.STATE_DATA_CORRUPT=30028,l.TRANSCRIPT_CORRUPT=30029,l.LOGGED_IN_SAME_USER_OTHER_TAB=32011,l.LOGGED_IN_DIFFERENT_USER_OTHER_TAB=32012,l.LRT_FIELD="lrt",l.ENGAGEMENT_FIELD="engagement",l.LCID_FIELD="lcid",l.AUTOMATION_FIELD="automationData",l.LOGTAIL_FIELD="logTail",l.ERR_CS_FIELD="callStack",l.DEVICE_FIELD="device",l.MEMORY_FIELD="memory";var r,c,i={1:"Oops! DreamBox needs to exit. Please log in again.",2:"Oops! We are having trouble communicating with DreamBox.",3:"Oops! You need an Internet connection to play DreamBox Math.",4:"Oops! Something is preventing us from reaching DreamBox!",5:"Oops! We need to log you out. You can only be logged in on one device at a time.",6:"Oops! We need to log you out."},a={3e4:1,30001:2,30002:3,30003:2,30004:2,30005:1,30006:2,30007:1,30008:2,30009:2,30010:1,30011:1,30012:2,30013:2,30014:2,30015:2,30016:2,30017:1,30018:4,30019:6,30020:2,30021:2,30022:2,30023:1,30024:1,30025:1,30026:1,30027:1,30028:2,30029:2,32001:1,32002:1,32003:5,32004:5,32005:5,32006:1,32007:1,32008:6,32009:6,32010:6,32011:5,32012:5},s=["McAfee","Norton","security","Security","Privacy","privacy","Blocked","blocked","Web Page Blocked","Web page has been blocked","parental control software","Bad Request","inappropriate","banned","Your browser sent a request that this server could not understand","!DOCTYPE HTML PUBLIC"],u="public/v1/users/USERID/clientError",d=[],p=[],h=[];function t(e,t,n){var o;shell&&__shellSetup&&t==DBLLog.FATAL?r?d.push([e,t,n]):(t==DBLLog.FATAL&&(o=__fatalErrorReached,e=o=null==(o=i[a[o]])?i[1]:o),r=!0,shell.showErrorPopup(e,t,n,g)):(t>=alertLevel&&debug&&alert(e),__fatalErrorReached&&immediateExit())}function g(){var e;r=!1,__fatalErrorReached?immediateExit():0<d.length&&t((e=d.pop())[0],e[1],e[2])}function f(e,t,n){if(__studentId){for(var o=!1,r=0,i=h;r<i.length;r++){var a=i[r];if(a.message==e){if(o=!0,a.count++,e="(MULTIPLE) "+e,3<=a.count&&!((t=DBLLog.WARN)>=serverReportLevel))return;break}}o||h.push({message:e,count:1}),c&&p.push([e,t,n]),c=!0;var n=serverURL+u.replace("USERID",__studentId),s=new XMLHttpRequest,n=(s.open("POST",n,!0),s.setRequestHeader("Content-type","application/json"),s.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&s.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),s.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),m());n.staticVersion=_(),appVersion&&(n.appVersion=appVersion),lessonfqn&&(n.lessonFQN=lessonfqn),__lessonid&&(n.lessonId=__lessonid),screenfqn&&(n.screenFQN=screenfqn);n=JSON.stringify({message:e,diagnostics:n});s.onreadystatechange=function(){if(4==s.readyState)if(200==s.status||204==s.status)c=!1,0<p.length&&f((e=p.pop())[0],e[1],e[2]);else{var e=l.TROUBLE_COMMUNICATING;if(400<=s.status&&s.status<=499)try{var t=JSON.parse(s.response);t&&t.errorCode&&(e=t.errorCode)}catch(e){}DBLLog.log("Server responded to error with code "+e+" won't report an error on an error.",DBLLog.INFO)}},s.send(n)}else DBLLog.log("Unable to log error with server in 2.0 because there is no logged-in user.",DBLLog.INFO)}function _(){var e="release",t=rootURL.split("/"),t=2<t.length?t[t.length-2]:null;return e=t&&"ld_"==t.substr(0,3)&&4==(t=t.split("_")).length?t[1]+"."+t[2]+"."+t[3]:e}function m(){for(var e,t=new Object,n=(t[l.LRT_FIELD]="4",t[l.ENGAGEMENT_FIELD]=engagement,t[l.LCID_FIELD]=lcid,e=rootParams.device||(DBLCapabilities.hasMouse()?"desktop":"mobile"),2==dblDevicePixelRatio?e+=" retina":2<=window.devicePixelRatio&&(e+=" retina-capable")," "==(e=(e=(e+=" "+window.screen.width+"x"+window.screen.height)+(" "+(()=>{var e="";try{var t=createjs.Sound.activePlugin;e+="audio state="+t.context.state,deviceMuted&&(e+=" device muted")}catch(e){}return e})()))+(" "+(__keyPadController?__keyPadController.getKeyStats()+" "+DBLTextInputFocusManager.getKeyStats():"(null __keyPadController)"))).substr(0,1)&&(e=e.substr(1)),t[l.DEVICE_FIELD]=e,window.performance&&window.performance.memory&&(e=window.performance.memory,t[l.MEMORY_FIELD]=Math.round(e.usedJSHeapSize/1048576)+"mb (max "+Math.round(e.jsHeapSizeLimit/1048576)+"mb)"),""),o=0,r=__actualLog;o<r.length;o++)n+=r[o]+"\n";t[l.AUTOMATION_FIELD]=n;for(var i="",a=0,s=__logTail;a<s.length;a++)i+=s[a]+"\n";return t[l.LOGTAIL_FIELD]=i,t[l.ERR_CS_FIELD]=__stackTrace,t}l.init=function(){r=!(d=[]),c=!(p=[]),h=[]},l.isLoadError=function(e){return 2==a[e]},l.showErrorAlert=t,l.reportErrorToServer=f,l.getStaticVersion=_,l.sendFeedback=function(e,t,n,o){if(serverURL){var r=serverURL+"public/v1/users/USERID/userFeedback".replace("USERID",__studentId),i=new XMLHttpRequest,r=(i.open("POST",r,!0),i.setRequestHeader("Content-type","application/json"),i.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&i.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),i.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),null);try{r=n.toDataURL("image/jpeg")}catch(e){}r&&"data:image/jpeg;base64,"==r.substr(0,23)&&(r=r.substr(23));n=m();n.staticVersion=_(),appVersion&&(n.appVersion=appVersion),lessonfqn&&(n.lessonFQN=lessonfqn),__lessonid&&(n.lessonId=__lessonid),screenfqn&&(n.screenFQN=screenfqn);e=JSON.stringify({subject:e,text:t,snapshot:r,diagnostics:n});i.onreadystatechange=function(){if(4==i.readyState){if(200!=i.status&&204!=i.status){var e=l.TROUBLE_COMMUNICATING;if(400<=i.status&&i.status<=499)try{var t=JSON.parse(i.response);t&&t.errorCode&&(e=t.errorCode)}catch(e){}DBLLog.log("Server returned from feedback with code "+e,DBLLog.ERROR)}o()}},i.send(e)}else DBLLog.log("Would send feedback now if we had a server",DBLLog.INFO),o()},l.fatalCodeFromRawResponse=function(e){var t=l.RESPONSE_NOT_VALID_JSON;try{for(var n=0,o=s;n<o.length;n++){var r=o[n];if(-1!=e.indexOf(r)){t=l.FIREWALL;break}}!t&&0<=e.indexOf("<b>PREVENT</b>")?t=l.RDOS:(0<=e.indexOf("BAD SESSION")||0<=e.indexOf("no valid user session"))&&(t=l.BAD_SESSION)}catch(e){}return t}})(DBLError=DBLError||{}),(p=>{p.THIN=100,p.EXTRA_LIGHT=200,p.LIGHT=300,p.NORMAL=400,p.MEDIUM=500,p.SEMI_BOLD=600,p.BOLD=700,p.EXTRA_BOLD=800,p.BLACK=900,p.ITALIC="italic",p.LEFT="left",p.CENTER="center",p.RIGHT="right",p.STYLES=["normal","bold",p.ITALIC,"italic bold"];var i=", Arial, sans-serif",a=(p.SUPPORTED_FONTS={MuliNormal:{name:"DBLMuli",style:"normal",weight:p.NORMAL},MuliBold:{name:"DBLMuli",style:"normal",weight:p.BOLD},MuliExraBold:{name:"DBLMuli",style:"normal",weight:p.EXTRA_BOLD},MuliBlack:{name:"DBLMuli",style:"normal",weight:p.BLACK},PTSerifItalic:{name:"PTSerif",style:"normal",weight:p.NORMAL},PTSerifBoldItalic:{name:"PTSerif",style:"normal",weight:p.BOLD},AndikaNormal:{name:"DBLAndika",style:"normal",weight:p.NORMAL},AndikaBold:{name:"DBLAndika",style:"normal",weight:p.BOLD},AndikaBlack:{name:"DBLAndika",style:"normal",weight:p.BLACK},MontrealSerial:{name:"MontrealSerial",style:"normal",weight:p.NORMAL},MontrealSerialBold:{name:"MontrealSerial",style:"normal",weight:p.BOLD},CooperBlack:{name:"CooperBlack",style:"normal",weight:p.NORMAL}},p.FONT_MAP={DBLMuli:p.SUPPORTED_FONTS.MuliNormal,"DBLMuli:bold":p.SUPPORTED_FONTS.MuliBold,"DBLMuli:italic bold":p.SUPPORTED_FONTS.MuliBold,"Muli Black DBL":p.SUPPORTED_FONTS.MuliBlack,"Muli Black":p.SUPPORTED_FONTS.MuliBlack,"Muli-Black":p.SUPPORTED_FONTS.MuliBlack,"Muli-Black_DBL":p.SUPPORTED_FONTS.MuliBlack,"PT Serif:normal":p.SUPPORTED_FONTS.PTSerifItalic,"PT Serif:italic":p.SUPPORTED_FONTS.PTSerifItalic,"PT Serif:bold":p.SUPPORTED_FONTS.PTSerifBoldItalic,"PT Serif:italic bold":p.SUPPORTED_FONTS.PTSerifBoldItalic,"Andika New Basic:normal":p.SUPPORTED_FONTS.AndikaNormal,"Andika New Basic:italic":p.SUPPORTED_FONTS.AndikaNormal,"Andika New Basic:bold":p.SUPPORTED_FONTS.AndikaBold,"DBLAndika:italic":p.SUPPORTED_FONTS.AndikaNormal,"Montreal Serial":p.SUPPORTED_FONTS.MontrealSerial,"Montreal Serial:bold":p.SUPPORTED_FONTS.MontrealSerialBold,"Montreal Serial Xbold":p.SUPPORTED_FONTS.MontrealSerialBold,"Cooper Black":p.SUPPORTED_FONTS.CooperBlack},{Anivers:.765,Arial:.65,DBLAndika:.76,DBLMuli:.63,PTSerif:.76}),d=(p.SQUIGGLY_TYPESCALE={H1:{weight:p.NORMAL,size:96},H2:{weight:p.NORMAL,size:64},H3:{weight:p.NORMAL,size:44},H4:{weight:p.NORMAL,size:34},H5:{weight:p.BOLD,size:24},Body:{weight:p.NORMAL,size:20},Button1:{weight:p.NORMAL,size:44},Button2:{weight:p.NORMAL,size:36},Button3:{weight:p.BOLD,size:20}},"dblFontIsFixed"),h="yWithTopBaseline",g="yWithAlphaBaseline",s="vertCenterDX",l="vertCenterDY";function f(e,t,n,o){o=void 0===o?"":o;return""!=o&&(o+=" "),o=(o+=(n=void 0===n?p.NORMAL:n).toString())+(" "+t+"px "+(e=>{var t=__webFonts?e:"impossiblefont";return"CooperBlack"==e&&(t+=", 'Arial Black'"),t+=i})(e))}function n(e){var t=0;switch(e){case"Anivers":t=1.36;break;case"Arial":case"Arimo":t=1.38;break;case"CooperBlack":case"Corbel":t=1.5;break;case"DejaVuSans":t=1.34;break;case"MontrealSerial":t=1.3;break;case"MyriadPro":t=1.44;break;case"Verdana":t=1.26}return t}function _(e){for(var t in a){var n=e.font.indexOf(t),o=e.font.indexOf(i),r=o+i.length-1;if(0<=n&&(-1==o||n<o||r<n))return a[t]*e.getMeasuredHeight()}return e.getMeasuredLineHeight()}function r(e,t,n,o){void 0===n&&(n=""),void 0===o&&(o=p.NORMAL);for(var r=e.font,i=r?r.split(" "):[],a=0;a<i.length;a++)if(""==n&&-1!=i[a].search("px")){n=i[a];break}e.font=f(t,DBLUtils.toInt(n.replace("px","")),o)}function m(e){var t,n,o,r=e.indexOf(","),i=(0<=r&&(e=e.substr(0,r).trim()),"normal"),a=p.NORMAL,r=e,s=e.indexOf("'");0<=s&&(n=e.lastIndexOf("'"),o=e.substr(s+1,n-s-1),r=0<s?e.substr(0,s):"",n<e.length-1)&&(r+=e.substr(n+1));for(var l=0,c=r.split(" ");l<c.length;l++){var u,d=c[l];0!=d.length&&(u=d.toLowerCase(),0<=p.STYLES.indexOf(u)?i=u:"px"==d.substr(-2)||"pt"==d.substr(-2)?t=DBLUtils.toInt(d.substr(0,d.length-2)):isNaN(parseInt(d))?o?o+=" "+d:o=d:a=parseInt(d))}return{name:o,style:i,size:t,weight:a}}function y(e,t,n){if(!t||"normal"==t)for(var o=0,r=__loadedFonts;o<r.length;o++){var i=r[o],a=i[0];if(n==i[1]&&0<=a.indexOf(e))return!0}return!1}p.getFontString=f,p.getFontEmString=function(e){var t="normal",e=n(e);return t=0<e?e.toString()+"em":t},p.getFontEm=n,p.getLineHeight=_,p.fixFont=r,p.fixFontAndPosition=function(e,t,n,o){void 0===n&&(n=""),void 0===o&&(o=p.NORMAL),e&&(r(e,t,n,o),e.textBaseline="alphabetic",t=(t=e.originY)||(e.originY=e.y),e.y=t+e.getMeasuredLineHeight())},p.fixTextFields=function e(t,n){if(void 0===n&&(n=!1),t instanceof createjs.Text&&!t[d]){t[d]=!0;var o=t.font,r=m(o),i=r.name,a=i+":"+r.style,s=p.FONT_MAP.hasOwnProperty(i),l=p.FONT_MAP.hasOwnProperty(a);(s||l)&&(l=f((s=p.FONT_MAP[l?a:i]).name,s.size||r.size,s.weight||r.weight,s.style||r.style))!=o&&(t.font=l,i=s.name,r=m(l)),y(i,r.style,r.weight),n&&(t.text=translate(t.text)),"top"==t.textBaseline?(t.textBaseline="alphabetic",t[h]=t.y,t.y+=_(t),t[g]=t.y):t.textBaseline}else if(t instanceof createjs.Container)for(var c=0,u=t.children;c<u.length;c++)e(u[c],n)},p.refixTextFields=function e(t){var n;if(t instanceof createjs.Text&&t[d])t.y!=t[g]&&(n=t[g]-t[h],t.y+=n);else if(t instanceof createjs.Container)for(var o=0,r=t.children;o<r.length;o++)e(r[o])},p.getOriginalTopBaselineY=function(e){return e.hasOwnProperty(h)?e[h]:e.y},p.centerVertically=function(e){var t=e.getMeasuredHeight(),n=(n=e.lineHeight)<t?.5*(n-t):0,t=e[l]||0,o=0,r=0;-90==e.rotation?o=n:r=n,e.x+=o-(e[s]||0),e.y+=r-t,e[s]=o,e[l]=r},p.parseFontDescriptor=m,p.isFontLoaded=y,p.getFontSize=function(e){for(var t=e.font.split(" "),n=0;n<t.length;n++)if(-1!=t[n].search("px"))return parseInt(t[n].split("px")[0]);return null},p.fixFonts=function(e,t,n,o){return r(e,t,n=void 0===n?"":n,o=void 0===o?p.NORMAL:o)},p.resizeFont=function(e,t){for(var n=0,o=0,r=0,i=e.font.split(" ");r<i.length;r++){var a=i[r],o=n+a.length;if(-1!=a.indexOf("px"))break;n=o+1}var s="".concat(e.font.substring(0,n)).concat(t,"px").concat(e.font.substring(o));e.font=s,e.lineHeight=t}})(DBLFont=DBLFont||{}),(()=>{function e(t){void 0===t&&(t={stopOnError:!0,errorLogLevel:DBLLog.FATAL,onErrorCallback:null}),this._loader=new createjs.LoadQueue,this._loader.stopOnError=t.stopOnError,this._loader.on("error",function(e){onStaticLoadFailed(e,t.errorLogLevel),null!=(e=t.onErrorCallback)&&e.call(t)}),this._loader.on("fileload",function(e){resetStaticLoadCount(),onPotentialAnimateFileLoad(e)})}return e.prototype.addFile=function(e,t,n){t=fileFromFQN(e,t),DBLLog.log("Loading "+t,DBLLog.INFO),t={src:t,id:e,crossOrigin:!0,loadTimeout:DEFAULT_LOAD_TIMEOUT};n&&(t.type=n),this._loader.loadFile(t,!1)},e.prototype.load=function(e){var t=this;this._loader.on("complete",function(){t._loader.removeAllEventListeners("complete"),null!=e&&e()}),this._loader.load()},e.prototype.getJson=function(e){e=this._loader.getResult(e);return"string"==typeof e?JSON.parse(DBLJSONUtils.stripJsonComments(e)):e},e.prototype.getImage=function(e){return this._loader.getResult(e)},e.prototype.getCSV=function(e){e=this._loader.getResult(e);return"string"==typeof e?DBLCSVUtils.csvToJson(e):e},e})()),DBLKeyPadSupportedChars,DBLLessonManager,recommendations_mock,DBLLoadingSpinner=((e=>{e.DIGITS="1234567890",e.LETTERS="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",e.SPACE=" ",e.FIRST_ROW_OPERATORS="+-",e.OTHER="/*.:,<>?;'\"[]{}\\|`~!@#$%^&()_=",e.ALL=e.DIGITS+e.LETTERS+e.SPACE+e.FIRST_ROW_OPERATORS+e.OTHER})(DBLKeyPadSupportedChars=DBLKeyPadSupportedChars||{}),(e=>{var i,a,s,l,c,v,L,b,D,S,A,E,B,u,r="public/v1/users/USERID/recommendationsAttributesSummary",d="public/v1/users/USERID/recommendations",p="public/v1/users/USERID/lessonStart",h="public/v1/users/USERID/lessonEnd",g="public/v1/users/USERID/lessonAutoSave",f=!1,_=0,m=6,y="QUEST",x="Session.lastLessonInfo";function T(e){var t,n,o;serverURL?(t=void 0,v=new XMLHttpRequest,t=serverURL+r.replace("USERID",__studentId),L=r,n=JSON.stringify({recommendCount:m,includeLessonIds:[],lessonAttributeTypes:[y]}),v.open("POST",t,!0),v.timeout=DEFAULT_LOAD_TIMEOUT,v.setRequestHeader("Content-type","application/json"),v.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&v.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),v.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),v.onreadystatechange=function(){try{if(4==v.readyState)if(200==v.status){var t,n=v.response,e=void 0;try{e=JSON.parse(n)}catch(e){t=DBLError.fatalCodeFromRawResponse(n),DBLLog.log(L+" - unable to parse data.",DBLLog.FATAL,t)}var o={},r=(e&&e.summary&&e.summary[y]?o=e.summary[y]:DBLLog.log("no QUESTs available from recommendationsAttributesSummary",DBLLog.ERROR),__retryServerRequestCount=0,i);i=null,r(o)}else 0!=v.status&&C()}catch(e){throw dblRecordError(e),e}},v.onerror=function(){var e=DBLError.TROUBLE_COMMUNICATING;if(400<=v.status&&v.status<=499)try{var t=JSON.parse(v.response);t&&t.errorCode&&(e=t.errorCode)}catch(e){}e==DBLError.TROUBLE_COMMUNICATING&&++__retryServerRequestCount<=(__retryServerRequests?3:0)?setTimeout(function(){DBLLog.log(L+" load failure - retry "+__retryServerRequestCount,DBLLog.INFO),T(i)},1e3*__retryServerRequestCount*__retryServerRequestCount):DBLLog.log(L+" was unreachable: "+v.status,DBLLog.FATAL,e)},v.send(n),i=e):(i=e,o={M:2,A:1,S:1,T:1},setTimeout(function(){var e=i;i=null,e(o)},100))}function n(e,t,n,o){var r,i;serverURL?(r=void 0,v=new XMLHttpRequest,r=serverURL+d.replace("USERID",__studentId),L=d,i={statusOnLessonIds:e,recommendCount:t},n&&(i.matchAttributeType=y,i.matchAttributeValues=[n]),i=JSON.stringify(i),v.open("POST",r,!0),v.timeout=DEFAULT_LOAD_TIMEOUT,v.setRequestHeader("Content-type","application/json"),v.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&v.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),v.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),v.onreadystatechange=function(){var e,t;try{if(4==v.readyState)if(200==v.status){var n,o,r=v.response;try{n=JSON.parse(r),e=O(n)}catch(e){o=DBLError.fatalCodeFromRawResponse(r),DBLLog.log(L+" - unable to parse data.",DBLLog.FATAL,o)}}else 0!=v.status&&C()}catch(e){throw dblRecordError(e),e}e&&(t=a,a=null,DBLActivityMonitor.pingServerOnMajorLessonEvents(function(){t(e)}))},v.onerror=function(){C()},v.send(i),a=o,s=e,l=t,c=n):(a=o,s=e,l=t,c=n,recommendations_mock.getRecommendations(e,function(e){var e=O(e),t=a;a=null,t(e)}))}function C(){var e=DBLError.TROUBLE_COMMUNICATING;if(400<=v.status&&v.status<=499)try{var t=JSON.parse(v.response);t&&t.errorCode&&(e=t.errorCode)}catch(e){}e==DBLError.TROUBLE_COMMUNICATING&&++__retryServerRequestCount<=(__retryServerRequests?3:0)?setTimeout(function(){DBLLog.log(L+" load failure - retry "+__retryServerRequestCount,DBLLog.INFO),n(s,l,c,a)},1e3*__retryServerRequestCount*__retryServerRequestCount):DBLLog.log(L+" was unreachable: "+v.status,DBLLog.FATAL,e)}function O(e){for(var t,n,o,r="squiggly"==engagement||"bookworm"==engagement,i=window.assets_translations_engagement_intermediate_FriendlyNames,a=0;a<e.playRecommendations.length;a++)r||(t=i?i[e.playRecommendations[a].lessonName]:null)&&(e.playRecommendations[a].name="spanish"==language?t.spanish:t.english),__gatesPreviewEnabled&&((n=(t=window.assets_translations_engagement_intermediate_LessonDescriptions)?t[e.playRecommendations[a].lessonId]:null)&&(e.playRecommendations[a].description=(null==(o=n.find(function(e){return e.language===language}))?void 0:o.lesson_description)||(null==(o=n.find(function(e){return"english"===e.language}))?void 0:o.lesson_description)),n=window.assets_translations_shared_LessonDomains)&&e.playRecommendations[a].academicDomainId&&(o=n["academic-domains-".concat(e.playRecommendations[a].academicDomainId)])&&(e.playRecommendations[a].domain="spanish"==language?o.spanish:o.english),e.playRecommendations[a].type=0,e.playRecommendations[a].thumbnail="assets.media.thumbnails.".concat(e.playRecommendations[a].lessonId);return processAssessmentType(e),__retryServerRequestCount=0,l=0,c=s=null,e.playRecommendations}function o(e,t){var n,o,r;serverURL&&!e.lessonFQN?(n=void(v=new XMLHttpRequest),o=serverURL+p.replace("USERID",__studentId),L=p,n='{"lessonId":'+e.lessonId+',"sequence":'+__apiSequence+',"assignmentId":'+(e.assignmentId||null)+(e.recommendationUuid?',"recommendationUuid":"'+e.recommendationUuid+'"':"")+"}",v.open("POST",o,!0),v.timeout=DEFAULT_LOAD_TIMEOUT,v.setRequestHeader("Content-type","application/json"),v.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&v.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),v.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),v.onreadystatechange=function(){try{4==v.readyState&&(200==v.status?I({lessonname:e.name,assignmentType:e.assignmentType,lessonId:e.lessonId,fqln:e.fqln,assignmentId:e.assignmentId,recommendationUuid:e.recommendationUuid,seedOverride:null}):0!=v.status&&R())}catch(e){throw dblRecordError(e),e}},v.onerror=function(){try{R()}catch(e){throw dblRecordError(e),e}},b=t,v.send(n)):(r=e.lessonFQN||("squiggly"==engagement||"bookworm"==engagement?"lessons.literacy.blends.FinalBlends_FT_LT_NT_02.json":"lessons.math.addingandsubtracting.MatchingMake10_LevelOne"),setTimeout(function(){t(null,null,null,null,null,null,null,null,null,r,null,null)},rootParams.slowserver?3e3:100))}function R(){var e=DBLError.TROUBLE_COMMUNICATING;if(400<=v.status&&v.status<=499)try{var t=JSON.parse(v.response);t&&t.errorCode&&(e=t.errorCode)}catch(e){}e==DBLError.TROUBLE_COMMUNICATING&&++__retryServerRequestCount<=(__retryServerRequests?3:0)?setTimeout(function(){DBLLog.log(L+" load failure - retry "+__retryServerRequestCount,DBLLog.INFO),b?o(S,b):D&&P(A,E,B,D)},1e3*__retryServerRequestCount*__retryServerRequestCount):DBLLog.log(L+" was unreachable: "+v.status,DBLLog.FATAL,e)}function I(e){void 0===e&&(e=null),__retryServerRequestCount=0,B=E=A=S=null;var t,n,o,r,i,a,s,l,c,u,d,p,h,g,f,_,m,y=v.response;try{t=JSON.parse(y)}catch(e){n=DBLError.fatalCodeFromRawResponse(y)}t?(b?(o="",r=e.lessonId,u=t.asData,a=t.lessonPlayUuid,u&&u.uuid!=t.lessonInstanceUuid&&DBLLog.log("Note lessonInstanceUuid mismatch asdata="+u.uuid+" startLesson="+t.lessonInstanceUuid,DBLLog.INFO),i=u?u.uuid:t.lessonInstanceUuid,s=0,l=e.assignmentId,c=e.assignmentType,d=e.fqln,p=e.lessonname,g=e.recommendationUuid,f=e.seedOverride):D&&(h=t.assignmentCompletions),processAssessmentType(t),screenerMode&&r&&i&&setSessionProperty(x,{lessonid:r,lessonuuid:i}),b?(_=b,b=void 0,DBLActivityMonitor.pingServerOnMajorLessonEvents(function(){_&&_(o,r,a,i,s,p,l,c,u,d,g,f)})):D&&(m=D,D=void 0,DBLActivityMonitor.pingServerOnMajorLessonEvents(function(){m&&m(h)}))):DBLLog.log(L+" response was: "+y,DBLLog.FATAL,n)}function P(e,t,n,o){var r,i,a;serverURL&&n.lessonId?(v=new XMLHttpRequest,r=serverURL+h.replace("USERID",__studentId),L=h,i=t.ls[t.ls.length-1],a={lessonId:n.lessonId,lessonInstanceUuid:t.uuid,sequence:__apiSequence,assignmentId:t.aid,exitCode:0==(a=n.exit)?"FAIL":1==a?"PASS":2==a?"TRY_AGAIN_LATER":"SUSPEND",scores:(e=>{for(var t=[],n=0;n<e.length;n++)t.push({problemType:e[n].mpt,questionType:e[n].mqt,score:e[n].sc,maxPossibleScore:e[n].m});return t})(e),progress:i.prg,asData:t},i.rid&&(a.recommendationUuid=i.rid),i.pid&&(a.lessonPlayUuid=i.pid),n.transcript&&rootParams.transcript&&(__replayEnabledForLesson||debug)&&(a.transcript=n.transcript),v.open("POST",r,!0),v.timeout=DEFAULT_LOAD_TIMEOUT,v.setRequestHeader("Content-type","application/json"),v.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&v.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),v.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),v.onreadystatechange=function(){try{4==v.readyState&&(200==v.status?I():0!=v.status&&R())}catch(e){throw dblRecordError(e),e}},v.onerror=function(){try{R()}catch(e){throw dblRecordError(e),e}},D=o,v.send(JSON.stringify(a))):(recommendations_mock.onLessonEnd(),setTimeout(function(){o({123:!0})},rootParams.slowserver?3e3:100))}function w(){DBLLog.log(g+" was unreachable",DBLLog.WARN);var e=u;u=null,e&&e()}e.getLastLessonInfo=function(){return getSessionProperty(x)},e.getRecommendationsAttributesSummary=T,e.getRecommendations=n,e.startLesson=function(e,t){DBLLog.log("startLesson()",DBLLog.INFO),f?DBLLog.log("startLesson without prior endLesson",DBLLog.FATAL,DBLError.INVALID_CLIENT_STATE):(f=!0,_=e.lessonId,S=e,__apiSequence++,o(e,t))},e.endLesson=function(e,t,n,o){DBLLog.log("endLesson()",DBLLog.INFO),f?_&&n.lessonId&&_!=n.lessonId?DBLLog.log("endLesson had different lessonId than startLesson: "+_+" vs "+n.lessonId,DBLLog.FATAL,DBLError.INVALID_CLIENT_STATE):(f=!1,_=0,A=e,E=t,B=n,__apiSequence++,P(e,t,n,o)):DBLLog.log("endLesson without prior startLesson",DBLLog.FATAL,DBLError.INVALID_CLIENT_STATE)},e.getDebugLessonsPlayed=function(){return recommendations_mock.__debugLessonsPlayed},e.autoSaveLesson=function(e,t,n,o){var r,i;DBLLog.log("Autosave",DBLLog.INFO),assert(f),serverURL?(v=new XMLHttpRequest,r=serverURL+g.replace("USERID",__studentId),i=t.ls[t.ls.length-1],e={lessonId:e,lessonInstanceUuid:t.uuid,progress:t.prg,asData:t},i.rid&&(e.recommendationUuid=i.rid),i.pid&&(e.lessonPlayUuid=i.pid),n&&rootParams.transcript&&(__replayEnabledForLesson||debug)&&(e.transcript=n),v.open("POST",r,!0),v.timeout=DEFAULT_LOAD_TIMEOUT,v.setRequestHeader("Content-type","application/json"),v.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&v.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),v.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),v.onreadystatechange=function(){try{4==v.readyState&&(200==v.status||204==v.status?(e=u,u=null,e&&e()):0!=v.status&&w())}catch(e){throw dblRecordError(e),e}var e},v.onerror=function(){try{w()}catch(e){throw dblRecordError(e),e}},u=o,v.send(JSON.stringify(e))):setTimeout(function(){o()},100)},e.getLessonActive=function(){return f}})(DBLLessonManager=DBLLessonManager||{}),(s=>{function e(){return getSessionProperty("Session.mock_screenerLessons")}function t(){return getSessionProperty("Session.mock_screenerLessonIndex")||0}function l(e,t){setTimeout(function(){t({playRecommendations:e})},100)}s.__debugLessonsPlayed=0,s.getRecommendations=function(e,t){if(!screenerMode&&"neon"==engagement){var n=["RECOMMENDED","ASSIGNED"],o=["RECOMMENDED"],r=[];if(__debugNeon){for(var i=0;i<7;i++)r.push(c(i,0,o));1<=s.__debugLessonsPlayed&&r.push(c(1,0,n)),2<=s.__debugLessonsPlayed&&(r.pop(),r.push(c(2,0,o)))}else r=[c(0,0,n),c(1,0,n),c(2,0,o),c(3,0,o),c(4,0,o),c(5,0,o)],1<=s.__debugLessonsPlayed&&r.splice(0,1),2<=s.__debugLessonsPlayed&&r.splice(0,1),3<=s.__debugLessonsPlayed&&(r.splice(2,1),r.push(c(6,0,o)));var a=Date.now();r.forEach(function(e,t){e.statuses==n&&(t=new Date(a+36e5*(2.1+24*t)),e.assignmentEndDate=t.toISOString())}),l(r,t)}},s.onLessonEnd=function(){s.__debugLessonsPlayed++,setSessionProperty("Session.mock_screenerLessonIndex",t()+1),screenerMode&&s.__debugLessonsPlayed>=e().length&&(screenerMode=!1)};var o=["DBLAUnit73EF20","DBLAUnit74BF3","DBLAUnit74GF9","DBLAUnit75EF13","DBLAUnit76JF2","DBLAUnit77CF31","DBLAUnit77AF7","DBLAUnit78A-DesignsF4","DBLAUnit78FF1","DBLAUnit81FF3"].map(function(e){return"assets.media.engagement.intermediate.lessonicons."+e}),r=["Early Equivalency","Translating Expressions","Compose, Add & Substract angles","Measuring Volume with Cubes","Order of Operations 1","Early Equivalency 2","Order of Operations 2","Decimals on the Number Line","Operations Superiority","Super Substraction","Early Addition and Substraction"];function c(e,t,n){return{lessonId:1e3+e,type:0,name:r[e]||r[0],fqln:"lessons.math.addingandsubtracting.MatchingMake10_LevelOne",primaryIcon:"assets.media.engagement.primary.lessonicons.IconAdd1To9TF7C3",intermediateIcon:o[e]||o[0],assignmentId:e+123,friendlyAudio:"add_on",assignmentType:"SPOT",statuses:n,recommendationUuid:"123-abc"}}})(recommendations_mock=recommendations_mock||{}),(n=>{function o(){var e=n.call(this)||this,t=(e._show=!1,e._minShowTimeReached=!1,e._callback=null,e.name="spinner",e.visible=!1,window.runtime_LoadingSpinner);return t&&(e._art=new t.DBLALoadingCircle,e._art.stop(),e.addChild(e._art)),e.setBounds(0,0,1024,768),e._timerBeforeShow=new DBLTimer(o.BEFORE_SHOW_DELAY,1),e._timerBeforeShow.addEventListener(DBLTimer.TIMER,e.onTimeBeforeShow.bind(e)),e._timerMinShow=new DBLTimer(o.MINIMUM_SHOW_DURATION,1),e._timerMinShow.addEventListener(DBLTimer.TIMER,e.onTimeMinShow.bind(e)),e.addEventListener("added",e.addedToStage.bind(e)),e}return __extends(o,n),o.prototype.cleanup=function(){this.stopSpinning(),this._timerBeforeShow.reset(),this._timerMinShow.reset(),this._timerBeforeShow.removeAllEventListeners(DBLTimer.TIMER),this._timerMinShow.removeAllEventListeners(DBLTimer.TIMER)},o.prototype.tick24=function(e){for(;0<e--;)this._art&&this._art.advance()},o.prototype.resize=function(){this._art&&(this._art.scaleX=this._art.scaleY=lessonContent.scaleX,this._art.x=Math.round(1024*lessonContent.scaleX/2),this._art.y=Math.round(743*lessonContent.scaleX/2))},o.prototype.addedToStage=function(e){this.resize(),this.removeAllEventListeners("added")},o.prototype.show=function(){this._show||(this._show=!0,this.onTimeBeforeShow(null))},o.prototype.showWithDelay=function(){this._show||(this._show=!0,this._timerBeforeShow.reset(),this._timerBeforeShow.start())},o.prototype.onTimeBeforeShow=function(e){void 0===e&&(e=null),this.visible=!0,this.startSpinning(),this.onShowComplete(),this._minShowTimeReached=!1,this._callback=null,this._timerMinShow.reset(),this._timerMinShow.start()},o.prototype.hide=function(){this._show&&(this._timerBeforeShow.reset(),this._timerMinShow.reset(),this._show=!1,this._callback=null,this.onHideComplete())},o.prototype.hideWithMinShowTime=function(e){this._show?!this.visible||this._minShowTimeReached?(this.hide(),e()):this._callback=e:e()},o.prototype.onTimeMinShow=function(e){var t;this._minShowTimeReached=!0,null!=this._callback&&(t=this._callback,this.hide(),t())},o.prototype.onShowComplete=function(){},o.prototype.onHideComplete=function(){this.visible=!1,this.stopSpinning()},o.prototype.startSpinning=function(){this._art&&this._art.play()},o.prototype.stopSpinning=function(){this._art&&this._art.stop()},o.BEFORE_SHOW_DELAY=1e3,o.MINIMUM_SHOW_DURATION=750,o})(createjs.Container)),DBLManifestUtils,DBLMessageManager,DBLNumberUtils,DBLProxy,DBLPlay,DBLPlayService=((DBLManifestUtils||(DBLManifestUtils={})).getManifestItems=function(e){var r=e[0].split(",");return e.slice(1).map(function(e){return e.split(",").reduce(function(e,t,n){var o={};return o[r[n]]=t,__assign(__assign({},e),o)},{})})},!function(DBLMessageManager){var __xhrGetMessage,__getMessagesCallbacks=[],__unsentUpdates,__xhrUpdate,__sendingUpdates,__updatePending,__unsentDBLUpdates,__dblUpdating,__dblUpdatePending,__xhrSend,__sendMessageCallback,__xhrGetImage,__getImageCallback,__getImageTimeout,MESSAGES_ENDPOINT="public/v1/users/USERID/messages",FILES_ENDPOINT="public/v1/users/USERID/files/PATH",GENERATE_ENDPOINT="public/v1/users/USERID/generateFileUploadParameters";function cleanup(){__xhrUpdate&&(__xhrUpdate.abort(),__xhrUpdate=null,__sendingUpdates=[])}function checkMessages(e){DBLLog.log("checkMessages()",DBLLog.INFO),getMessagesHelper(e,!0),__unsentUpdates&&0<__unsentUpdates.length&&!__xhrUpdate&&(DBLLog.log("Retrying previous messages update",DBLLog.INFO),startUpdate())}function getMessages(e){DBLLog.log("getMessages()",DBLLog.INFO),getMessagesHelper(e,!1)}function getMessagesHelper(e,t){var n;serverURL&&(__xhrGetMessage?DBLLog.log("Concurrent getMessage api",DBLLog.INFO):(n=serverURL+MESSAGES_ENDPOINT.replace("USERID",__studentId),t&&(n+="?pageSize=0"),(__xhrGetMessage=new XMLHttpRequest).open("GET",n,!0),__xhrGetMessage.setRequestHeader("Content-type","application/json"),__xhrGetMessage.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&__xhrGetMessage.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),__xhrGetMessage.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),__xhrGetMessage.onreadystatechange=function(){try{if(4==__xhrGetMessage.readyState)if(200==__xhrGetMessage.status){var e=null;try{e=JSON.parse(__xhrGetMessage.response)}catch(e){DBLLog.log(MESSAGES_ENDPOINT+" - unable to parse data.",DBLLog.ERROR)}onGetMessageSucceeded(e=addDreamBoxMessages(e))}else 0!=__xhrGetMessage.status&&onGetMessageFailed()}catch(e){throw dblRecordError(e),e}},__xhrGetMessage.onerror=function(){onGetMessageFailed()},__xhrGetMessage.send()),__getMessagesCallbacks.push(e))}function onGetMessageFailed(){var e=DBLError.TROUBLE_COMMUNICATING;if(400<=__xhrGetMessage.status&&__xhrGetMessage.status<=499)try{var t=JSON.parse(__xhrGetMessage.response);t&&t.errorCode&&(e=t.errorCode)}catch(e){}DBLLog.log(MESSAGES_ENDPOINT+" was unreachable: "+__xhrGetMessage.status+" "+e,DBLLog.ERROR),onGetMessageSucceeded(null)}function onGetMessageSucceeded(e){__xhrGetMessage=null;var t=__getMessagesCallbacks;__getMessagesCallbacks=[];for(var n=0,o=t;n<o.length;n++)(0,o[n])(e)}function sendUpdates(e){if(DBLLog.log("sendUpdates("+JSON.stringify(e)+")",DBLLog.INFO),serverURL){for(var t=!1,n=!1,o=0,r=e;o<r.length;o++){var i=r[o];"DBL"==i.messageId.substr(0,3)?(t=!0,__unsentDBLUpdates=(__unsentDBLUpdates||[]).concat(i)):(n=!0,__unsentUpdates=(__unsentUpdates||[]).concat(i))}n&&(__xhrUpdate?__updatePending=!0:startUpdate()),t&&(__dblUpdating?__dblUpdatePending=!0:startDblUpdate())}}function startUpdate(){var e=serverURL+MESSAGES_ENDPOINT.replace("USERID",__studentId);(__xhrUpdate=new XMLHttpRequest).open("PATCH",e,!0),__xhrUpdate.setRequestHeader("Content-type","application/json"),__xhrUpdate.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&__xhrUpdate.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),__xhrUpdate.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),__xhrUpdate.onreadystatechange=function(){try{if(4==__xhrUpdate.readyState)if(200==__xhrUpdate.status){var e=null;try{e=JSON.parse(__xhrUpdate.response)}catch(e){DBLLog.log(MESSAGES_ENDPOINT+" - unable to parse data.",DBLLog.ERROR)}e||onUpdateFailed();try{for(var t=0,n=e.results;t<n.length;t++){var o=n[t];if("CREATED"===o.status||"UPDATED"===o.status)for(var r=0;r<__sendingUpdates.length;r++)__sendingUpdates[r].messageId===o.messageId&&(__sendingUpdates.splice(r,1),r--)}0<__sendingUpdates.length&&(__unsentUpdates=__sendingUpdates.concat(__unsentUpdates),__sendingUpdates=[],DBLLog.log(MESSAGES_ENDPOINT+" not all updates worked - very unusual",DBLLog.ERROR))}catch(e){}__sendingUpdates=[],__xhrUpdate=null,__updatePending&&startUpdate()}else 0!=__xhrUpdate.status&&onUpdateFailed()}catch(e){throw dblRecordError(e),e}},__xhrUpdate.onerror=function(){onUpdateFailed()},__sendingUpdates=dedupUpdates(__unsentUpdates),__updatePending=!(__unsentUpdates=[]),__xhrUpdate.send(JSON.stringify({updates:__sendingUpdates}))}function dedupUpdates(e){for(var t={},n=0,o=e;n<o.length;n++){var r=o[n];t[r.messageId]=r}return Object.keys(t).map(function(e){return t[e]})}function onUpdateFailed(){var e=DBLError.TROUBLE_COMMUNICATING;if(400<=__xhrUpdate.status&&__xhrUpdate.status<=499)try{var t=JSON.parse(__xhrUpdate.response);t&&t.errorCode&&(e=t.errorCode)}catch(e){}__unsentUpdates=__sendingUpdates.concat(__unsentUpdates),__sendingUpdates=[],DBLLog.log(MESSAGES_ENDPOINT+" was unreachable: "+__xhrUpdate.status+" "+e,DBLLog.ERROR),__xhrUpdate=null}function startDblUpdate(){__dblUpdating=!0;for(var e=0,t=__unsentDBLUpdates;e<t.length;e++){var n=(a=t[e]).reactionName||"SEEN";DBLClientEventManager.recordClientEvent("DblMessageStatus",a.messageId,n)}for(var o=(u=DBLStateManager.getProperty("Property.dreamboxReactions")||"")?u.split(","):[],r=0,i=__unsentDBLUpdates;r<i.length;r++){for(var a,s=!1,n=(a=i[r]).reactionName||"SEEN",l=0;l<o.length;l++){var c=o[l].split(":");if(c[0]==a.messageId){c[1]=n,o.splice(l,1,c.join(":")),s=!0;break}}s||o.push(a.messageId+":"+n)}var u=o.join(",");__dblUpdatePending=!(__unsentDBLUpdates=[]),DBLStateManager.setProperty("Property.dreamboxReactions",u),DBLStateManager.syncProperties(function(){__dblUpdating=!1,__dblUpdatePending&&startDblUpdate()})}function sendMessage(e,t,n,o){DBLLog.log("sendMessage("+e+")",DBLLog.INFO),serverURL&&(__sendMessageCallback=o,sendMessagePart1(e,[t,n],[],0))}function sendMessagePart1(t,n,o,r){var e=serverURL+GENERATE_ENDPOINT.replace("USERID",__studentId);(__xhrSend=new XMLHttpRequest).open("POST",e,!0),__xhrSend.setRequestHeader("Content-type","application/json"),__xhrSend.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&__xhrSend.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),__xhrSend.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),__xhrSend.onreadystatechange=function(){try{if(4==__xhrSend.readyState)if(200==__xhrSend.status){var e=null;try{e=JSON.parse(__xhrSend.response)}catch(e){DBLLog.log(GENERATE_ENDPOINT+" - unable to parse data.",DBLLog.ERROR)}e?sendMessagePart2(t,n,o,r,e.url,e.filePath,e.formData):onSendFailed()}else 0!=__xhrSend.status&&onSendFailed()}catch(e){throw dblRecordError(e),e}},__xhrSend.onerror=function(){onSendFailed()},__xhrSend.send(JSON.stringify({httpMethod:"POST",contentType:"text/plain"}))}function sendMessagePart2(e,t,n,o,r,i,a){(__xhrSend=new XMLHttpRequest).open("POST",r,!0);var s="-----DBL",r=(__xhrSend.setRequestHeader("Content-type","multipart/form-data; boundary="+s),__xhrSend.onreadystatechange=function(){try{4==__xhrSend.readyState&&(204==__xhrSend.status?(n.push(i),0==o?sendMessagePart1(e,t,n,o+1):sendMessagePart3(e,n)):0!=__xhrSend.status&&onSendFailed())}catch(e){throw dblRecordError(e),e}},__xhrSend.onerror=function(){onSendFailed()},null);try{r=t[o].toDataURL("image/jpeg")}catch(e){DBLLog.log("screenshot doDataURL failed - tainted canvas?",DBLLog.ERROR)}if(r){var l,c="";for(l in a)c=(c=c+"--"+s+'\r\nContent-Disposition: form-data; name="'+l+'"\r\n\r\n')+a[l]+"\r\n";__xhrSend.send(c=(c=c+("--"+s+'\r\nContent-Disposition: form-data; name="file"; filename="file.txt"\r\n\r\n')+r)+"\r\n"+("--"+s+"--\r\n"))}else onSendFailed()}function sendMessagePart3(e,t){var n=serverURL+MESSAGES_ENDPOINT.replace("USERID",__studentId);(__xhrSend=new XMLHttpRequest).open("POST",n,!0),__xhrSend.setRequestHeader("Content-type","application/json"),__xhrSend.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&__xhrSend.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),__xhrSend.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),__xhrSend.onreadystatechange=function(){try{if(4==__xhrSend.readyState)if(200==__xhrSend.status){var e=null;try{e=JSON.parse(__xhrSend.response)}catch(e){DBLLog.log(MESSAGES_ENDPOINT+" - unable to parse data.",DBLLog.ERROR)}e.messageId?onSendSucceeded(e.messageId,!1):onSendFailed()}else 429==__xhrSend.status?onSendSucceeded(null,!0):0!=__xhrSend.status&&onSendFailed()}catch(e){throw dblRecordError(e),e}},__xhrSend.onerror=function(){onSendFailed()},__xhrSend.send(JSON.stringify({originator:"STUDENT",stockName:e,lessonId:__lessonid||null,thumbnailPath:t[0],snapshotPath:t[1]}))}function onSendFailed(){var e=DBLError.TROUBLE_COMMUNICATING;if(400<=__xhrSend.status&&__xhrSend.status<=499)try{var t=JSON.parse(__xhrGetMessage.response);t&&t.errorCode&&(e=t.errorCode)}catch(e){}DBLLog.log(MESSAGES_ENDPOINT+" was unreachable: "+__xhrSend.status+" "+e,DBLLog.ERROR),onSendSucceeded(null,!1)}function onSendSucceeded(e,t){var n=__sendMessageCallback;__sendMessageCallback=__xhrSend=null,n&&n(e,t)}function getImage(e,t){DBLLog.log("getImage("+e+")",DBLLog.INFO),serverURL&&(__xhrGetImage?DBLLog.log("Concurrent getImage api",DBLLog.FATAL,DBLError.INVALID_CLIENT_STATE):(e=serverURL+FILES_ENDPOINT.replace("USERID",__studentId).replace("PATH",e),(__xhrGetImage=new XMLHttpRequest).open("GET",e,!0),__xhrGetImage.setRequestHeader("Content-type","*/*"),__xhrGetImage.setRequestHeader("DBL-AuthSessionUuid",authSession),clientInstance&&__xhrGetImage.setRequestHeader("DBL-ClientInstanceUuid",clientInstance),__xhrGetImage.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),__xhrGetImage.onreadystatechange=function(){try{4==__xhrGetImage.readyState&&(200==__xhrGetImage.status?onGetImageSucceeded(__xhrGetImage.response):0!=__xhrGetImage.status&&onGetImageFailed())}catch(e){throw dblRecordError(e),e}},__xhrGetImage.onerror=function(e){onGetImageFailed()},__xhrGetImage.send(),__getImageCallback=t))}function onGetImageFailed(){onGetImageSucceeded(null)}function onGetImageSucceeded(e){var t=__getImageCallback;__getImageCallback=__xhrGetImage=null,t(e)}function cancelGetImage(){DBLLog.log("cancelGetImage()",DBLLog.INFO),serverURL&&(__xhrGetImage&&__xhrGetImage.abort(),__getImageCallback=__xhrGetImage=null)}function addDreamBoxMessages(data){if(!data)return null;var dreamboxMessages=window.assets_data_engagement_shared_DreamBoxMessages;if(dreamboxMessages){for(var seenAndReactionData=DBLStateManager.getProperty("Property.dreamboxReactions")||"",aRec=seenAndReactionData.split(","),reaction={},_i=0,aRec_1=aRec;_i<aRec_1.length;_i++){var rec=aRec_1[_i];rec&&(reaction[rec.split(":")[0]]=rec.split(":")[1])}var dateNow=new Date,id;for(id in dreamboxMessages)if("mappingfqn"!=id){assert("DBL"==id.substr(0,3));var dreamboxMessage=dreamboxMessages[id],dateSent=new Date(dreamboxMessage.date),daysOld=(dateNow.getTime()-dateSent.getTime())/1e3/60/60/24;if(daysOld<90&&(0<=daysOld||rootParams.showfuturemessages)){var condition=dreamboxMessage.condition;if(!condition||eval(condition)){data.messages=data.messages||[];for(var iMessage=void 0,iMessage=0;iMessage<data.messages.length&&!(dateSent.getTime()>new Date(data.messages[iMessage].createdAt).getTime());iMessage++);var message={id:id,originator:"DREAMBOX",messageText:dreamboxMessage[language]||"",createdAt:dateSent,seen:void 0!==reaction[id],reactionName:"SEEN"==reaction[id]?void 0:reaction[id]};data.messages.splice(iMessage,0,message),message.seen||data.newCount++,data.totalCount++}}}}return data}DBLMessageManager.cleanup=cleanup,DBLMessageManager.checkMessages=checkMessages,DBLMessageManager.getMessages=getMessages,DBLMessageManager.sendUpdates=sendUpdates,DBLMessageManager.sendMessage=sendMessage,DBLMessageManager.getImage=getImage,DBLMessageManager.cancelGetImage=cancelGetImage}(DBLMessageManager=DBLMessageManager||{}),(e=>{function o(e,t){if(isNaN(e)||isNaN(t))return NaN;if(!isFinite(e)||!isFinite(t))return NaN;if(1==e||1==t)return 1;for(;0!==t;){var n=t;t=e%t,e=n}return e}function t(e,t,n){return t>=e.length?n:o(e[t++],n)}function n(e){return e==Math.floor(e)}function r(e,t){if(!n(e)||!n(t))return DBLLog.log("x (=".concat(e,") and n (=").concat(t,") should be whole numbers."),DBLLog.ERROR),!1;if(e<0){if(t%2==0)return!1;e=-e}return n(Math.pow(e,1/t))}e.gcd=o,e.gcdArray=function(e){return t(e,1,e[0])},e.gcdArrayProcess=t,e.greatestCommonDivisorArray=function(e){return 0==e.length?1:e.reduce(function(e,t){return o(t,e)},e[0])},e.lcm=function(e,t){return e*t/o(e,t)},e.getAllFactorArray=function(e){for(var t=[],n=1;n*n<=e;n++)e%n==0&&t.push([n,e/n]);return t},e.getPrimeFactorArray=function(e){for(var t,n=[],o=2,r=(t=e=Math.abs(e))/2;o<=r&&o<=t;){for(;t%o==0;)n.push(o),t/=o;o++}return 0==n.length&&n.push(e),n},e.getPrimes=function(e){for(var t=[],n={},o=0;o<=e;o++)t[o]=2<=o,n[o]=2;for(var r=[],o=2;o<=e;o++){t[o]&&(r.push(o),n[o]=o);for(var i=0;i<r.length&&o*r[i]<=e&&r[i]<=n[o];i++)t[o*r[i]]=!1,n[o*r[i]]=r[i]}return r},e.log10=function(e){return Math.log(e)*Math.LOG10E},e.reverseDigits=function(e){for(var t=Math.abs(e),n=0;0<t;)n=10*n+t%10,t/=10;return n=e<0?-n:n},e.getNumberOfDigits=function(e){return Math.abs(e).toString().length},e.getNumberOfSymbols=function(e){return null!=(e=null==e?void 0:e.toString().length)?e:0},e.format=function(e,t){return void 0===t&&(t=","),e.toString().replace(/(\d)(?=(\d{3})+$)/g,"$1"+t)},e.formatNumber=function(e,t){return void 0===t&&(t=","),(e=e.toString().split("."))[0]=e[0].replace(/(\d)(?=(\d{3})+$)/g,"$1"+t),e.join(".")},e.buildExponentString=function(e,t,n){var o=Number(e);if(isNaN(o))return"".concat(e,"^").concat(t);if(0==o&&0!=t)return"0";switch(t){case 0:return n?null:"1";case 1:return"".concat(o);default:return"".concat(o,"^").concat(t)}},e.numberToString=function(e,t){return e=e.toFixed(t=void 0===t?8:t),this.removeNumberTrailingZeroes(e)},e.removeNumberTrailingZeroes=function(e){return-1!=e.indexOf(".")?e.replace(/\.?0+$/,""):e},e.getPlaceDigit=function(e,t){e=-1<e?e:-e;for(var n=0;0<e;n++){if(n==t)return e%10;e/=10}return 0},e.isValidNumber=function(e){return/^-?(((0|([1-9]\d*))(\.\d+)?)|(\.\d+))$/.test(e)},e.isWholeNumber=n,e.findAdjacentIntegers=function(e){return{min:Math.floor(e),max:Math.ceil(e)}},e.isPerfectNth=r,e.isPerfectSquare=function(e){return r(e,2)},e.eq=function(e,t,n){return void 0===n&&(n=5),n=Math.pow(10,n),Math.round(e*n)/n==Math.round(t*n)/n},e.lt=function(e,t,n){return void 0===n&&(n=5),n=Math.pow(10,n),Math.round(e*n)/n<Math.round(t*n)/n},e.lte=function(e,t,n){return void 0===n&&(n=5),n=Math.pow(10,n),Math.round(e*n)/n<=Math.round(t*n)/n},e.gt=function(e,t,n){return void 0===n&&(n=5),n=Math.pow(10,n),Math.round(e*n)/n>Math.round(t*n)/n},e.gte=function(e,t,n){return void 0===n&&(n=5),n=Math.pow(10,n),Math.round(e*n)/n>=Math.round(t*n)/n},e.fixPrecision=function(e,t){var n;return void 0===t&&(t=5),Number((e=e,n=t,t=Math.pow(10,t),(Math.round(e*t)/t).toFixed(n)))},e.round=function(e,t){return t=Math.pow(10,t),Math.round(e*t)/t}})(DBLNumberUtils=DBLNumberUtils||{}),!function(DBLProxy){function getActualsFromSignature(n,t,o){void 0===o&&(o=!1);try{for(var r=Loc.createLocaleMatcher({filter:function(e){return!(t&&e.file||e.theme&&"*"!=e.theme&&e.theme!=(theme||"generic")||e.story&&"*"!=e.story&&e.story!=(story||"none")||e.goal&&"*"!=e.goal&&e.goal!=goal||e.engagement&&"*"!=e.engagement&&e.engagement!=engagement||e.condition&&t&&!evaluateCondition(e.condition,t)||!(!t||e.file||e.files||__ttsInLesson||-1!=e.script.indexOf("{tts}")||e.module||"<>"==n||"[]"==n))}}),e=0;e<mappings.length;e++)if("break"===(t=>{var e=mappings[t][n];if(e&&e instanceof Array&&r.addFromList(e,"language",function(e){return e.mappingfqn=mappings[t].mappingfqn}),o&&r.hasReachedBest())return"break"})(e))break;return r.getAll()}catch(e){return null}}function getActualFromSignature(e,t,n){e=getActualsFromSignature(e,t,n=void 0===n?!1:n);return 0===e.length?null:1===e.length?e[0]:e[Math.floor(DBLRandom.seededRandomGeneralPurpose()*e.length)]}function getFQNFromActual(e){var t,n,o;return e?(t=!(t=e.file)&&e.files&&-1==e.files.indexOf(",")?e.files:t)?"assets/"==t.substr(0,7)?t.split("/").join("."):((n=e.mappingfqn.split(".")).pop(),o=".",e.language&&"*"!=e.language&&-1==t.indexOf(e.language)&&(o="."+e.language+"."),n.join(".")+o+t.split("/").join(".")):void 0:null}function evaluateCondition(condition,slots){var insertSlots=[];insertSlots.push("0");for(var i=1;i<slots.length;i++)"function"!=typeof slots[i]&&insertSlots.push(slots[i]);for(var i=1;i<insertSlots.length;i++){var regex1=new RegExp("isFeminine\\(<"+i+">\\)","g"),regex2=(condition=condition.replace(regex1,"isFeminine(translate('"+insertSlots[i]+"', false))"),new RegExp("isMasculine\\(<"+i+">\\)","g")),regex3=(condition=condition.replace(regex2,"isMasculine(translate('"+insertSlots[i]+"', false))"),new RegExp("needsAn\\(<"+i+">\\)","g")),regex4=(condition=condition.replace(regex3,"needsAn('"+insertSlots[i]+"')"),new RegExp("needsA\\(<"+i+">\\)","g")),regex5=(condition=condition.replace(regex4,"needsA('"+insertSlots[i]+"')"),new RegExp("<"+i+">","g"));condition=condition.replace(regex5,insertSlots[i])}return eval(condition)}DBLProxy.getActualsFromSignature=getActualsFromSignature,DBLProxy.getActualFromSignature=getActualFromSignature,DBLProxy.getFQNFromActual=getFQNFromActual,DBLProxy.evaluateCondition=evaluateCondition}(DBLProxy=DBLProxy||{}),(u=>{u.EXPRESSION_SEPARATOR="$";var d,D,S,p,h,g,f,_,N,m,y,v,c,L,b,A,E,B,r,i,a,s,t=u.EXPRESSION_SEPARATOR.replace("$","\\$"),l=(u.SCI_EXP_REG_EXP_STR="<".concat(t,"([^").concat(t,"]*)").concat(t,">"),u.SCI_EXP_REG_EXP=new RegExp(u.SCI_EXP_REG_EXP_STR,"g"),u.SCI_EXP_FILTER_WRITTEN=new RegExp("{written:".concat(u.SCI_EXP_REG_EXP_STR,"}{spoken:([^}]*)}"),"g"),u.ID_SIGNATURE_PREFIX="$",null),x=null,T=null,o="",C=(u.playTextPlusAuto_RepeatSpeech="noSignatureInIntermediate",{}),U={},j=60;function O(){for(var e in components){e=lesson[e];if("function"==typeof e.playText)return e}return null}function H(){var e;a=!0,s&&(e=s,s=null,e())}function K(){DBLLog.log("Critical audio ".concat(r," could not be loaded."),DBLLog.FATAL)}function G(e){return void 0!==e.text}function q(e){return void 0!==e.variable}u.initPlay=function(){m=!1,L=c=v=y=S=D=d=void 0,b=[],A=0,C={},U={},T=x=l=null,r&&createjs.Sound.removeSound(r,null),a=!1,s=r=null,i&&(i.removeAllEventListeners(),i.destroy(),i=null)},u.getCurrentlyPlayingSound=function(){return y},u.play=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];v="play",n(e)},u.playEventAudio=function(e,t){v="playEventAudio",n([e,t])},u.fastForwardPlayEventAudio=function(){},u.playText=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];v="playText",n(e)},u.playTextPlus=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];v="playTextPlus",n(e)},u.playTextPlusAuto=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];v="playTextPlusAuto",n(e)},u.playAcademic=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];v="playAcademic",n(e)},u.localizedText=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return M(e).map(function(e){return"[]"==e?(t.shift(),""):"<>"==e?t.shift()():e}).map(F).join("")},u.playTextToolAudio=function(e){g&&f&&(1.2<=__logDataVersion&&logAutomation('play "'+_+'"'),assert(!d,"reentrant playTextToolAudio"),m=!1,y=void 0,d=e,D=g.slice(0),S=f.slice(0),v="playTextToolAudio",(__ttsInLesson?oe:I)(),skippable=!0,R(N||_))},u.playTextToolAudioDuringFastForward=function(){1.2<=__logDataVersion&&logAutomation('play "'+_+'"')},u.playAudio=function(e,t,n){function o(){var e=d;d=null,e&&e()}var r=null!=t.callback?function(){t.callback(),null!=n&&n()}:n;if(m=!1,d=r,__useAudio){r=getActualFromSignature(e);if(r)try{var i,a=new Y(r,t,getActualFromSignature);DBLAutomation.recordConfiguration(),logAutomation('playAudio "'+a.captionString+'"'),(DBLAutomation.isRunningAutomation()||replayMode?P:(i=a.schedules,D=i.loadSchedule,S=i.playSchedule,R(a.captionString),I))()}catch(e){DBLLog.log(e.message,DBLLog.ERROR),o()}else DBLLog.log("No mapping matched the signature: '".concat(e,"'"),DBLLog.ERROR)}else o()},u.startPreloadSpecialLessonAudio=function(e){var t=getActualFromSignature(e),n=t.files.split("/").join("."),o=rootFromFQN(n)+t.files+".mp3"+getLoadSuffix();t?i?r&&r==n?DBLLog.log("startPreloadSpecialLessonAudio called again - handling.",DBLLog.INFO):DBLLog.log("startPreloadSpecialLessonAudio can only be called for one file per lesson.",DBLLog.ERROR):(r=n,a=!1,s=null,(i=new createjs.LoadQueue).installPlugin(createjs.Sound),i.stopOnError=!0,i.addEventListener("complete",H),i.addEventListener("error",K),i.loadFile({id:n,src:o,type:"sound",loadTimeout:DEFAULT_LOAD_TIMEOUT},!1),i.load(),DBLLog.log("Loading "+o+" as "+n,DBLLog.INFO)):DBLLog.log("No mapping matched the signature: '".concat(e,"'"),DBLLog.ERROR)},u.finishPreloadingSpecialLessonAudio=function(e){if(i)return a?e():void(s=e);DBLLog.log("finishPreloadSpecialLessonAudio can only be called after startPreloadSpecialLessonAudio.",DBLLog.ERROR)},u.fastForwardFinishPreloadingSpecialLessonAudio=function(){},u.variableRegex=/<([^<>]*)>/g.source,u.actionRegex=/\[([^\]]*)\]/g.source,u.wordRegex=/Mr\.|Mrs\.|Ms\.|[0-9]+(,[0-9]{3})+|\w+['’]\w*|\w+/g.source,u.timingRegex=/\[(\d+(\.\d+)?)-(\d+(\.\d+)?)\]/g.source,e.prototype.tokenizeSignature=function(e){e=this.escapeAll(e);for(var t,n=new RegExp("(".concat(u.actionRegex,")|(").concat(u.variableRegex,")"),"g"),o=[],r=0;null!==(t=n.exec(e));){var i=e.substring(r,t.index);0<i.length&&o.push({text:this.escapeAll(i,!0),file:null}),t[1]?(o.push({function:t[2]}),r=t.index+t[1].length):t[3]&&(o.push({variable:t[4],file:null}),r=t.index+t[3].length)}return r<e.length&&o.push({text:this.escapeAll(e.substring(r),!0),file:null}),o},e.prototype.escapeAll=function(e,t){void 0===t&&(t=!1);var n=e;return[{forward:"\\[",backward:"[",temporary:"ESCAPED_LEFT_BRACKET"},{forward:"\\]",backward:"]",temporary:"ESCAPED_RIGHT_BRACKET"},{forward:"\\<",backward:"<",temporary:"ESCAPED_LEFT_POINTY_BRACKET"},{forward:"\\>",backward:">",temporary:"ESCAPED_RIGHT_POINTY_BRACKET"}].forEach(function(e){n=n.split(t?e.temporary:e.forward).join(t?e.backward:e.temporary)}),n},e.prototype.setTextTokens=function(e,o,t){var n=t.transcription,r=t.playPartly.startMillis,i=t.playPartly.endMillis,a=t.playPartly.offsetMillis,s=e.split(","),t=this.tokens.filter(G);if(1===s.length&&n){var l=new V(n),c=0;t.forEach(function(e){e.file=s[0];var t=e.text.split("\n").join(" "),n=o.indexOf(t,c),t=n+t.length,t=(c=t,l.getMillis(t)),n=Math.min(l.getMillis(n)+(a||0),t);e.startMillis=Math.max(n,r),e.endMillis=Math.min(t,i)})}else{if(s.length!==t.length)throw 1===s.length?new Error("There is one audio file that needs to be split into ".concat(t.length," parts. Missing options.transcription.")):new Error("There are ".concat(s.length," audio files and ").concat(t.length," text parts."));t.forEach(function(e,t){e.file=s[t]})}},e.prototype.setVariableTokens=function(n){var e,o=this.tokens.filter(q),r=this;for(e in n)(e=>{var t=n[e];if(!t.file){e=r.getActualFromSignature(t.script);if(!e)throw new Error("No mapping matched the signature: '".concat(t.script,"'"));t.file=e.files}t.positions&&t.positions.filter(function(e){return e<o.length}).forEach(function(e){o[e].file=t.file,o[e].variable=t.script})})(e);for(var t=0,i=o.filter(function(e){return!e.file});t<i.length;t++){var a=i[t];if(n[a.variable])a.file=n[a.variable].file,a.variable=n[a.variable].script;else{var s=this.getActualFromSignature(a.variable);if(!s)throw new Error("No mapping matched the signature: '".concat(a.variable,"'"));a.file=s.files}}},e.prototype.setCaptionString=function(e){return null==e?this.captionString=this.tokens.map(function(e){return G(e)?e.text:q(e)?e.variable:"[".concat(e.function,"]")}).join(""):0==e.length?this.captionString=" ":this.captionString=e},Object.defineProperty(e.prototype,"schedules",{get:function(){var o={loadSchedule:[],playSchedule:[]};return this.tokens.forEach(function(e){if(G(e)){var t=e.file.split("/").join("."),n=rootFromFQN(t)+e.file+".mp3"+getLoadSuffix();r&&r==t?o.loadSchedule.push({}):o.loadSchedule.push({id:t,file:n,variable:!1}),void 0!==e.startMillis&&void 0!==e.endMillis?o.playSchedule.push({type:"playPartly",data:t,startTime:e.startMillis,duration:e.endMillis-e.startMillis}):o.playSchedule.push({type:"play",data:t})}else{if(!q(e))throw Error("Unknown token type: ".concat(JSON.stringify(e)));t=e.file.split("/").join("."),n=rootFromFQN(t)+e.file+".mp3"+getLoadSuffix();o.loadSchedule.push({id:t,file:n,variable:!1}),o.playSchedule.push({type:"play",data:t})}}),o},enumerable:!1,configurable:!0});var Y=e;function e(e,t,n){var o=e.script,e=e.files,n=(this.getActualFromSignature=n,t.options||{}),r=(n.playPartly={startMillis:(null==(r=n.playPartly)?void 0:r.startMillis)||0,offsetMillis:(null==(r=n.playPartly)?void 0:r.offsetMillis)||0,endMillis:(null==(r=n.playPartly)?void 0:r.endMillis)||Number.MAX_SAFE_INTEGER},t.variables||{});this.tokens||(this.tokens=this.tokenizeSignature(n.script||o)),this.setTextTokens(e,o,n),this.setVariableTokens(r),this.setCaptionString(n.captionString)}u.TokenizedScript=Y,W.prototype.getMillis=function(t){var e,n,o,r,i=this.indexTimes.findIndex(function(e){return e.index>=t});return 1e3*(-1!=i&&this.indexTimes[i].index===t?this.indexTimes[i].timing:0<i?(e=[this.indexTimes[i-1].timing,this.indexTimes[i].timing],o=[this.indexTimes[i-1].index,this.indexTimes[i].index],(n=e[0])+(t-(r=o[0]))*(e[1]-n)/(o[1]-r)):0===i?0:this.indexTimes[this.indexTimes.length-1].timing)};var V=W;function W(e){this.indexTimes=[];for(var t,n=new RegExp("(".concat(u.wordRegex,"|").concat(u.variableRegex,")(").concat(u.timingRegex,")"),"g"),o=0;null!==(t=n.exec(e));){var r=t[1],i=Number.parseFloat(t[5]),a=Number.parseFloat(t[7]);this.indexTimes.push({index:t.index-o,timing:i}),this.indexTimes.push({index:t.index+r.length-o,timing:a}),o+=t[4].length}}function X(e){for(var t=[],n=1;n<e.length-1;n++)t.push(e[n]);return t}function J(e){return null!=e&&e.startsWith(u.ID_SIGNATURE_PREFIX)}function z(e,t){var n,o,r=M(e),i=0,a=0,s=["0"];if(J(e))s.push.apply(s,t);else for(;a<r.length;)"[]"==r[a]?(n=t[i],i++,s.push(n)):"<>"==r[a]&&(n=t[i],i++,o=n.call(lesson),s.push(o)),a++;return{slots:s,signatureTexts:r}}function Q(e,t,n){var o=[],r=[],i=!1,a=!1;if(n){var a=-1<n.script.indexOf("{tts}"),s=(__ttsInLesson||a)&&-1==n.script.indexOf("SFX")&&-1==n.script.indexOf("{sfx}")&&!screencur;if(n.files&&n.script&&!s){for(var r=n.files.split(","),l=0;l<r.length;l++){for(var c=r[l].split("+"),u=0;u<c.length;u++)c[u]=((e,t)=>("blank"==(e=e.replace(/\\/g,"/"))?e="assets/audio/runtime/blank":"pause"==e?e="assets/audio/runtime/pause":-1==e.indexOf("/")&&((t=t.split(".")).pop(),e=t.join("/")+"/"+language+"/"+e),e))(c[u],n.mappingfqn);r[l]=c.join("+")}((e,t)=>{for(var n=0,o=0,r=0;r<t.length;r++)"<>"==t[r]&&n++,"[]"==t[r]&&o++;for(var i=1,a=1,r=0;r<e.length;r++)if("<"==e[r].substr(0,1)){if(n<i)return;i++}else if("["==e[r].substr(0,1)){if(o<a)return;a++}return 1})(o=M(n.script),t)||(DBLLog.log("Script does not match signature: '"+n.script+"'",DBLLog.ERROR),o=t)}else n.script?(r=[],o=M(n.script),s&&(i=!0)):(r=[],o=[])}else o=M(e),r=[],i=!0;return{texts:o=J(e)?o.map(function(e){return e.match(/^(<.*>|\[.*\])$/)?"".concat(e[0]).concat(e[e.length-1]):e}):o,files:r,tts:i,ttsTag:a}}function $(e,t,n,o){S=[];for(var r="",i="",a="",s=0,l=1,c=0;c<e.length;){if("[]"==e[c]){var u=t[l];D&&(l++,D.push({}),S.push({type:"command",data:u}),i+="[]")}else if("<>"==e[c]){void 0===t[l]&&DBLLog.log("missing play argument",DBLLog.WARN);var u=t[l].toString(),d=(l++,u),d=("squiggly"==engagement||"bookworm"==engagement?DBLUtils.isAlpha(d.substr(0,1))&&!(d=DBLAudioUtils.lookupVariableAudioScript(d))&&(rootParams.forcetts||__allowUnmappedInLesson||DBLLog.log("Variable audio symbol ".concat(u," could not be mapped"),DBLLog.ERROR),d=u):d=(d=DBLUtils.isAlpha(d.substr(0,1))?translate(d,!1):d).replace(/_/g," "),r+=d,i+=d,void 0),p=("spanish"==language&&(d=c+1<e.length?e[c+1]:void 0)&&""==d.trim()&&(d=(d="<>"==(d=c+2<e.length?e[c+2]:void 0)?t[l]:d)&&"string"==typeof d&&DBLUtils.isAlpha(d.substr(0,1))?translate(d,!1):void 0),DBLAudioUtils.numberToStringArray(u,d,!1,o));a+=(p=p||[u]).map(function(e){return DBLAudioUtils.lookupVariableAudioScript(e)||e}).join(" ");for(var h,g=o?re(u):null,f=0;f<p.length;f++)o?(h=DBLAudioUtils.lookupVariableAudioScript(p[f])||p[f],_=(0<f?" ":"")+(h=1==p[f].length&&DBLAudioUtils.isLetter(p[f])?"{sym:"+p[f]+"}":h),m="play"+A++,(D||[]).push({id:m,text:_,metric:g,variable:!0}),S.push({type:"play",data:m}),g=null):(h=DBLAudioUtils.lookupVariableAudioFile(p[f]))?(m=h.split("/").join("."),b=rootFromFQN(m)+h+".mp3"+getLoadSuffix(),D.push({id:m,file:b,variable:!0}),S.push({type:"play",data:m})):DBLLog.log("Failed to map variable audio '"+p[f]+"' to an audio file - skipping!",DBLLog.ERROR)}else if(r+=e[c],a+=e[c],i+=e[c],o){var _=e[c],m="play"+A++;(D||[]).push({id:m,text:_,metric:null,variable:!1}),S.push({type:"play",data:m,text:_})}else if(s<n.length){for(var y=n[s].split("+"),v=0;v<y.length;v++){var L=y[v],m=L.split("/").join("."),b=rootFromFQN(m)+L+".mp3"+getLoadSuffix();D.push({id:m,file:b,variable:!1}),S.push({type:"play",data:m})}s++}else __ttsInLesson||B||DBLLog.log("Play string mapping file entry has insufficient files for the number of inserts",DBLLog.ERROR);c++}return s<n.length&&DBLLog.log("Play string mapping file entry has too many files for the number of inserts",DBLLog.ERROR),{displayText:r,displayTextWithCommandMarkers:i,alertText:a}}function n(e){var e=function(e){m=!1,y=void 0;var t="primary"==this.engagement;if(d=e[e.length-1],__useAudio){var n=e[0];E=DBLMD5.digest(n),D=[],S=[],k("",""),L=0;var e=z(n,X(e)),o=e.slots,e=e.signatureTexts,r=getActualFromSignature(n,o);if(screenerMode&&r){var i,a,s=window.runtime_HintReference;for(i in s)s[i]==language&&(a=new RegExp(i,"ig"),r.script=r.script.replace(a," "))}return{signature:n,signatureTexts:e,actual:r,slots:o,isPrimary:t}}n=d,d=null,n&&n()}(e),t=e.signature,n=e.slots,o=e.isPrimary,e=Q(t,e.signatureTexts,e.actual),r=e.texts,i=e.files,a=e.tts,e=(B=e.ttsTag,k("",""),$(r,n,i,a)),r=e.displayText,i=e.displayTextWithCommandMarkers,r=(k(r,e.alertText),i=F(i),replayMode&&"play"!=v&&"playAcademic"!=v);if(r&&P(),DBLLog.log(v+'("'+p+'")',DBLLog.INFO),"playAcademic"!=v)DBLAutomation.recordConfiguration(),1.2<=__logDataVersion?logAutomation(v+' "'+i+'"'):logAutomation(v+' "'+p+'"');else{for(var s='playAcademic "'+t+'"',l=1;l<n.length;l++){var c=n[l];"function"!=typeof c&&(s+=", "+("number"==typeof c?c:'"'+c.toString()+'"'))}logAutomation(s)}"playTextPlusAuto"==v&&(("noSignature"==u.playTextPlusAuto_RepeatSpeech&&C[t]||"noSignatureInIntermediate"==u.playTextPlusAuto_RepeatSpeech&&!o&&C[t]||"no"==u.playTextPlusAuto_RepeatSpeech&&U[p])&&(v="playTextPlus"),C[t]=!0,U[p]=!0),"playText"!=v&&"playTextPlus"!=v&&"playTextPlusAuto"!=v||(g=D.slice(),f=S.slice(),_=p,N=h),r||(DBLAutomation.isRunningAutomation()||replayMode||"playText"==v||"playAcademic"==v||"playTextPlus"==v?P:("playTextPlusAuto"==v&&(T=p),R(),a?debug||__ttsInLesson||B?oe:(DBLLog.log("Missing entry for '"+t+"' ("+language+") - would use TTS in debug - proceeding without audio",DBLLog.ERROR),m=!0,L=0,w):I))()}function Z(e,t){m=!1,y=void 0,d=t,E="",__useAudio?(D=[],S=[],k(e,e),L=0,t="play"+A,D.push({id:t,text:e,metric:re(e),variable:!1}),S.push({type:"play",data:t}),A++,DBLLog.log(v+'("'+p+'")',DBLLog.INFO),"playTTSDirect"!=v&&(DBLAutomation.recordConfiguration(),logAutomation(v+' "'+p+'"')),R(),oe()):(e=d,d=null,e&&e())}function ee(){te(),y&&(y.removeAllEventListeners(),y.stop(),y=void 0),c&&(c.removeAllEventListeners(),c.destroy(),c=void 0,L=0),w()}function te(){m=!0,T&&((x=O())&&x.playTextPlus(T),T=null),x&&(x.fastForwardPlay(),x=null)}function R(e){void 0===e&&(e=null),h&&-1==h.indexOf("SFX")&&-1==h.indexOf("{sfx}")&&shell&&shell.showClosedCaptionString&&shell.showClosedCaptionString(e||h),null!==e&&(o=pe(e)),a11y.playAlert({label:o,cancelAllAlerts:!0,ignoreOnlyIfCompletelySimilar:!0})}function ne(){shell&&shell.notifyClosedCaptionPlayComplete()}function oe(){if(__screenReaderEnabled)DBLLog.log("Screen reader is enabled. Skipping TTS audio loading.",DBLLog.INFO),P();else{assert(D.length==S.length);for(var e,t=0;t<D.length;t++)if(D[t].id){for(var n=t+1;n<D.length&&D[n].id;n++);for(var o="",r={cache:!1,nocache:!1,num:0,max:0},i=t;i<n;i++){var a=D[i].text;o+=a,-1!=a.indexOf("{nocache}")&&(r.nocache=!0),-1!=a.indexOf("{cache}")&&(r.cache=!0),D[i].metric&&(D[i].metric.nocache?r.nocache=!0:D[i].metric.cache?r.cache=!0:(r.num+=D[i].metric.num,r.max=Math.max(r.max,D[i].metric.max)))}var s=DBLVoiceChoice.voice,l=DBLVoiceChoice.engine,c=DBLVoiceChoice.style,u=rootParams.ttspitch||"",d=rootParams.ttstimbre||"",o=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");if(o=((e,t)=>{if(__lexicon){for(var n=0;n<100;n++){var o,r=!1;for(o in __lexicon){var i=__lexicon[o].language||"*";i!=language&&"*"!=i||(i=__lexicon[o].voice||"*")!=t&&"*"!=i||(i=e.replace(new RegExp(o,"g"),__lexicon[o].replacement))!=e&&(e=i,r=!0)}if(!r)break}100==n&&DBLLog.log("Loop guard hit on TTS lexicon in "+e,DBLLog.ERROR)}else DBLLog.log("Spoke TTS without a Lexicon",DBLLog.INFO);return e})(o=de(o).replace(/{sym:([a-zA-Z])}/g,'<say-as interpret-as="characters">$1</say-as>').replace(/{times}/g,"times").replace(/{por}/g,"multiplicado por").replace(/{written:([^}]*)}/g,"").replace(/{spoken:([^}]*)}/g,"$1").replace(/\[ordinal:([0-9]*)\]/g,'<say-as interpret-as="ordinal">$1</say-as>').replace(/{spokenspelled:([^}]*)}/g,'<say-as interpret-as="characters">$1</say-as>').replace(/\[fraction:([^\]]*)\]/g,'<say-as interpret-as="fraction">$1</say-as>').replace(/{nocache}/g,"").replace(/{cache}/g,"").replace(/{verb:([a-zA-Z]*)}/g,'<w role="amazon:VB">$1</w>').replace(/{noun:([a-zA-Z]*)}/g,'<w role="amazon:NN">$1</w>').replace(/{pause:([0-9]*)}/g,'<break time="$1ms"/>').replace(/^{tts} /g,"").replace(/{tts}/g,"").replace(/^{sfx} /g,"").replace(/{sfx}/g,""),s),S[t]=DBLUtils.clone(S[t]),S.splice(t+1,n-(t+1)),D[t]=DBLUtils.clone(D[t]),D[t].text=o,D.splice(t+1,n-(t+1)),"..."==o.trim())D[t].file=rootURL+"assets/audio/runtime/pause.mp3"+getLoadSuffix(),D[t].id="pause",S[t].data="pause";else for(var p=1,h=0,g=DBLUtils.splitIntoSentences(o);h<g.length;h++){var f,_=g[h];1<p&&(S.splice(t+1,0,DBLUtils.clone(S[t])),D.splice(t+1,0,DBLUtils.clone(D[t])),t++),D[t].id=D[t].id.split("-")[0]+"-"+p,S[t].data=S[t].data.split("-")[0]+"-"+p,D[t].text=_,(__ttsInLesson||B||"playTTS"==v||"playTTSDirect"==v)&&serverURL?__ttsCacheBase&&!r.nocache?(f=((e,t,n,o,r,i)=>(e=e+t+n+o+r+i,DBLMD5.digest(e)+".mp3"))(_,s,l,c,u,d),D[t].file=((e=__ttsCacheBase)&&"/"!=e.substr(-1)&&(e+="/"),e+f),D[t].backup=ie(_,s,l,c,u,d,f)):D[t].file=ie(_,s,l,c,u,d,""):D[t].file=void 0,p++}}D.forEach(function(t,e){var n;t.text&&(n=D.slice(0,e).find(function(e){return e.text==t.text}))&&(t.skip=!0,S[e].data=n.id)}),I()}}function re(e){if(-1!=e.indexOf("{nocache}"))return{nocache:!0};if(-1!=e.indexOf("{cache}"))return{cache:!0};for(var t={num:0,max:0},n=0,o=e.split(/([0-9]*)/);n<o.length;n++){var r=o[n],r=parseInt(r);isNaN(r)||(t.num++,t.max<r&&(t.max=r))}return t}function ie(e,t,n,o,r,i,a){e=serverURL+"public/v1/media/speak?userid="+__studentId+"&text="+encodeURIComponent(e)+"&voice="+t+"&engine="+n+"&style="+o+"&pitch="+r+"&timbre="+i+"&lesson="+(__lessonid||"")+"&signature="+E+"&file="+a;return IE&&(e+="&authSessionUuid="+authSession+"&clientRequestUuid="+uuidv4()),IE&&clientInstance&&(e+="&clientInstanceUuid="+clientInstance),e}function I(){if(__screenReaderEnabled)DBLLog.log("Screen reader is enabled. Skipping audio loading.",DBLLog.INFO),P();else{(c=new createjs.LoadQueue).installPlugin(createjs.Sound),c.stopOnError=!0,c.on("complete",P,this),c.on("error",le,this);for(var e=0;e<D.length;e++){var t=D[e].file,n=D[e].skip,o=D[e].id;!t||n||c.getItem(o)||(n=void 0,0==t.indexOf(serverURL)&&(n={"DBL-AuthSessionUuid":authSession,"DBL-ClientRequestUuid":uuidv4()},clientInstance)&&(n["DBL-ClientInstanceUuid"]=clientInstance),c.loadFile({id:o,src:t,type:"sound",loadTimeout:DEFAULT_LOAD_TIMEOUT,headers:n},!1),DBLLog.log("Loading "+t+" as "+o+" with headers "+JSON.stringify(n),DBLLog.INFO))}c.load()}}function P(){var e;T=null,c&&(c.removeAllEventListeners(),c.close(),c=void 0),"playEventAudio"==v?(1==S.length&&"play"==S[0].type?fastForwarding||createjs.Sound.play(S[0].data):DBLLog.log("playEventAudio() works only with simple sounds",DBLLog.ERROR),v=void 0,e=d,d=null,e&&e.call(lesson),ne()):"playText"==v||"playTextPlus"==v?(x=O())?x[v](p,ae):ae():"playTextPlusAuto"==v?(x=O())?x.playTextPlus(p,se):se():("playAcademic"==v?ae:(L=0,w))()}function ae(){x=null,m||(L=0,S=[],w())}function se(){x=null,m||(L=0,w())}function le(t){if((__ttsInLesson||B||"playTTS"==v||"playTTSDirect"==v)&&0==t.data.src.indexOf(__ttsCacheBase)){for(var n,e=0,o=D;e<o.length;e++){var r=o[e];if(r.file==t.data.src){n=r.backup,r.backup=null,t.data.id=r.id;break}}if(n)return void setTimeout(function(){DBLLog.log("Reloading from "+n,DBLLog.INFO);var e={"DBL-AuthSessionUuid":authSession,"DBL-ClientRequestUuid":uuidv4()},e=(clientInstance&&(e["DBL-ClientInstanceUuid"]=clientInstance),{src:n,type:"sound",id:t.data.id,loadTimeout:DEFAULT_LOAD_TIMEOUT,headers:e});t.target.reloadFile(t.data,e,!1),t.target.load()},0)}if(logAudioErrorOnce(),"playTextPlusAuto"==v&&T&&((x=O())&&x.playTextPlus(T),T=null),c&&(c.removeAllEventListeners(),c.close(),c=void 0),"playEventAudio"==v){DBLLog.log("Failed to load event audio '"+t.data.src+"' - skipping playEventAudio()",DBLLog.WARN),v=void 0;var i=d;d=null,i&&i.call(lesson)}else{for(var a=getTime(),s=(b.push(a),0),l=b;s<l.length;s++)a-(i=l[s])<1e3*j&&0;DBLLog.log("Failed to load proxy audio '"+t.data.src+"' - skipping play()",DBLLog.WARN),m=!0,L=0,w()}}function w(){for(var e=!1;S&&L<S.length&&!e;){var t=S[L];if(l=null,"command"==t.type)__calledFromPlay=!0,t.data.call(lesson),__calledFromPlay=!1,l&&(e=!0);else if(("play"==t.type||"playPartly"==t.type)&&!(m||DBLAutomation.isRunningAutomation()||replayMode||__screenReaderEnabled)){var n="playPartly"===t.type?{startTime:t.startTime,duration:t.duration}:{};if("playFailed"==(y=createjs.Sound.play(t.data,n)).playState){t=void 0;try{t=y.src}catch(e){}DBLLog.log("Sound "+t+" did not play",DBLLog.INFO)}else y.on("complete",ue,this),y.on("failed",ce,this),e=!0}L++}if(S&&L==S.length&&!e){for(var o=0,r=S;o<r.length;o++){var i=r[o];"play"==i.type&&createjs.Sound.removeSound(i.data,null)}D=[],S=[],L=0,ne(),replayMode&&takePendingSnapshot();var a=d;d=null,a&&interruptPoint(a)}}function ce(){DBLLog.log("A sound failed to play - skipping",DBLLog.INFO),ue()}function ue(){y&&(y.removeAllEventListeners(),y=void 0),w()}function M(e){if(!e)return[];for(var t,n=[],o=0,r=!1,i=0;i<e.length;i++){var a=e.charAt(i);r||"<"!=a&&"["!=a?r&&a==t&&(n.push(e.substring(o,i+1)),o=i+1,r=!1):(o<i&&n.push(e.substring(o,i)),r=!0,o=i,t="<"==a?">":"]")}return o<i&&n.push(e.substring(o,i)),n}function F(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/{sym:([a-zA-Z])}/g,"$1")).replace(/{times}/g,"×")).replace(/{por}/g,"×")).replace(/{written:([^}]*)}/g,"$1")).replace(/\[fraction:([^\]]*)\]/g,function(e,t){return t.replace("+"," ")})).replace(/{spoken:([^}]*)}/g,"")).replace(/\[ordinal:([0-9]*)\]/g,"$1")).replace(/{spokenspelled:([^}]*)}/g,"")).replace(/{nocache}/g,"")).replace(/{cache}/g,"")).replace(/{verb:([a-zA-Z]*)}/g,"$1")).replace(/{noun:([a-zA-Z]*)}/g,"$1")).replace(/{pause:([0-9]*)}/g,"")).replace(/^{tts} /g,"")).replace(/{tts}/g,"")).replace(/^{sfx} /g,"")).replace(/{sfx}/g,"")}function k(e,t){h=F(de(e.replace(u.SCI_EXP_FILTER_WRITTEN,"$2"))),p=F(e),o=pe(t)}function de(e){return e.replace(/#sym([^#]*)#/g,"{sym$1}")}function pe(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=de(e)).replace(/{sym:([a-zA-Z])}/g,"$1")).replace(/{times}/g,"times")).replace(/{por}/g,"multiplicado por")).replace(/{written:([^}]*)}/g,"")).replace(/{spoken:([^}]*)}/g,"$1")).replace(/\[ordinal:([0-9]*)\]/g,"$1")).replace(/{spokenspelled:([^}]*)}/g,"$1")).replace(/\[fraction:([^\]]*)\]/g,function(e,t){return a11y.formatFractionsToMathMlFormat(t.replace("+"," "))})).replace(/{nocache}/g,"")).replace(/{cache}/g,"")).replace(/{verb:([a-zA-Z]*)}/g,"$1")).replace(/{noun:([a-zA-Z]*)}/g,"$1")).replace(/{pause:([0-9]*)}/g,"")).replace(/^{tts} /g,"")).replace(/{tts}/g,"")).replace(/^{sfx} /g,"")).replace(/{sfx}/g,"")}u.TranscriptionTimes=V,u.getSignatureArgs=X,u.getSlots=z,u.getTextsFilesTTS=Q,u.processTextAndSlots=$,u.sohlisg=function(e,t){v="playTTS",Z(e,t)},u._playTTSDirect_=function(e,t){v="playTTSDirect",Z(e,t)},u.fastForwardSohlisg=function(){ee()},u.fastForwardPlay=ee,u.fastForwardText=te,u.emitClosedCaptionString=R,u.notifyClosedCaptionPlayComplete=ne,u.partialFastForward=function(e){assert(0<e);for(var t=0,n=0;n<(S?S.length:0);n++){var o=S[n];if("command"==o.type&&++t==e)break}for(;S&&L<=n;)"command"==(o=S[L]).type&&(__calledFromPlay=!0,o.data.call(lesson),__calledFromPlay=!1),L++},u.finalFastForward=function(){for(;S&&L<S.length;){var e=S[L];"command"==e.type&&(__calledFromPlay=!0,e.data.call(lesson),__calledFromPlay=!1),L++}D=[],S=[],replayMode&&takePendingSnapshot();var t=d;d=null,t&&interruptPoint(t)},u.playProxyPause=function(e){m||DBLAutomation.isRunningAutomation()||replayMode||(l=setTimeout(function(){l=null,w()},e))},u.filterScriptMLForSR=pe,u.scientific=function(e){return u.EXPRESSION_SEPARATOR+e+u.EXPRESSION_SEPARATOR}})(DBLPlay=DBLPlay||{}),(()=>{function e(){this._mappings={},this._loadQueue=[]}return e.prototype.addMapping=function(e){return this.add(e,e,"csv"),this},e.prototype.addAudio=function(e,t){return this.add(e,t,"mp3"),this},e.prototype.getMapping=function(e){return this._mappings[e]},e.prototype.playAudio=function(e,t){var n=this.getMapping(e),o=DBLAsset.playSound(e);n&&shell.showClosedCaptionString(n.script),o&&o.duration?o.on("complete",function(){DBLAsset.stopSound(e),shell.notifyClosedCaptionPlayComplete(),t()}):t()},e.prototype.stopAudio=function(e){DBLAsset.stopSound(e)&&console.log("Stop playing ".concat(e))},e.prototype.load=function(t){var n=this,e=this._loadQueue.concat();if(this._loadQueue=[],e.length){var o=new createjs.LoadQueue;o.stopOnError=!0,o.installPlugin(createjs.Sound),o.on("error",function(){DBLLog.log("ERROR loading files ".concat(e.map(function(e){return e.id})),DBLLog.ERROR),t()}),o.on("complete",function(e){o.removeAllEventListeners(),o.destroy(),n._loadQueue.length?n.load(t):t()}),o.on("fileload",function(e){switch(e.item.ext){case"csv":n.csvLoaded(e);break;case"mp3":n.audioLoaded(e)}});for(var r=0,i=e;r<i.length;r++){var a=i[r],s=a.fqn,l=a.id,s=fileFromFQN(s,"."+a.extension);o.loadFile({src:s,id:l,loadTimeout:DEFAULT_LOAD_TIMEOUT},!1),DBLLog.log("Loading "+s,DBLLog.INFO)}o.load()}else t()},e.prototype.audioLoaded=function(e){},e.prototype.add=function(e,t,n){this._loadQueue.push({fqn:e,extension:n,id:t})},e.prototype.csvLoaded=function(i){var a=this;DBLCSVUtils.csvToJson(i.result).filter(function(e){return e.language==language}).forEach(function(e){var t=e.file,n=e.language,o=e.id,e=e.script,r=i.item.id.substring(0,i.item.id.lastIndexOf(".")),r="".concat(r,".").concat(n,".").concat(t);a._mappings[o]={id:o,language:n,script:e,fqn:r},a.addAudio(r,o)})},e})()),DBLPopin,DBLPopup,DBLQOSEventManager,DBLRandom,DBLSkippable,DBLSoftKey=((e=>{var r,i,a,s,n,l,t;function o(){s&&(s.removeAllEventListeners(),s=null),n&&(gsap.TweenLite.killTweensOf(n),n=null)}function c(){var e;n&&(n.scaleX=n.scaleY=1.094*lessonContent.scaleX,n.y=51*lessonContent.scaleX,e=engagementStage.getBounds().width,n.x=e-1023.984*lessonContent.scaleX)}function u(){s.removeAllEventListeners("complete"),DBLLog.log("Failed to load popin or popin audio - skipping popin",DBLLog.WARN),logAudioErrorOnce(),g()}function d(){var e=objectFromFQN(i);if(e){s.removeAllEventListeners("complete");var t=e.properties.manifest;if(0<t.length&&__useAudio&&!replayMode&&!__screenReaderEnabled){l=[];for(var e=i.split("."),n=e.slice(0,e.length-1).join("/"),o=0;o<t.length;o++){var r=rootURL+n+"/"+t[o].src+getLoadSuffix();DBLLog.log("Loading "+r,DBLLog.INFO),s.loadFile({src:r,id:t[o].id,loadTimeout:DEFAULT_LOAD_TIMEOUT},!1),l.push(t[o].id)}s.on("complete",p,this),s.load()}else p()}else DBLLog.log("Problem with "+i,DBLLog.ERROR),u()}function p(){if(s.removeAllEventListeners("complete"),(n=DBLAsset.createArt(i)).name="popin",c(),engagementStage.addChildAt(n,0),n.gotoAndPlay("Start"),replayMode)return n.gotoAndStop(12),takePendingSnapshot(),g();var e=n.timeline.duration/24;t=0,n.desiredFrame=0,gsap.TweenLite.to(n,e,{desiredFrame:n.timeline.duration-1,ease:gsap.Linear.easeNone,onUpdate:h,onComplete:g})}function h(){for(;t<n.desiredFrame;)DBLAsset.advanceMovieClip(n),t++}function g(){for(var e=0;e<l.length;e++)createjs.Sound.removeSound(l[e],null);l=[],s&&(s.removeAllEventListeners(),s.destroy(),s=null),n&&(n.removeAllEventListeners(),engagementStage.removeChild(n),n=null),shell&&shell.notifyClosedCaptionPlayComplete();var t=r;r=null,t&&t()}e.initPopin=function(){o(),n=s=a=i=r=null,l=[]},e.cleanupPopin=o,e.rescalePopin=c,e.playPopin=function(e,t){var n,o=DBLProxy.getActualFromSignature(e);o&&o.script&&(n=o.script,shell&&shell.showClosedCaptionString&&!replayMode&&(a11y.playAlert({label:n,cancelAllAlerts:!0}),shell.showClosedCaptionString(n)),a=o.script),o&&o.language&&"english_gb"==o.language&&(o.language="english"),(i=DBLProxy.getFQNFromActual(o))?(DBLAutomation.recordConfiguration(),logAutomation('playPopin("'+i.split(".").join("/")+'")'),DBLLog.log('playPopin("'+i.split(".").join("/")+'")',DBLLog.INFO),fastForwarding&&!replayMode?(i=null,t()):(r=t,(s=new createjs.LoadQueue).installPlugin(createjs.Sound),s.stopOnError=!0,s.on("complete",d,this),s.on("error",u,this),s.on("fileload",onPotentialAnimateFileLoad),objectFromFQN(i)?d():(n=fileFromFQN(i),DBLLog.log("Loading "+n,DBLLog.INFO),s.loadFile({src:n,id:i,loadTimeout:DEFAULT_LOAD_TIMEOUT},!0)))):(DBLLog.log("Popin signature '"+e+"' could not get resolved to a file.",DBLLog.ERROR),t())},e.getPopinScript=function(){return a},e.tick24=function(e){},e.fastForwardPlayPopin=function(){replayMode||(n&&gsap.TweenLite.killTweensOf(n),g())}})(DBLPopin=DBLPopin||{}),(e=>{var r,i,t="seenToolHelpTimestamp";function a(){r&&"function"==typeof r.cleanup&&r.cleanup();var e=i;i=r=null,e&&e()}e.toolHelpTimerChecker=function(e){return DBLUtils.popupTimerChecker(t,e,7)},e.setLastShownToolHelpTimestamp=function(e){DBLUtils.setLastShownPopupTimestamp(t,e)},e.playPopup=function(e,t){assert(!r,"reentrant playPopup");var n,o=DBLProxy.getActualFromSignature(e);o?o.module?(n=objectFromFQN(o.module))?(DBLLog.log('playPopup("'+o.script+'")',DBLLog.INFO),DBLAutomation.recordConfiguration(),replayMode||logAutomation('playPopup("'+o.script+'")'),i=t,fastForwarding&&!replayMode?a():r=n.playPopup(o,a)):(DBLLog.log("Please add '"+o.module+"' as a component to your lesson - it need not be in the layout.",DBLLog.ERROR),t()):(DBLLog.log("No module in popup proxy.",DBLLog.ERROR),t()):(DBLLog.log("Popup signature '"+e+"' not found - do you need to add a mapping?",DBLLog.ERROR),t())},e.fastForwardPlayPopup=function(){r&&r.fastForwardPlay()},e.takeSecondPopupSnapshot=function(){r&&r.replaySetPopupDownButton(!0),thawContent();var e=DBLAutomation.snapshot();freezeContent();for(var t=0;t<__slideRecords.length;t++)if(__slideRecords[t].transcriptIndex==__replayLine){__slideRecords[t+1].snapshot=e;break}r.replaySetPopupDownButton(!1)}})(DBLPopup=DBLPopup||{}),(e=>{var r,i,t,o={};function a(e,t,n){void 0===n&&(n=void 0),s(e)?(DBLLog.log("QOS recordEvent: "+e+" => "+JSON.stringify(t),DBLLog.DEBUG),DBLClientEventManager.recordClientEvent("QosEvent",e,t,n)):DBLLog.log("QOS recordEvent (send disabled): "+e+" => "+JSON.stringify(t),DBLLog.DEBUG)}function s(e){return __qosEvents&&!(e=>{if(!r&&(r=[],__qosKeysTitration)){var t,n=[];for(t in __qosKeysTitration){var o=__qosKeysTitration[t];Math.random()>o&&n.push(new RegExp("^"+t.replace(/\./g,"\\.").replace(/\*/g,".*")+"$"))}r=Object.keys(i).map(function(e){return i[e]}).filter(function(t){return n.some(function(e){return e.test(t)})})}return-1!==r.indexOf(e)})(e)}(t=i=e.Key||(e.Key={})).SessionLoginReadyLoadDuration="Session.LoginReadyLoadDuration.Milliseconds",t.SessionPlayInitialLoadDuration="Session.PlayInitialLoadDuration.Milliseconds",t.SessionStaticVersion="Session.StaticVersion.String",t.SessionTouchEnabled="Session.TouchEnabled.Boolean",t.SessionTouchUsed="Session.TouchUsed.Hit",t.PageLoadDuration="Page.InitialLoadDuration.Milliseconds",t.MessagesDialogLoadDuration="Messages.DialogLoadDuration.Milliseconds",e.recordEvent=a,e.markLoadStart=function(e,t){o[e]=(t=void 0===t?void 0:t)||getTime()},e.recordLoadEnd=function(e,t,n){void 0===t&&(t=void 0),void 0===n&&(n=void 0),void 0!==o[e]?(a(e,(t||getTime())-o[e],n),delete o[e]):DBLLog.log("recordLoadEnd called without a matching start marker: "+e,DBLLog.ERROR)},e.willSend=s,e.getDisabledKeys=function(){return r},e.setDisabledKeys=function(e){r=e}})(DBLQOSEventManager=DBLQOSEventManager||{}),(o=>{function i(e,t,n){if(void 0===n&&(n="generator"),t<e)throw new Error("Min can NOT be more than Max: "+e+", "+t);t=t-e+1,n="generator"==n?o.seededRandomForGenerators():o.seededRandomGeneralPurpose();return Math.floor(Math.floor(n*t)+e)}o.seededRandomForGenerators=function(){return r.seed,r.random()},o.getSeedForGenerators=function(){return r.seed},o.setSeedForGenerators=function(e){r.seed=e},o.seededRandomGeneralPurpose=function(){return a.random()},o.getSeedGeneralPurpose=function(){return a.seed},o.setSeedGeneralPurpose=function(e){a.seed=e},o.seededShuffle=function(e,t){void 0===t&&(t="generator");for(var n=0;n<e.length-1;n++){var o=i(n,e.length-1,t),r=e[o];e[o]=e[n],e[n]=r}return e},o.seededGenerateRandomInteger=i;var t=233280,e=(Object.defineProperty(n.prototype,"seed",{get:function(){return this._jran},set:function(e){this.safelySetSeed(e)},enumerable:!1,configurable:!0}),n.prototype.random=function(){return this._jran=(9301*this._jran+49297)%t,this._jran/t},n.prototype.safelySetSeed=function(e){t<=e&&(e%=t-1),this._jran=e},n);function n(e){this.safelySetSeed(e)}var r=new(o.DBLRandomReseedable=e)((new Date).getTime()),a=new e((new Date).getTime())})(DBLRandom=DBLRandom||{}),(a=>{function i(){return gsap.Linear.easeNone}var o=[],r=[],s=[],l=[];function c(){var e=o.slice(),n=r.slice();g(),e.forEach(function(e,t){return e.call(n[t])}),(paused||__pendingPause)&&(fastForwarding=!1)}function u(e,t){e&&e!=c&&-1==o.indexOf(e)&&(o.push(e),r.push(t))}function d(e,t,n){t=o.indexOf(t);0<=t&&(o.splice(t,1),r.splice(t,1)),__ff&&__ff!=c&&u(__ff,__ffObj),__ff=c,__ffObj=null,e&&"function"==typeof e&&(paused||__pendingPause?s.push(e):e())}function e(t,n){return new Promise(function(e){0;u(__ff,__ffObj),u(n,null),__ff=c,__ffObj=null,t(function(){return d(e,n)}),fastForwarding&&__ff&&__doFF()})}function p(n){return e(function(e){var t=n.eventCallback("onComplete");n.eventCallback("onComplete",function(){t&&t(),e()}),n.play()},function(){return t(n)})}function t(e){e.progress(1)}function n(e,t,n,o){void 0===o&&(o=!1);function r(e){return null==(e=i._movieClip.timeline.resolve(e))?i._movieClip.timeline.duration:e}var i=this;this._movieClip=e,this.reverse=o,this._fastForward=function(){for(;i.playing;)i.advance()},this.play=function(){return __awaiter(i,void 0,void 0,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return[4,a.callSkippable(function(e){t._callback=e,t._movieClip.gotoAndPlay(t.reverse?t._toPosition:t._fromPosition)},this._fastForward)];case 1:return e.sent(),[2]}})})},this.advance=function(){var e;i.playing&&(DBLAsset.advanceMovieClip(i._movieClip,i.reverse),i._movieClip.currentFrame==(i.reverse?i._fromPosition:i._toPosition))&&(i._movieClip.stop(),null!=(e=i._callback))&&e.call(i)};this._fromPosition="string"==typeof t?r(t):t,this._toPosition="string"==typeof n?r(n):n}function h(e,t){0<=e&&t&&(clearTimeout(e),t())}function g(){o=[],r=[]}a.resolveAllFinished=function(){var e=s.slice();s=[],e.forEach(function(e){return e()})},a.callSkippable=e,a.callSkippableAnimation=p,a.callSkippableAnimateObject=function(e,t,n,o){return void 0===o&&(o=i()),p(new gsap.TweenLite(e,n,__assign({ease:o},t)))},a.addObjectToAnimate=function(e,t,n,o){l.push({object:e,properties:t,duration:n,start:o})},a.callSkippableAnimateObjects=function(e){if(void 0===e&&(e=i()),0!=l.length){for(var t=new gsap.TimelineLite({ease:e}),n=0,o=l;n<o.length;n++){var r=o[n];t.to(r.object,r.duration,r.properties,r.start||0)}return l=[],p(t)}},Object.defineProperty(n.prototype,"playing",{get:function(){return!this._movieClip.paused},enumerable:!1,configurable:!0}),a.SkippableMovieClip=n,a.callSkippableNonBlockingPause=function(t){void 0===t&&(t=1e3);var n=-1,o=null;if(!fastForwarding&&0!=t)return e(function(e){o=e,n=setTimeout(e,t)},function(){return h(n,o)})};var f={};a.callDelayedAction=function(e,t,n){f[e]&&clearTimeout(f[e]),f[e]=setTimeout(function(){delete f[e],t()},n)},a.cleanup=function(){g(),s=[];for(var e=Object.keys(f),t=0,n=e;t<n.length;t++){var o=n[t];clearTimeout(f[o]),delete f[o]}}})(DBLSkippable=DBLSkippable||{}),(()=>{function o(e){this.stringRepresentation=e.stringRepresentation,this.type=e.type,this.asset=e.asset,this.code=e.code,this.softKeyPadLabel=null!=e.softKeyPadLabel?e.softKeyPadLabel:0<e.code?String.fromCharCode(e.code):"",this.physicalKeyMapping=e.physicalKeyMapping}return o.specialKeys=function(){return Object.keys(o).map(function(e){return o[e]}).filter(function(e){return e instanceof o})},o.prototype.toString=function(){return this.stringRepresentation},o.FORMULAS_OPERATION_KEYS=new o({stringRepresentation:"FORMULAS_OPERATION_KEYS",type:"typeFormulas",asset:"DBLA_FormulasFlyout_btn",code:-1290,softKeyPadLabel:""}),o.FORMULA_AREA_RECT=new o({stringRepresentation:"[l][w]",type:"typeAreaRectangle",asset:"DBLA_AreaRectangle_Btn",code:-940,softKeyPadLabel:""}),o.FORMULA_PERIM_RECT=new o({stringRepresentation:"2(l+w)",type:"typePerimRectangle",asset:"DBLA_PerimRectangle_Btn",code:-941,softKeyPadLabel:""}),o.FORMULA_AREA_PARALLELOGRAM=new o({stringRepresentation:"[b][h]",type:"typeAreaParallelogram",asset:"DBLA_AreaParallelogram_Btn",code:-942,softKeyPadLabel:""}),o.FORMULA_AREA_TRIANGLE=new o({stringRepresentation:"[1/2][b][h]",type:"typeAreaTriangle",asset:"DBLA_AreaTriangle_Btn",code:-943,softKeyPadLabel:""}),o.FORMULA_AREA_TRAPEZOID=new o({stringRepresentation:"[1/2](b_1+b_2)h",type:"typeAreaTrapezoid",asset:"DBLA_AreaTrapezoid_Btn",code:-944,softKeyPadLabel:""}),o.FORMULA_AREA_CIRCLE=new o({stringRepresentation:"[π]r^2",type:"typeAreaCircle",asset:"DBLA_AreaCircle_Btn",code:-945,softKeyPadLabel:""}),o.FORMULA_PERIM_CIRC=new o({stringRepresentation:"[π][d]",type:"typePerimCircumference",asset:"DBLA_PerimCircumference_Btn",code:-946,softKeyPadLabel:""}),o.FORMULA_PERIM_CIRC2=new o({stringRepresentation:"2[π][r]",type:"typePerimCircumference2",asset:"DBLA_PerimCircumference2_Btn",code:-947,softKeyPadLabel:""}),o.SA=new o({stringRepresentation:"SA",type:"typeSurfaceArea",code:-948,softKeyPadLabel:"SA",physicalKeyMapping:"S"}),o.FLYOUT_OPERATION_KEYS=new o({stringRepresentation:"FLYOUT_OPERATION_KEYS",type:"typeFlyout",asset:"KeyBase_smglyph",code:-129,softKeyPadLabel:""}),o.SQUARE=new o({stringRepresentation:"^2",type:"typeSquared",asset:"DBLA_Squared_btn",code:-96,softKeyPadLabel:""}),o.CUBE=new o({stringRepresentation:"^3",type:"typeCubed",asset:"DBLA_Cubed_btn",code:-97,softKeyPadLabel:""}),o.EXPONENT=new o({stringRepresentation:"^",type:"typeExponent",asset:"DBLA_Exponent_btn",code:-94,softKeyPadLabel:""}),o.ABSOLUTE_VALUE=new o({stringRepresentation:"|",type:"typeAbsoluteValue",asset:"DBLA_AbsValue_btn",code:-124,softKeyPadLabel:""}),o.PARENS=new o({stringRepresentation:"()",type:"typeParens",asset:"DBLA_Parentheses_btn",code:-40,softKeyPadLabel:""}),o.SQUARE_ROOT=new o({stringRepresentation:"#2",type:"typeSquareRoot",asset:"DBLA_SqRoot_btn",code:-37,softKeyPadLabel:""}),o.NTH_ROOT=new o({stringRepresentation:"#",type:"typeCustomRoot",asset:"DBLA_CustomRoot_btn",code:-35,softKeyPadLabel:""}),o.FRACTION=new o({stringRepresentation:"FRACTION",type:"typeFraction",asset:"DBLA_InputFlyout_btn",code:-47,softKeyPadLabel:""}),o.BACKSPACE=new o({stringRepresentation:"BACKSPACE",type:"typeBackspace",code:8,softKeyPadLabel:""}),o.ARROW_LEFT=new o({stringRepresentation:"ArrowLeft",type:"typeLeft",code:37,softKeyPadLabel:""}),o.ARROW_RIGHT=new o({stringRepresentation:"ArrowRight",type:"typeRight",code:39,softKeyPadLabel:""}),o.OR=new o({stringRepresentation:" or ",type:"typeOr",code:-186,softKeyPadLabel:""}),o.PLUSMINUS=new o({stringRepresentation:"±",type:"typePlusMinus",code:177}),o.PLUS=new o({stringRepresentation:"+",type:"typePlus",code:43}),o.MINUS=new o({stringRepresentation:"-",type:"typeMinus",code:8211}),o.MULTIPLICATION=new o({stringRepresentation:"*",type:"typeMulti",code:215}),o.DIVISION=new o({stringRepresentation:"/",type:"typeDivision",code:247}),o.LT=new o({stringRepresentation:"<",type:"typeLT",code:60}),o.LE=new o({stringRepresentation:"≤",type:"typeLE",code:8804}),o.EQ=new o({stringRepresentation:"=",type:"typeEQ",code:61}),o.GT=new o({stringRepresentation:">",type:"typeGT",code:62}),o.GE=new o({stringRepresentation:"≥",type:"typeGE",code:8805}),o.PI=new o({stringRepresentation:"π",type:"typePI",code:960}),o.getKey=function(n,e){void 0===e&&(e=["stringRepresentation","softKeyPadLabel"]);var t=o.specialKeys().filter(function(t){return e.some(function(e){return t[e]==n})});return 1==t.length?t[0]:(1<t.length&&DBLLog.log("DBLSpecialKeys has many keys with this property value.",DBLLog.ERROR),null)},o})()),DBLStateManager,comp,DBLTextInput=((e=>{var o,c={},s="public/v1/users/USERID/properties",t=(n.prototype.hasGets=function(){return 0<this.gets.length},n.prototype.hasPuts=function(){return 0<Object.keys(this.puts).length},n.prototype.isNoop=function(){return!this.hasGets()&&!this.hasPuts()},n.prototype.cancel=function(){this.callback=void 0},n);function n(e,t,n){this.gets=e,this.puts=t,this.callback=n}var r=[],i={},u=void 0,a=[];function l(){r=[],i={},u=void 0,a=[],c={},m.resetMockServerData()}function d(){if(u)DBLLog.log("Queuing sync request",DBLLog.INFO);else{for(var e=void 0;(e=a.shift())&&e.isNoop();)DBLLog.log("Skipping no-op sync",DBLLog.INFO),e.callback&&e.callback(!0);e&&(u=e,DBLLog.log("Requesting sync, ".concat(a.length," remain in queue"),DBLLog.INFO),o=!serverURL||rootParams.lesson?new m:new f(authSession,clientInstance),e.hasPuts()?o.put(e.puts,p,g):p())}}function p(e,t){assert(!!u,"onPutComplete called with no inflight op!"),assert(!!o,"onPutComplete called with no server interface!");var n=u;n.hasGets()?o.get(n.gets,h,g):h(0,null)}function h(e,t){assert(!!u,"onGetComplete called with no inflight op!");var n=u;if(u=void 0,n.hasGets())try{for(var o=JSON.parse(t).properties,r=0,i=n.gets;r<i.length;r++){var a=i[r],s=o[a.replace("Property.","")],l=s?JSON.parse(s):void 0;c[a]=l}}catch(e){DBLLog.log("corrupt state manager return",DBLLog.FATAL,DBLError.STATE_DATA_CORRUPT)}n.callback&&n.callback(!0),d()}function g(e,t){assert(!!u,"onSyncFailed called with no inflight op!");var n=u,o=(u=void 0,DBLError.TROUBLE_COMMUNICATING);if(400<=e&&e<=499)try{var r=JSON.parse(t);r&&r.errorCode&&(o=r.errorCode)}catch(e){}o==DBLError.TROUBLE_COMMUNICATING?++__retryServerRequestCount<=(__retryServerRequests?3:0)?setTimeout(function(){DBLLog.log(s+" load failure - retry "+__retryServerRequestCount,DBLLog.INFO),a.unshift(n),d()},1e3*__retryServerRequestCount*__retryServerRequestCount):DBLLog.log("".concat(s," was unreachable: ").concat(e," (after ").concat(__retryServerRequestCount," attempt(s))"),DBLLog.FATAL,o):DBLLog.log(s+" was unreachable: "+e,DBLLog.FATAL,o)}e.cleanup=function(){l(),o&&(o.abort(),o=void 0)},e.clear=l,e.requestProperty=function(e){r.push(e)},e.setProperty=function(e,t){DBLLog.log("setProperty(".concat(e,") -> ").concat(JSON.stringify(t),")"),DBLLog.INFO),assert("string"==typeof e,"bad key"),c[e]=t,i[e]=t},e.getProperty=function(e){var t=c[e];return DBLLog.log("getProperty(".concat(e,") -> ").concat(JSON.stringify(t)),DBLLog.INFO),t},e.syncProperties=function(e){return e=new t(r,i,e),a.push(e),r=[],i={},d(),e},e.cancelAllSyncs=function(e){for(var t=(u?1:0)+(a||[]).length,n=(DBLLog.log("Canceling all ".concat(t," requested SyncOps"),DBLLog.INFO),void 0),o=0,r=__spreadArray([u],a,!0);o<r.length;o++)null!=(n=r[o])&&n.cancel();n?n.callback=e:e&&e()},e.getSequenceCache=function(){return c},e.setSequenceCache=function(e){c=e},_.prototype.abort=function(){this.xhr&&(this.xhr.onreadystatechange=null,this.xhr.abort(),this.xhr=null)},_.prototype.put=function(e,t,n){var o,r=serverURL+s.replace("USERID",__studentId),i={};for(o in e)i[o.replace("Property.","")]=JSON.stringify(e[o]);var a=JSON.stringify({properties:i});this.makeRequest("PATCH",r,a,t,n)},_.prototype.get=function(e,t,n){var o=serverURL+s.replace("USERID",__studentId),e=e.map(function(e){return"key=".concat(e.replace("Property.",""))});IE&&e.push("time=".concat((new Date).getTime())),this.makeRequest("GET","".concat(o,"?").concat(e.join("&")),null,t,n)},_.prototype.makeRequest=function(e,t,n,o,r){var i=this;assert(!this.xhr,"UserPropsAPI.makeRequest(".concat(e,", ").concat(t,") called with an already initialized xhr")),this.xhr=new XMLHttpRequest,this.xhr.open(e,t,!0),this.xhr.setRequestHeader("Content-type","application/json"),this.xhr.setRequestHeader("DBL-AuthSessionUuid",this.authSession),this.clientInstance&&this.xhr.setRequestHeader("DBL-ClientInstanceUuid",this.clientInstance),this.xhr.setRequestHeader("DBL-ClientRequestUuid",uuidv4()),this.xhr.onreadystatechange=function(){try{var e,t;4==i.xhr.readyState&&(e=i.xhr.status,t=i.xhr.response,i.xhr=null,200<=e&&e<300?o(e,t):0!=e&&r(e,t))}catch(e){throw dblRecordError(e),e}},this.xhr.onerror=function(){i.xhr=null;try{r(0,null)}catch(e){throw dblRecordError(e),e}},n?this.xhr.send(n):this.xhr.send()};var f=_;function _(e,t){this.authSession=e,this.clientInstance=t,this.xhr=void 0}y.resetMockServerData=function(){y.mockServer=void 0},y.prototype.getMockServer=function(){return y.mockServer=void 0===y.mockServer?JSON.parse(JSON.stringify(__stateFile?objectFromFQN(__stateFile):{})):y.mockServer},y.prototype.abort=function(){this.handle&&(clearTimeout(this.handle),this.handle=void 0)},y.prototype.put=function(o,r,i){var a=this;DBLLog.log("Mocking PATCH with ".concat(JSON.stringify(o),"..."),DBLLog.INFO),this.handle=setTimeout(function(){a.handle=void 0;var e=parseInt(rootParams.flakyserver||"0",10);if(100*Math.random()<e)i(0,null);else{var t,n=a.getMockServer();for(t in o)n[t]=n[t]||{},n[t].value=o[t];r(204,null)}},rootParams.slowserver?3e3:1)},y.prototype.get=function(a,s,l){var c=this;DBLLog.log("Mocking GET with ".concat(a.join(", ")),DBLLog.INFO),this.handle=setTimeout(function(){c.handle=void 0;var e=parseInt(rootParams.flakyserver||"0",10);if(100*Math.random()<e)l(0,null);else{for(var t=c.getMockServer(),n={},o=0,r=a;o<r.length;o++){var i=r[o];t.hasOwnProperty(i)&&(n[i.replace("Property.","")]=JSON.stringify(t[i].value))}s(200,JSON.stringify({properties:n}))}},rootParams.slowserver?3e3:1)},y.mockServer=void 0;var m=y;function y(){this.handle=void 0}})(DBLStateManager=DBLStateManager||{}),(e=>{function o(e,t){if(e)switch(t.type){case"click":DBLAutomation.recordClick(e,t.location,t.value);break;case"drag-start":DBLAutomation.recordDrag(e,DBLAutomation.START,t.value,t.relation,t.location);break;case"drag-drop":DBLAutomation.recordDrag(e,DBLAutomation.DROP,t.value,t.relation,t.location);break;case"drag-cancel":DBLAutomation.recordDrag(e,DBLAutomation.CANCELED,t.value,t.relation,t.location);break;case"edit":DBLAutomation.recordEdit(e,t.value,t.location);break;case"mouse":var n=t.value;DBLAutomation.recordMouse(e,n.event,n.x,n.y);break;case"highlight":DBLAutomation.recordHighlight(e,""+t.value);break;default:throw"Unsupported action type for action ".concat(JSON.stringify(t))}}t=createjs.Container,__extends(r,t),r.prototype.recordHighlight=function(e){o(this,__assign({type:"highlight"},e||{}))};var t,n=r;function r(){return null!==t&&t.apply(this,arguments)||this}e.DisplayObject=n,__extends(a,i=n),Object.defineProperty(a.prototype,"automationComponent",{get:function(){return this._automationComponent},set:function(e){this._automationComponent=e},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"automationLocation",{get:function(){return this._automationLocation},set:function(e){this._automationLocation=e},enumerable:!1,configurable:!0}),a.prototype.handleAction=function(e){var t,n=!0;switch(n&&replayMode&&this.setupForSnapshot&&(t=this.setupForSnapshot(e))&&(t.before(),takePendingSnapshot(),t.after()),e.type){case"drag-start":if(!this.handleDragStart)throw"Trying to process handle(".concat(JSON.stringify(e),"), but handleDragStart not implemented on ").concat(this.name);n=this.handleDragStart(e.value,e.location);break;case"drag-drop":if(!this.handleDragDrop)throw"Trying to process handle(".concat(JSON.stringify(e),"), but handleDragDrop not implemented on ").concat(this.name);n=this.handleDragDrop(e.value,e.location);break;case"drag-cancel":if(!this.handleDragCancel)throw"Trying to process handle(".concat(JSON.stringify(e),"), but handleDragCancel not implemented on ").concat(this.name);n=this.handleDragCancel(e.value,e.location);break;case"mouse":if(!this.handleMouse)throw"Trying to process handle(".concat(JSON.stringify(e),"), but handleMouse not implemented on ").concat(this.name);n=this.handleMouse(e.value);break;case"edit":if(!this.handleEdit)throw"Trying to process handle(".concat(JSON.stringify(e),"), but handleEdit not implemented on ").concat(this.name);n=this.handleEdit(e.value,e.location);break;case"click":if(!this.handleClick)throw"Trying to process handle(".concat(JSON.stringify(e),"), but handleClick not implemented on ").concat(this.name);n=this.handleClick(e.value,e.location);break;default:throw"Unsupported action type for action ".concat(JSON.stringify(e))}return n},Object.defineProperty(a.prototype,"currentComponent",{get:function(){var e;return this._automationComponent||(this instanceof p?this:(e=this.getParentInteractiveObject())?e.currentComponent:null)},enumerable:!1,configurable:!0}),a.prototype.getParentInteractiveObject=function(){for(var e=this.parent;e&&!(e instanceof a);)e=e.parent;return e},a.prototype.triggerAction=function(e){var t=this;for("drag-cancel"!=e.type||e.location||(e.location=this._dragStartLocation);t.handlerObject;){var n=t.handlerObject(e);if(null==n||n==t)break;t=n}return void 0!==t._automationLocation&&(e.location="function"==typeof t._automationLocation?t._automationLocation():t._automationLocation),o(t._automationComponent||this.currentComponent,e),t.handleAction(e)},a.prototype.playbackClick=function(e,t){return this.triggerClick({location:e,value:t})},a.prototype.playbackDrag=function(e,t,n,o){switch(e){case DBLAutomation.START:return this.triggerDragStart({location:o,value:t,relation:n});case DBLAutomation.DROP:return this.triggerDragDrop({location:o,value:t,relation:n});case DBLAutomation.CANCELED:return this.triggerDragCancel({location:o,value:t,relation:n});default:return!1}},a.prototype.playbackEdit=function(e,t){return this.triggerEdit({location:t,value:e})},a.prototype.playbackMouse=function(e,t,n){return this.triggerMouse({x:t,y:n,event:e})};var i,n=a;function a(e){var t=i.call(this)||this;return t.triggerClick=function(e){return t.triggerAction(__assign({type:"click"},e||{}))},t.triggerEdit=function(e){return t.triggerAction(__assign({type:"edit"},e||{}))},t.triggerDragStart=function(e){return t._dragStartLocation=e&&e.location,t.triggerAction(__assign({type:"drag-start"},e||{}))},t.triggerDragDrop=function(e){return t.triggerAction(__assign({type:"drag-drop"},e||{}))},t.triggerDragCancel=function(e){return t.triggerAction(__assign({type:"drag-cancel"},e||{}))},t.triggerMouse=function(e){return t.triggerAction(__assign({type:"edit"},e))},t._automationComponent=e&&e.component,t._automationLocation=e&&e.location,t}function s(t,e){return void 0===t&&(t=[]),(e=void 0===e?lessonStage:e)instanceof c?t.push(e):e instanceof createjs.Container&&null!=(e=e.children)&&e.forEach(function(e){return s(t,e)}),t}e.InteractiveObject=n,__extends(u,l=n),Object.defineProperty(u.prototype,"dragEnabled",{get:function(){return this.mouseEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"dropEnabled",{get:function(){return this.mouseEnabled},enumerable:!1,configurable:!0}),u.prototype.containsPoint=function(e){var t;return null==(t=this.getBounds())?void 0:t.contains(e.x,e.y)},u.prototype.handleDragDrop=function(e){var t=null==e?void 0:e.toLocation;return t?!!(e=s().filter(function(e){return e.automationLocation==t})).length&&this.onDragDrop(e[0]):this.onDragDrop(null)};var l,c=u;function u(){var n,o,e=l.call(this)||this;return e.supportTapDrag=!0,n=e,DBLDragHandler.addDragHandlers(n,{canDrag:function(e){return!c.DRAG_PROXY&&n.dragEnabled},onStart:function(e){return c.DRAG_PROXY=n,o=s(),n.triggerDragStart({location:n.automationLocation,relation:"at",value:{x:Math.round(e.localX),y:Math.round(e.localY)}})},onMove:function(e){n.onDragMove(e)},onStop:function(t){var e=o.filter(function(e){return e.dropEnabled}).filter(function(e){return e.acceptDragDrop(n)}).filter(function(e){return e.containsPoint(e.globalToLocal(t.stageX,t.stageY))})[0];n.triggerDragDrop({value:{toLocation:null==e?void 0:e.automationLocation},relation:"at"}),c.DRAG_PROXY=void 0}}),e}e.DragDropObject=c,__extends(h,d=n);var d,p=h;function h(){return null!==d&&d.apply(this,arguments)||this}e.InteractiveComponent=p})(comp=comp||{}),(p=>{function h(e,t,n,o,r,i,a,s,l,c,u){void 0===a&&(a=-1),void 0===s&&(s=h.RESTRICTED),void 0===l&&(l=null),void 0===c&&(c=0),void 0===u&&(u=0);var d=p.call(this)||this;return d._fixTextBaseline=!1,d._enabled=!0,d._focused=!1,d._autoSelect=!1,d._defocusOnEnter=!0,d._changeHandled=!1,d._aX=[],d._leftRightMargin=0,d._topBottomMargin=0,d._background=null,d._backgroundApplyFocused=!0,d._focusOnClick=!0,d.TICK="_tick",d._reserveOperatorSpace=!1,d.tabSupport=!1,d.tabContainer=null,d.bgFrameLabels={focused:"Focus",notFocused:"NotFocus",disabled:"Disabled",highlighted:"Highlight",correct:"Correct",incorrect:"Incorrect",incorrectEdit:"IncorrectEdit"},d._width=e,d._height=t,d._font=n,d._fontSize=o,d._textAlign=r,d._color=i,d._maxChars=a,d._inputType=s,d._leftRightMargin=c,d._topBottomMargin=u,d.useDOM&&(c||u)&&assert(!1,"no margin with DOM"),d._currentValue="",d._restrictChars=[],l&&d.setRestrict(l),d._displayText=new createjs.Text(d._currentValue,DBLFont.getFontString(d._font,d._fontSize),d._color),d._displayText.textAlign=d._textAlign,d.adjustY(),d._focusOnClick||(d._displayText.mouseEnabled=!1),d.useDOM&&(d._htmlInput=d.createInputFieldInDOM(),d._domElement=new createjs.DOMElement(d._htmlInput),d._domElement.name="DOMelement",d.addChild(d._domElement)),d._displayText.name="text",d.addChild(d._displayText),d.styleInputField(),d.updateMaxChars(),d.hideInputField(),d.positionText(),d.updateBoundsAndMask(),d._focusOnClick&&(d._displayText.addEventListener("mousedown",d.handleCaretMouseDown.bind(d)),d._displayText.addEventListener("pressmove",d.handleCaretPressMove.bind(d)),d._displayText.addEventListener("mouseover",d.handleMouseOver.bind(d)),d._displayText.addEventListener("mouseout",d.handleMouseOut.bind(d))),d.addEventListener("removed",d.handleRemovedFromStage.bind(d)),DBLTextInputFocusManager.registerTextInput(d),d}return __extends(h,p),Object.defineProperty(h.prototype,"reserveOperatorSpace",{get:function(){return this._reserveOperatorSpace},set:function(e){this._reserveOperatorSpace=e},enumerable:!1,configurable:!0}),h.prototype.getReplaceValues=function(){return this._replaceValues},h.prototype.setReplaceValues=function(e){this._replaceValues=e},Object.defineProperty(h.prototype,"fixTextBaseline",{get:function(){return this._fixTextBaseline},set:function(e){this._fixTextBaseline=e,this.adjustY()},enumerable:!1,configurable:!0}),h.prototype.getTextObject=function(){return this._displayText},h.prototype.setBackground=function(e){this._background=e,this._background&&((e=this._background.nominalBounds)&&this._background.setBounds(e.x,e.y,e.width,e.height),this.updateBackground(this.bgFrameLabels.notFocused))},h.prototype.setBackgroundState=function(e,t){this.bgFrameLabels.notFocused=e,this._backgroundApplyFocused=!t,this.updateBackground(e)},Object.defineProperty(h.prototype,"leftRightMargin",{get:function(){return this._leftRightMargin},set:function(e){this._leftRightMargin=e,this.positionText()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"topBottomMargin",{get:function(){return this._topBottomMargin},set:function(e){this._topBottomMargin=e,this.adjustY()},enumerable:!1,configurable:!0}),h.prototype.handleRemovedFromStage=function(e){this.focus(!1)},h.prototype.cleanup=function(){this.focus(!1),this.removeAllEventListeners(),this.removeAllChildren(),this._htmlInput&&(this._htmlInput.parentElement&&document.getElementById("htmlcontent").removeChild(this._htmlInput),this._htmlInput.onclick=null,this._htmlInput.onkeydown=null,this._htmlInput.onkeypress=null,this._htmlInput.oninput=null,this._htmlInput.onkeyup=null,this._htmlInput.onblur=null,this._htmlInput.oncut=null,this._htmlInput.oncopy=null,this._htmlInput.onpaste=null,this._htmlInput=null),this._domElement&&(this._domElement.htmlElement=null,this._domElement=null),this._documentKeyDownHandler&&document.removeEventListener("keydown",this._documentKeyDownHandler),this._restrictFunction=null,DBLTextInputFocusManager.unregisterTextInput(this),this.cleanupBlinkTimer(),this._displayText.removeAllEventListeners("mousedown"),this._displayText.removeAllEventListeners("pressmove"),this._displayText.removeAllEventListeners("mouseover"),this._displayText.removeAllEventListeners("mouseout"),this.tabContainer=null},h.prototype.tick=function(){this._domElement&&this._domElement[this.TICK]()},Object.defineProperty(h.prototype,"useDOM",{get:function(){return this._inputType!=h.RESTRICTED&&this._inputType!=h.KEYBOARDLESS},enumerable:!1,configurable:!0}),h.prototype.createInputFieldInDOM=function(){var e=document.createElement("input"),t=this._inputType==h.EMAIL||this._inputType==h.PASSWORD||this._inputType==h.USERID||"schoolcode"==this._inputType||this._inputType==h.CLASSROOMCODE,n=this._inputType;if(n=n!=h.RESTRICTED&&n!=h.KEYBOARDLESS&&n!=h.USERID&&n!=h.SCHOOLCODE&&n!=h.CLASSROOMCODE?n:void 0)try{e.type=n}catch(e){}return e.id="textInput"+h.getNextId(),e.setAttribute("autocomplete","off"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false"),document.getElementById("htmlcontent").appendChild(e),e.onclick=this.handleInputClick.bind(this),e.onkeydown=this.handleKeyDownNew.bind(this),e.oninput=this.handleInputNew.bind(this),e.onkeyup=this.handleKeyUpNew.bind(this),e.onblur=this.handleInputBlur.bind(this),t?(e.oncut=this.handleCutPaste.bind(this),e.onpaste=this.handleCutPaste.bind(this)):(e.oncut=this.denyCutCopyPaste.bind(this),e.oncopy=this.denyCutCopyPaste.bind(this),e.onpaste=this.denyCutCopyPaste.bind(this)),e},h.prototype.styleInputField=function(){this._htmlInput&&(this._htmlInput.style.width=this._width+"px",this._htmlInput.style.position="absolute",this._htmlInput.style.pointerEvents="auto",this._htmlInput.style.top="0px",this._htmlInput.style.left="0px",this._htmlInput.style.padding="0px",this._htmlInput.style.border="none",this._htmlInput.style.outline="none",this._htmlInput.style.font=DBLFont.getFontString(this._font,this._fontSize),this._htmlInput.style.color=this._color,this._htmlInput.style.textAlign=this._textAlign,this._htmlInput.style.backgroundColor="rgba(0,0,0,0)",this._htmlInput.style["line-height"]=DBLFont.getFontEmString(this._font),this._htmlInput.style["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",this._htmlInput.style["-webkit-tap-highlight-color"]="transparent")},h.prototype.updateMaxChars=function(){this._htmlInput&&(0<this._maxChars?this._htmlInput.maxLength=this._maxChars:this._htmlInput.maxLength=524288)},h.prototype.updateBoundsAndMask=function(){this.setBounds(0,0,this._width,this._height),this.useDOM||(this._textHitArea=new createjs.Shape,this._textHitArea.graphics.clear(),this._textHitArea.graphics.beginFill("#000"),this._textHitArea.graphics.drawRect(0,0,this._width,this._height),this._textHitArea.graphics.endFill(),this._textHitArea.x=-this._displayText.x,this._textHitArea.y=-this._displayText.y,this._displayText.hitArea=this._textHitArea)},h.prototype.positionText=function(){"center"==this._textAlign?this._displayText.x=this._width/2:"right"==this._textAlign?this._displayText.x=this._width-this._leftRightMargin:this._displayText.x=this._leftRightMargin,0<this._topBottomMargin&&this.adjustY()},Object.defineProperty(h.prototype,"enabled",{get:function(){return this._enabled},set:function(e){(this._enabled=e)||this.focus(!1)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"autoSelect",{get:function(){return this._autoSelect},set:function(e){this._autoSelect=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"type",{get:function(){return this._inputType},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"text",{get:function(){return this._currentValue},set:function(e){var t=this._currentValue;this.setCurrentValue(e),this._currentValue!=t&&(this.useDOM||this.moveCaretToTheEnd(),this.dispatchChanged())},enumerable:!1,configurable:!0}),h.prototype.dispatchChanged=function(){this.dispatchEvent(new DBLTextInputEvent(DBLTextInputEvent.CHANGE))},h.prototype.moveCaretToTheEnd=function(){this._caretPos=this._displayText.text.length,this._selectionStartPos=-1,this._selectionEndPos=-1},Object.defineProperty(h.prototype,"value",{get:function(){return this.text},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"selectionStart",{get:function(){return this.useDOM?this._htmlInput.selectionStart:-1!=this._selectionStartPos?this._selectionStartPos:this._caretPos},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"selectionEnd",{get:function(){return this.useDOM?this._htmlInput.selectionEnd:-1!=this._selectionEndPos?this._selectionEndPos:this._caretPos},enumerable:!1,configurable:!0}),h.prototype.getMeasuredWidth=function(){return this._displayText.getMeasuredWidth()},h.prototype.getMeasuredHeight=function(){return this._displayText.getMeasuredHeight()},Object.defineProperty(h.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this.styleInputField(),this.positionText(),this.updateBoundsAndMask()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this.styleInputField(),this.positionText(),this.updateBoundsAndMask()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize=e,this._displayText.font=DBLFont.getFontString(this._font,e),this.updateTextPositionAndBounds()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight=e,this._displayText.font=DBLFont.getFontString(this._font,this._fontSize,e),this.updateTextPositionAndBounds()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"font",{get:function(){return this._font},enumerable:!1,configurable:!0}),h.prototype.updateTextPositionAndBounds=function(){this.adjustY(),this._aXLast="",this.styleInputField(),this.updateBoundsAndMask(),this.positionText(),this.updateCharacterBounds()},h.prototype.adjustY=function(){var e,t;this._fixTextBaseline?DBLFont.fixTextFields(this._displayText):0==this._topBottomMargin?(this._displayText.textBaseline="alphabetic",this._displayText.y=this._displayText.getMeasuredHeight()):(this._displayText.textBaseline="top",e=this._topBottomMargin?this._height-this._displayText.getMeasuredHeight()-2*this._topBottomMargin:0,t=.1*this._displayText.getMeasuredHeight(),this._displayText.y=this._topBottomMargin+e/2+t)},Object.defineProperty(h.prototype,"textAlign",{get:function(){return this._textAlign},set:function(e){this._textAlign=e,this._displayText.textAlign=e,this.styleInputField(),this.positionText()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,this._displayText.color=e,this.styleInputField()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"maxChars",{get:function(){return this._maxChars},set:function(e){this._maxChars=e,this.updateMaxChars()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"focused",{get:function(){return this._focused},set:function(e){DBLLog.log("Do not set the value of DBLTextInput.focused directly, use DBLTextInput.focus() instead.",DBLLog.ERROR)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"defocusOnEnter",{get:function(){return this._defocusOnEnter},set:function(e){this._defocusOnEnter=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"focusOnClick",{get:function(){return this._focusOnClick},set:function(e){this._focusOnClick=e},enumerable:!1,configurable:!0}),h.prototype.blur=function(e){void 0===e&&(e=null),!this._focused||!this.useDOM&&e&&(e=this.globalToLocal(e.stageX/dblDevicePixelRatio,e.stageY/dblDevicePixelRatio),new createjs.Rectangle(0,0,this._width,this._height).contains(e.x,e.y))||this.focus(!1)},h.prototype.focus=function(e){for(var t=this.visible,n=this;t&&n.parent;)t=(n=n.parent).visible;e&&!this.visible||e&&!this.stage||e&&!t||e&&!this._enabled||(e&&!interactive&&this.stage==lessonStage?((DBLTextInputFocusManager.__deferredFocus=this)._backgroundApplyFocused&&this.updateBackground(this.bgFrameLabels.focused),DBLTextInputFocusManager.deferredFocusIn(this),this.dispatchEvent(new DBLTextInputEvent(DBLTextInputEvent.DEFERRED_FOCUS_IN))):(e||DBLTextInputFocusManager.__deferredFocus!=this||(DBLTextInputFocusManager.__deferredFocus=void 0),e&&!this.accessible&&a11y.clearFocus(),e&&!this._focused?(blur(),this._focused=e,this.useDOM?this.focusInputField():this._autoSelect?this.select():(this._caretPos=this._displayText.text.length,this._selectionStartPos=-1,this._selectionEndPos=-1,this.showFakeCaret(!0)),this._backgroundApplyFocused&&this.updateBackground(this.bgFrameLabels.focused),DBLTextInputFocusManager.focusIn(this),this.dispatchEvent(new DBLTextInputEvent(DBLTextInputEvent.FOCUS_IN))):!e&&this._focused&&(this._focused=e,this.useDOM?(this._changeHandled||this.updateAndDispatchChange(),this.blurInputField(),this.hideInputField()):this.showFakeCaret(!1),this.updateBackground(this.bgFrameLabels.notFocused),DBLTextInputFocusManager.focusOut(this),this.dispatchEvent(new DBLTextInputEvent(DBLTextInputEvent.FOCUS_OUT)))))},h.prototype.select=function(){if(this._focused)if(this.useDOM)try{this._htmlInput.select()}catch(e){}else 0==this._displayText.text.length?(this._caretPos=0,this._selectionStartPos=-1,this._selectionEndPos=-1):(this._caretPos=-1,this._selectionStartPos=0,this._selectionEndPos=this._displayText.text.length),this.showFakeCaret(!0)},h.prototype.setSelection=function(e,t){if(this._focused)if(this.useDOM)try{this._htmlInput.setSelectionRange(e,t)}catch(e){}else e==t?(this._caretPos=e,this._selectionStartPos=-1,this._selectionEndPos=-1):(assert(0==e&&t==this._displayText.text.length),this._caretPos=-1,this._selectionStartPos=e,this._selectionEndPos=t),this.showFakeCaret(!0)},h.prototype.clearText=function(){this.setCurrentValue("")},h.prototype.updateCaret=function(){var e;this._caret&&(e=this.getTextBounds(),this.updateCharacterBounds(),this._caret.x=this._displayText.x+e.x+this._aX[this._caretPos])},h.prototype.setCurrentValue=function(e){this._currentValue=e.toString(),this._displayText.text=this.passwordFilter(this._currentValue),this.updateCaret(),this._htmlInput&&(this._htmlInput.value=this._currentValue)},Object.defineProperty(h.prototype,"caretPos",{get:function(){return this._caretPos},set:function(e){this._caretPos=e,this.updateCaret()},enumerable:!1,configurable:!0}),h.prototype.handleKeyDownNew=function(e){this._changeHandled=!1,this._valueOnKeyDown=this.useDOM?this._htmlInput.value:this._displayText.text},h.prototype.handleInputNew=function(e){var t=this.useDOM?this._htmlInput.value:this._displayText.text;if("string"==typeof this._valueOnKeyDown){for(var n=[],o=0;o<t.length;o++)t[o]!==this._valueOnKeyDown[o]&&n.push(t[o]);var r,i=n.join("");this.useDOM?this._htmlInput.value=this._valueOnKeyDown:this._displayText.text=this._valueOnKeyDown,i?((r=new DBLTextInputEvent(DBLTextInputEvent.KEY_PRESS_PENDING)).keyPressed=i,this.dispatchEvent(r),r.defaultPrevented||(this.checkRestricted(i)?e.preventDefault():this.useDOM?this._htmlInput.value=t:this._displayText.text=t,this.dispatchKeyPressed(i))):this.useDOM?this._htmlInput.value=t:this._displayText.text=t}},h.prototype.handleKeyUpNew=function(e){var t;this._valueOnKeyDown=null,this._changeHandled||this.updateAndDispatchChange(),e.keyCode!=h.ENTER_CODE&&e.keyCode!=h.TAB_CODE||((t=new DBLTextInputEvent(DBLTextInputEvent.KEY_PRESSED)).keyPressed=e.keyCode==h.ENTER_CODE?DBLTextInputEvent.ENTER_KEY:DBLTextInputEvent.TAB_KEY,this._defocusOnEnter&&blur(),this.dispatchEvent(t))},h.prototype.handleInputBlur=function(e){this._changeHandled||this.updateAndDispatchChange()},h.prototype.updateAndDispatchChange=function(){this._changeHandled=!0;var e=this.useDOM?this._htmlInput.value:this._displayText.text;this._currentValue!=e&&(this.automationComponent?this.triggerEdit({value:e}):this.handleEdit(e))},h.prototype.passwordFilter=function(e){if("password"!=this._inputType)return e;for(var t="",n=0;n<e.length;n++)t+="•";return t},h.prototype.handleEdit=function(e){var t=this._currentValue!=e;return t&&(this._currentValue=e,this._displayText.text=this.passwordFilter(this._currentValue),replayMode&&(this.moveCaretToTheEnd(),this.updateCaret()),t)&&this.dispatchChanged(),t},Object.defineProperty(h.prototype,"currentComponent",{get:function(){return this.automationComponent},enumerable:!1,configurable:!0}),h.prototype.handleCutPaste=function(e){this._changeHandled=!1},h.prototype.denyCutCopyPaste=function(e){e.preventDefault()},h.prototype.handleInputClick=function(e){if(this._autoSelect)try{e.target.select()}catch(e){}},h.prototype.focusInputField=function(){this.showInputField();try{this._htmlInput.focus()}catch(e){}var e;this._autoSelect?this.select():"left"==this._textAlign?this.setSelection(0,0):(e=this._htmlInput.value.length,this.setSelection(e,e))},h.prototype.blurInputField=function(){try{this._htmlInput.blur()}catch(e){}},h.prototype.showInputField=function(){this._htmlInput&&(this._htmlInput.style.display="block",this._displayText.visible=!1)},h.prototype.hideInputField=function(){this._htmlInput&&(this._htmlInput.style.display="none",this._displayText.visible=!0)},h.prototype.updateBackground=function(t){this._background&&this._background.timeline&&this._background.timeline.getLabels().some(function(e){return e.label==t})&&this._background.gotoAndStop(t)},Object.defineProperty(h.prototype,"restrictKeys",{get:function(){return this._restrictKeysStr||this._restrictStr},set:function(e){this._restrictKeysStr=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"restrict",{get:function(){return this._restrictStr},set:function(e){this.setRestrict(e)},enumerable:!1,configurable:!0}),h.prototype.setRestrict=function(e){if(!1===rootParams.softtabkey&&(e=e.replace("\t","")),this._restrictStr=e,this._restrictChars=[],""!=e){var t=e.match(/\w\-\w/g);if(null!=t){e=e.replace(/\w\-\w/g,"");for(var n=0;n<t.length;n++)this._restrictChars=this._restrictChars.concat(this.expandCharacterRange(t[n]))}e=e.replace(/\\(.)/g,"$1"),this._restrictChars=this._restrictChars.concat(e.split(""))}},h.prototype.expandCharacterRange=function(e){if(3!=e.length)return[];for(var t=e.charCodeAt(0),n=e.charCodeAt(2),o=(n<t&&(e=n,n=t,t=e),[]),r=t;r<=n;r++)o.push(String.fromCharCode(r));return o},Object.defineProperty(h.prototype,"restrictArray",{get:function(){return this._restrictArray},set:function(e){this._restrictArray=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"keyPadLayoutOptions",{get:function(){return this._keyPadLayoutOptions},set:function(e){this._keyPadLayoutOptions=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"restrictFunction",{get:function(){return this._restrictFunction},set:function(e){this._restrictFunction=e},enumerable:!1,configurable:!0}),h.prototype.restrictNumeric=function(e){var t=!1,n=this.text,o=n.charAt(0);return"-"==e&&(0!=this.selectionStart||0<=n.indexOf("-"))&&(t=!0),t=0==this.selectionStart&&"-"==o?!0:t},h.prototype.useNumericRestrictFunction=function(){this.restrictFunction=this.restrictNumeric},h.getNextId=function(){return this._id++},h.prototype.checkRestricted=function(e){var t=!1;if(0<this._restrictChars.length)for(var t=!0,n=0;n<this._restrictChars.length;n++)if(e==this._restrictChars[n]){t=!1;break}return t=!t&&this._restrictFunction?this._restrictFunction(e):t},h.prototype.showFakeCaret=function(e){var t;this._selection&&(this.removeChild(this._selection),this._displayText.color=this._color,this._selection=null,this._focusOnClick||(this._displayText.removeAllEventListeners("mousedown"),this._displayText.removeAllEventListeners("pressmove"),this._displayText.mouseEnabled=!1)),this._caret&&(this.removeChild(this._caret),this._caret=null,this.cleanupBlinkTimer(),this._focusOnClick||(this._displayText.removeAllEventListeners("mousedown"),this._displayText.removeAllEventListeners("pressmove"),this._displayText.mouseEnabled=!1)),this.updateCharacterBounds(),e&&(-1!=this._selectionStartPos?(this._selection=new createjs.Shape,this._selection.graphics.beginFill("#308DFC"),e=Math.max(0,this._selectionStartPos),t=Math.min(this._displayText.text.length,this._selectionEndPos),this._selection.graphics.drawRect(this._aX[e],0,this._aX[t],this._displayText.getMeasuredHeight()),this._selection.graphics.endFill(),this._selection.name="selection",this.addChildAt(this._selection,0),this._selection.x=this._displayText.x+this._displayText.getBounds().x,this._selection.y=this._displayText.y+this._displayText.getBounds().y,this._displayText.color="#ffffff",this._focusOnClick||(this._displayText.addEventListener("mousedown",this.handleCaretMouseDown.bind(this)),this._displayText.addEventListener("pressmove",this.handleCaretPressMove.bind(this)),this._displayText.mouseEnabled=!0)):-1!=this._caretPos&&(this._caret=new createjs.Shape,this._caret.graphics.beginFill("#000000"),this._caret.graphics.drawRect(-1,0,h.CARET_WIDTH,this._displayText.getMeasuredHeight()),this._caret.graphics.endFill(),this._caret.name="caret",this.addChild(this._caret),""==this._displayText.text?(this._displayText.text=" ",this._caret.x=this._displayText.x,this._caret.y=this._displayText.y+this._displayText.getBounds().y,this._displayText.text=""):(this.updateCharacterBounds(),this._caret.x=this._displayText.x+this._displayText.getBounds().x+this._aX[this._caretPos],this._caret.y=this._displayText.y+this._displayText.getBounds().y),this.cleanupBlinkTimer(),this._blinkInterval=setInterval(this.blink.bind(this),500),this._focusOnClick||(this._displayText.addEventListener("mousedown",this.handleCaretMouseDown.bind(this)),this._displayText.addEventListener("pressmove",this.handleCaretPressMove.bind(this)),this._displayText.mouseEnabled=!0)))},h.prototype.blink=function(){this._caret.visible=!this._caret.visible},h.prototype.cleanupBlinkTimer=function(){this._blinkInterval&&clearInterval(this._blinkInterval)},h.prototype.handleKeyDownDocument=function(e){this.useDOM||(this.simulateKeyPressNew(e.key,e.ctrlKey,e.shiftKey,e.metaKey),e.preventDefault())},h.prototype.simulateKeyPress=function(e){var t=DBLSoftKey.getKey(e,["code"]),t=null!=t?t.stringRepresentation:String.fromCharCode(e);e==h.BACKSPACE_CODE&&(t="Backspace"),this.simulateKeyPressNew(t=e==h.TAB_CODE?"Tab":t)},h.prototype.simulateKeyPressNew=function(t,e,n,o){void 0===e&&(e=!1),void 0===n&&(n=!1),void 0===o&&(o=!1),this.showFakeCaret(!1),this._changeHandled=!1;var r,o=this.useDOM?this._htmlInput.value:this._displayText.text;"Backspace"==t?(this._caretPos=Math.max(0,Math.min(o.length,this._caretPos)),0<this._caretPos&&(o=o.substr(0,this._caretPos-1)+o.substr(this._caretPos),this._displayText.text=o,this._caretPos--),this._selectionStartPos=-1,this._selectionEndPos=-1):"Delete"==t?(this._caretPos=Math.max(0,Math.min(o.length,this._caretPos)),r=!1,0==this._selectionStartPos&&this._selectionEndPos==o.length?(r=!(o=""),this._caretPos=0):this._caretPos<o.length&&(o=o.substr(0,this._caretPos)+o.substr(this._caretPos+1),r=!0),r&&(this._displayText.text=o),this._selectionStartPos=-1,this._selectionEndPos=-1):"ArrowLeft"==t||"ArrowRight"==t?("ArrowLeft"==t?this._caretPos--:this._caretPos++,this._caretPos=Math.max(0,Math.min(o.length,this._caretPos)),this._selectionStartPos=-1,this._selectionEndPos=-1):"Home"==t||"End"==t?(this._caretPos="Home"==t?0:o.length,this._selectionStartPos=-1,this._selectionEndPos=-1):"a"==t&&e?(this._caretPos=-1,this._selectionStartPos=0,this._selectionEndPos=o.length):(assert(0!=this._maxChars,"use maxChars -1 and not 0 for unlimited"),!(!this._reserveOperatorSpace&&o.length<this._maxChars||-1==this._maxChars||-1!=this._selectionStartPos||this.checkKeyPressWithReservedSpace(o,t))||((r=new DBLTextInputEvent(DBLTextInputEvent.KEY_PRESS_PENDING)).keyPressed=t,this.dispatchEvent(r),r.defaultPrevented||this.checkRestricted(t))||(this._replaceValues&&0<this._replaceValues.length&&(e=this._replaceValues.filter(function(e){return e.input==t}),t=0<e.length?e[0].replacement:t),-1!=this._selectionStartPos?(r=Math.max(0,this._selectionStartPos),e=Math.min(this._displayText.text.length,this._selectionEndPos),o=o.substr(0,r)+t+o.substr(e),this._displayText.text=o,this._caretPos=r+1,this._selectionStartPos=-1,this._selectionEndPos=-1):(this._caretPos=Math.max(0,Math.min(o.length,this._caretPos)),this._reserveOperatorSpace?o=this.handleKeyPressWithReservedSpace(o,t):(o=o.substr(0,this._caretPos)+t+o.substr(this._caretPos),this._caretPos++),this._displayText.text=o),this.dispatchKeyPressed(t))),t!=DBLTextInputEvent.ENTER_KEY&&t!=DBLTextInputEvent.TAB_KEY||(this.tabSupport?(e=n&&t==DBLTextInputEvent.TAB_KEY,DBLTextInputFocusManager.setInputsContainer(this.tabContainer),r=e?DBLTextInputFocusManager.getPreviousInput():DBLTextInputFocusManager.getNextInput(),DBLTextInputFocusManager.setInputsContainer(null),r&&r.focus(!0)):this._defocusOnEnter&&blur(),this.dispatchKeyPressed(t)),this.updateAndDispatchChange(),this._focused&&this.showFakeCaret(!0)},h.prototype.dispatchKeyPressed=function(e){var t=new DBLTextInputEvent(DBLTextInputEvent.KEY_PRESSED);t.keyPressed=e,this.dispatchEvent(t)},h.prototype.checkKeyPressWithReservedSpace=function(e,t){var n=0<e.length&&isNaN(parseInt(e[0]));return this._reserveOperatorSpace&&(isNaN(parseInt(t))||!n&&e.length<this._maxChars-1||n&&e.length<this._maxChars)},h.prototype.handleKeyPressWithReservedSpace=function(e,t){if(this._reserveOperatorSpace)if(isNaN(parseInt(t)))0<e.length&&isNaN(parseInt(e[0]))?e=t+e.slice(1):(e=t+e,this._caretPos++);else{if(e.length==this._maxChars)return e;(e.length!=this._maxChars-1||!isNaN(parseInt(e[0]))||0==this._caretPos)&&0<e.length&&0==this._caretPos&&isNaN(parseInt(e[0]))||(e=e.substr(0,this._caretPos)+t+e.substr(this._caretPos),this._caretPos++)}return e},h.prototype.updateCharacterBounds=function(){var e=this._displayText.text;if(!this._aXLast||e!=this._aXLast){if(this._aXLast&&e.length==this._aXLast.length+1&&e.substr(0,e.length-1)==this._aXLast)this._aX.push(this._displayText.getBounds().width);else if(this._aXLast&&e.length==this._aXLast.length-1&&e==this._aXLast.substr(0,this._aXLast.length-1))this._aX.pop();else{this._aX=[0];for(var t=1;t<=e.length;t++)this._displayText.text=e.substr(0,t),this._aX.push(this._displayText.getBounds().width)}this._aXLast=e}},h.prototype.handleCaretMouseDown=function(e){this._focusOnClick&&!this._focused&&this._enabled&&this.focus(!0);var t=this.getTextBounds(),n=e.localX-t.x,o=0;for(this.updateCharacterBounds();o+1<this._aX.length&&n>(this._aX[o]+this._aX[o+1])/2;)o++;o!=this._caretPos&&(this._caretPos=o,this._selectionStartPos=-1,this._selectionEndPos=-1,this.showFakeCaret(!1),this._focused)&&this.showFakeCaret(!0)},h.prototype.handleCaretPressMove=function(e){this.handleCaretMouseDown(e)},h.prototype.handleMouseOver=function(e){this._enabled&&DBLCursor.setCursor(DBLCursor.TEXT)},h.prototype.handleMouseOut=function(e){DBLCursor.setCursor(DBLCursor.AUTO)},h.prototype.getTextBounds=function(){var e;return""==this._displayText.text?(this._displayText.text=" ",(e=this._displayText.getBounds()).x=0,e.width=0,this._displayText.text=""):e=this._displayText.getBounds(),e},h.RESTRICTED="restricted",h.KEYBOARDLESS="keyboardless",h.EMAIL="email",h.PASSWORD="password",h.USERID="userid",h.SCHOOLCODE="schoolcode",h.CLASSROOMCODE="classroomcode",h.RESTRICT_DEFAULT="0-9\\-",h.RESTRICT_POSITIVE="0-9",h.ENTER_CODE=13,h.TAB_CODE=9,h.BACKSPACE_CODE=8,h.DELETE_CODE=46,h.ARROW_UP_CODE=38,h.ARROW_DOWN_CODE=40,h.ARROW_LEFT_CODE=37,h.ARROW_RIGHT_CODE=39,h.HOME_CODE=36,h.END_CODE=35,h.A_CODE=65,h.CARET_WIDTH=1,h._id=0,h})(comp.InteractiveObject)),DBLTextInputEvent=(o=>{function e(e,t,n){return o.call(this,e,t=void 0===t?!0:t,n=void 0===n?!0:n)||this}return __extends(e,o),e.prototype.init=function(e){this._keyPressed=e.key,this._shiftKey=e.shiftKey,this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey},Object.defineProperty(e.prototype,"metaKey",{get:function(){return this._metaKey},set:function(e){this._metaKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keyPressed",{get:function(){return this._keyPressed},set:function(e){this._keyPressed=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shiftKey",{get:function(){return this._shiftKey},set:function(e){this._shiftKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"altKey",{get:function(){return this._altKey},set:function(e){this._altKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ctrlKey",{get:function(){return this._ctrlKey},set:function(e){this._ctrlKey=e},enumerable:!1,configurable:!0}),e.FOCUS_IN="focus_in",e.DEFERRED_FOCUS_IN="deferred_focus_in",e.FOCUS_OUT="focus_out",e.CHANGE="change",e.KEY_PRESS_PENDING="key_press_pending",e.KEY_PRESSED="key_pressed",e.CLICK="click",e.ENTER_KEY="Enter",e.TAB_KEY="Tab",e.BACKSPACE_KEY="Backspace",e.DELETE_KEY="Delete",e.SPACE_KEY=" ",e.ARROW_UP_KEY="ArrowUp",e.ARROW_UP_KEY_IE="Up",e.ARROW_DOWN_KEY="ArrowDown",e.ARROW_DOWN_KEY_IE="Down",e.ARROW_LEFT_KEY="ArrowLeft",e.ARROW_LEFT_KEY_IE="Left",e.ARROW_RIGHT_KEY="ArrowRight",e.ARROW_RIGHT_KEY_IE="Right",e})(createjs.Event),DBLTextInputA11y=(p=>{function h(e,t,n,o,r,i,a,s,l,c,u){void 0===a&&(a=-1),void 0===s&&(s=h.RESTRICTED),void 0===l&&(l=null),void 0===c&&(c=0),void 0===u&&(u=0);var d=p.call(this)||this;return d._fixTextBaseline=!1,d._enabled=!0,d._focused=!1,d._autoSelect=!1,d._defocusOnEnter=!0,d._aX=[],d._leftRightMargin=0,d._topBottomMargin=0,d._background=null,d._backgroundApplyFocused=!0,d._focusOnClick=!0,d.TICK="_tick",d._reserveOperatorSpace=!1,d.tabSupport=!1,d.tabContainer=null,d.bgFrameLabels={focused:"Focus",notFocused:"NotFocus",disabled:"Disabled",highlighted:"Highlight",correct:"Correct",incorrect:"Incorrect",incorrectEdit:"IncorrectEdit"},d.onA11yKeyAllowed=function(e){return 1!=e.length||!d.checkRestricted(e)},d.onA11ySelectionChange=function(){var e=a11y.getInputSelection(d);d.setCanvasSelection(e[0],e[1])},d._width=e,d._height=t,d._font=n,d._fontSize=o,d._textAlign=r,d._color=i,d._maxChars=a,d._inputType=s,d._leftRightMargin=c,d._topBottomMargin=u,d._currentValue="",d._restrictChars=[],l&&d.setRestrict(l),d._displayText=new createjs.Text(d._currentValue,DBLFont.getFontString(d._font,d._fontSize),d._color),d._displayText.textAlign=d._textAlign,d.adjustY(),d._focusOnClick||(d._displayText.mouseEnabled=!1),d._displayText.name="text",d.addChild(d._displayText),d.positionText(),d.updateBoundsAndMask(),d._focusOnClick&&(d._displayText.addEventListener("click",d.onViewClick.bind(d)),d._displayText.addEventListener("pressmove",d.handleCaretPressMove.bind(d)),d._displayText.addEventListener("mouseover",d.handleMouseOver.bind(d)),d._displayText.addEventListener("mouseout",d.handleMouseOut.bind(d))),d.addEventListener("removed",d.handleRemovedFromStage.bind(d)),DBLTextInputFocusManager.registerTextInput(d),d}return __extends(h,p),Object.defineProperty(h.prototype,"reserveOperatorSpace",{get:function(){return this._reserveOperatorSpace},set:function(e){this._reserveOperatorSpace=e},enumerable:!1,configurable:!0}),h.prototype.getReplaceValues=function(){return this._replaceValues},h.prototype.setReplaceValues=function(e){this._replaceValues=e},Object.defineProperty(h.prototype,"fixTextBaseline",{get:function(){return this._fixTextBaseline},set:function(e){this._fixTextBaseline=e,this.adjustY()},enumerable:!1,configurable:!0}),h.prototype.getTextObject=function(){return this._displayText},h.prototype.setBackground=function(e){this._background=e,this._background&&((e=this._background.nominalBounds)&&this._background.setBounds(e.x,e.y,e.width,e.height),this.updateBackground(this.bgFrameLabels.notFocused))},h.prototype.setBackgroundState=function(e,t){this.bgFrameLabels.notFocused=e,this._backgroundApplyFocused=!t,this.updateBackground(e)},Object.defineProperty(h.prototype,"leftRightMargin",{get:function(){return this._leftRightMargin},set:function(e){this._leftRightMargin=e,this.positionText()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"topBottomMargin",{get:function(){return this._topBottomMargin},set:function(e){this._topBottomMargin=e,this.adjustY()},enumerable:!1,configurable:!0}),h.prototype.handleRemovedFromStage=function(e){this.doComponentFocus(!1)},h.prototype.cleanup=function(){this.doComponentFocus(!1),this.removeAllEventListeners(),this.removeAllChildren(),this._documentKeyDownHandler&&document.removeEventListener("keydown",this._documentKeyDownHandler),this._restrictFunction=null,DBLTextInputFocusManager.unregisterTextInput(this),this.cleanupBlinkTimer(),this._displayText.removeAllEventListeners("pressmove"),this._displayText.removeAllEventListeners("mouseover"),this._displayText.removeAllEventListeners("mouseout"),this.tabContainer=null},h.prototype.tick=function(){},h.prototype.updateBoundsAndMask=function(){this.setBounds(0,0,this._width,this._height),this._textHitArea=new createjs.Shape,this._textHitArea.graphics.clear(),this._textHitArea.graphics.beginFill("#000"),this._textHitArea.graphics.drawRect(0,0,this._width,this._height),this._textHitArea.graphics.endFill(),this._textHitArea.x=-this._displayText.x,this._textHitArea.y=-this._displayText.y,this._displayText.hitArea=this._textHitArea},h.prototype.positionText=function(){"center"==this._textAlign?this._displayText.x=this._width/2:"right"==this._textAlign?this._displayText.x=this._width-this._leftRightMargin:this._displayText.x=this._leftRightMargin,0<this._topBottomMargin&&this.adjustY()},Object.defineProperty(h.prototype,"enabled",{get:function(){return this._enabled},set:function(e){(this._enabled=e)||this.doComponentFocus(!1)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"autoSelect",{get:function(){return this._autoSelect},set:function(e){this._autoSelect=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"type",{get:function(){return this._inputType},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"text",{get:function(){return this._currentValue},set:function(e){var t=this._currentValue;this.setCurrentValue(e),this._currentValue!=t&&(this.moveCaretToTheEnd(),this.dispatchChanged())},enumerable:!1,configurable:!0}),h.prototype.dispatchChanged=function(){this.dispatchEvent(new DBLTextInputEvent(DBLTextInputEvent.CHANGE))},h.prototype.moveCaretToTheEnd=function(){this._caretPos=this._displayText.text.length,this.updateSelectionFromCanvas(-1,-1)},Object.defineProperty(h.prototype,"value",{get:function(){return this.text},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"selectionStart",{get:function(){return-1!=this._selectionStartPos?this._selectionStartPos:this._caretPos},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"selectionEnd",{get:function(){return-1!=this._selectionEndPos?this._selectionEndPos:this._caretPos},enumerable:!1,configurable:!0}),h.prototype.getMeasuredWidth=function(){return this._displayText.getMeasuredWidth()},h.prototype.getMeasuredHeight=function(){return this._displayText.getMeasuredHeight()},Object.defineProperty(h.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e,this.positionText(),this.updateBoundsAndMask()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e,this.positionText(),this.updateBoundsAndMask()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize=e,this._displayText.font=DBLFont.getFontString(this._font,e),this.updateTextPositionAndBounds()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(e){this._fontWeight=e,this._displayText.font=DBLFont.getFontString(this._font,this._fontSize,e),this.updateTextPositionAndBounds()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"font",{get:function(){return this._font},enumerable:!1,configurable:!0}),h.prototype.updateTextPositionAndBounds=function(){this.adjustY(),this._aXLast="",this.updateBoundsAndMask(),this.positionText(),this.updateCharacterBounds()},h.prototype.adjustY=function(){var e,t;this._fixTextBaseline?DBLFont.fixTextFields(this._displayText):0==this._topBottomMargin?(this._displayText.textBaseline="alphabetic",this._displayText.y=this._displayText.getMeasuredHeight()):(this._displayText.textBaseline="top",e=this._topBottomMargin?this._height-this._displayText.getMeasuredHeight()-2*this._topBottomMargin:0,t=.1*this._displayText.getMeasuredHeight(),this._displayText.y=this._topBottomMargin+e/2+t)},Object.defineProperty(h.prototype,"textAlign",{get:function(){return this._textAlign},set:function(e){this._textAlign=e,this._displayText.textAlign=e,this.positionText()},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"color",{get:function(){return this._color},set:function(e){this._color=e,this._displayText.color=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"maxChars",{get:function(){return this._maxChars},set:function(e){this._maxChars=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"focused",{get:function(){return this._focused},set:function(e){DBLLog.log("Do not set the value of DBLTextInputA11y.focused directly, use DBLTextInputA11y.focus() instead.",DBLLog.ERROR)},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"defocusOnEnter",{get:function(){return this._defocusOnEnter},set:function(e){this._defocusOnEnter=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"focusOnClick",{get:function(){return this._focusOnClick},set:function(e){this._focusOnClick=e},enumerable:!1,configurable:!0}),h.prototype.blur=function(e){void 0===e&&(e=null),!this._focused||e&&(e=this.globalToLocal(e.stageX/dblDevicePixelRatio,e.stageY/dblDevicePixelRatio),new createjs.Rectangle(0,0,this._width,this._height).contains(e.x,e.y))||this.doComponentFocus(!1)},h.prototype.focus=function(e,t){t&&this.isAccessible&&this.enabled!==this.accessibleData.enabled&&a11y.updateAccessibility(),e&&this.enabled&&!this.focused?(this.doComponentFocus(!0),a11y.focusElement(this)):!e&&this.focused&&this.blur()},Object.defineProperty(h.prototype,"isAccessible",{get:function(){return!!this.accessibleData},enumerable:!1,configurable:!0}),h.prototype.doComponentFocus=function(e){for(var t=this.visible,n=this;t&&n.parent;)t=(n=n.parent).visible;e&&!this.visible||e&&!this.stage||e&&!t||e&&!this._enabled||(e&&!interactive&&this.stage==lessonStage?((DBLTextInputFocusManager.__deferredFocus=this)._backgroundApplyFocused&&this.updateBackground(this.bgFrameLabels.focused),DBLTextInputFocusManager.deferredFocusIn(this),this.dispatchEvent(new DBLTextInputEvent(DBLTextInputEvent.DEFERRED_FOCUS_IN))):(e||DBLTextInputFocusManager.__deferredFocus!=this||(DBLTextInputFocusManager.__deferredFocus=void 0),e&&!this._focused?(blur(),this._focused=e,this._autoSelect?this.select():(this._caretPos=this._displayText.text.length,this.updateSelectionFromCanvas(-1,-1),this.showFakeCaret(!0)),this._backgroundApplyFocused&&this.updateBackground(this.bgFrameLabels.focused),DBLTextInputFocusManager.focusIn(this),this.dispatchEvent(new DBLTextInputEvent(DBLTextInputEvent.FOCUS_IN))):!e&&this._focused&&(this._focused=e,this.showFakeCaret(!1),this.updateBackground(this.bgFrameLabels.notFocused),DBLTextInputFocusManager.focusOut(this),this.dispatchEvent(new DBLTextInputEvent(DBLTextInputEvent.FOCUS_OUT)))))},h.prototype.select=function(){this._focused&&(0==this._displayText.text.length?(this._caretPos=0,this.updateSelectionFromCanvas(-1,-1)):(this._caretPos=-1,this.updateSelectionFromCanvas(0,this._displayText.text.length)),this.showFakeCaret(!0))},h.prototype.setSelection=function(e,t){this.setCanvasSelection(e,t),this.updateHtmlSelection()},h.prototype.clearText=function(){this.setCurrentValue("")},h.prototype.updateCaret=function(){var e;this._caret&&(e=this.getTextBounds(),this.updateCharacterBounds(),this._caret.x=this._displayText.x+e.x+this._aX[this._caretPos])},h.prototype.setCurrentValue=function(e){e=e.toString();if(e!=this._currentValue){this._currentValue=e,this._displayText.text=this.passwordFilter(e);try{a11y.setInputValue(this,this._currentValue)}catch(e){}this.updateCaret()}},Object.defineProperty(h.prototype,"caretPos",{get:function(){return this._caretPos},set:function(e){this._caretPos=e,this.updateCaret()},enumerable:!1,configurable:!0}),h.prototype.updateAndDispatchChange=function(){var e=this.getInputValue();this._currentValue!=e&&(this.automationComponent?this.triggerEdit({value:e}):this.handleEdit(e))},h.prototype.passwordFilter=function(e){if(this._inputType!=h.PASSWORD)return e;for(var t="",n=0;n<e.length;n++)t+="•";return t},h.prototype.handleEdit=function(e){var t=this._currentValue!=e;return t&&(this._currentValue=e,this._displayText.text=this.passwordFilter(this._currentValue),replayMode&&(this.moveCaretToTheEnd(),this.updateCaret()),t)&&this.dispatchChanged(),t},Object.defineProperty(h.prototype,"currentComponent",{get:function(){return this.automationComponent},enumerable:!1,configurable:!0}),h.prototype.updateBackground=function(t){this._background&&this._background.timeline&&this._background.timeline.getLabels().some(function(e){return e.label==t})&&this._background.gotoAndStop(t)},Object.defineProperty(h.prototype,"restrictKeys",{get:function(){return this._restrictKeysStr||this._restrictStr},set:function(e){this._restrictKeysStr=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"restrict",{get:function(){return this._restrictStr},set:function(e){this.setRestrict(e)},enumerable:!1,configurable:!0}),h.prototype.setRestrict=function(e){if(!1===rootParams.softtabkey&&(e=e.replace("\t","")),this._restrictStr=e,this._restrictChars=[],""!=e){var t=e.match(/\w\-\w/g);if(null!=t){e=e.replace(/\w\-\w/g,"");for(var n=0;n<t.length;n++)this._restrictChars=this._restrictChars.concat(this.expandCharacterRange(t[n]))}e=e.replace(/\\(.)/g,"$1"),this._restrictChars=this._restrictChars.concat(e.split(""))}},h.prototype.expandCharacterRange=function(e){if(3!=e.length)return[];for(var t=e.charCodeAt(0),n=e.charCodeAt(2),o=(n<t&&(e=n,n=t,t=e),[]),r=t;r<=n;r++)o.push(String.fromCharCode(r));return o},Object.defineProperty(h.prototype,"restrictArray",{get:function(){return this._restrictArray},set:function(e){this._restrictArray=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"keyPadLayoutOptions",{get:function(){return this._keyPadLayoutOptions},set:function(e){this._keyPadLayoutOptions=e},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"restrictFunction",{get:function(){return this._restrictFunction},set:function(e){this._restrictFunction=e},enumerable:!1,configurable:!0}),h.prototype.restrictNumeric=function(e){var t=!1,n=this.text,o=n.charAt(0);return"-"==e&&(0!=this.selectionStart||0<=n.indexOf("-"))&&(t=!0),t=0==this.selectionStart&&"-"==o?!0:t},h.prototype.useNumericRestrictFunction=function(){this.restrictFunction=this.restrictNumeric},h.prototype.checkRestricted=function(e){var t=!1;if(0<this._restrictChars.length)for(var t=!0,n=0;n<this._restrictChars.length;n++)if(e==this._restrictChars[n]){t=!1;break}return t=!t&&this._restrictFunction?this._restrictFunction(e):t},h.prototype.showFakeCaret=function(e){var t,n,o=this;this._selection&&(this.removeChild(this._selection),this._displayText.color=this._color,this._selection=null,this._focusOnClick||(this._displayText.removeAllEventListeners("mousedown"),this._displayText.removeAllEventListeners("pressmove"),this._displayText.mouseEnabled=!1)),this._caret&&(this.removeChild(this._caret),this._caret=null,this.cleanupBlinkTimer(),this._focusOnClick||(this._displayText.removeAllEventListeners("mousedown"),this._displayText.removeAllEventListeners("pressmove"),this._displayText.mouseEnabled=!1)),this.updateCharacterBounds(),e&&(e=function(){return o._displayText.getBounds()||new createjs.Rectangle(-o._displayText.getMeasuredWidth(),-o._displayText.getMeasuredHeight(),0,0)},-1!=this._selectionStartPos?(this._selection=new createjs.Shape,this._selection.graphics.beginFill("#308DFC"),t=Math.max(0,this._selectionStartPos),n=Math.min(this._displayText.text.length,this._selectionEndPos),this._selection.graphics.drawRect(this._aX[t],0,this._aX[n],this._displayText.getMeasuredHeight()),this._selection.graphics.endFill(),this._selection.name="selection",this.addChildAt(this._selection,0),this._selection.x=this._displayText.x+e().x,this._selection.y=this._displayText.y+e().y,this._displayText.color="#ffffff",this._focusOnClick||(this._displayText.addEventListener("pressmove",this.handleCaretPressMove.bind(this)),this._displayText.mouseEnabled=!0)):-1!=this._caretPos&&(this._caret=new createjs.Shape,this._caret.graphics.beginFill("#000000"),this._caret.graphics.drawRect(-1,0,h.CARET_WIDTH,this._displayText.getMeasuredHeight()),this._caret.graphics.endFill(),this._caret.name="caret",this.addChild(this._caret),""==this._displayText.text?(this._displayText.text=" ",this._caret.x=this._displayText.x,this._caret.y=this._displayText.y+e().y,this._displayText.text=""):(this.updateCharacterBounds(),this._caret.x=this._displayText.x+e().x+this._aX[this._caretPos],this._caret.y=this._displayText.y+e().y),this.cleanupBlinkTimer(),this._blinkInterval=setInterval(this.blink.bind(this),500),this._focusOnClick||(this._displayText.addEventListener("pressmove",this.handleCaretPressMove.bind(this)),this._displayText.mouseEnabled=!0)))},h.prototype.blink=function(){this._caret.visible=!this._caret.visible},h.prototype.cleanupBlinkTimer=function(){this._blinkInterval&&clearInterval(this._blinkInterval)},h.prototype.isLoginInputField=function(){return-1<[h.EMAIL,h.PASSWORD,h.USERID,h.SCHOOLCODE,h.CLASSROOMCODE].indexOf(this._inputType)},h.prototype.handleKeyDownDocument=function(e){(this.isAccessible||null!=e&&e.defaultPrevented)&&!this.isLoginInputField()||(this.simulateKeyPressNew(e),e.preventDefault())},h.prototype.simulateKeyPress=function(e){var t=DBLSoftKey.getKey(e,["code"]),t=null!=t?t.stringRepresentation:String.fromCharCode(e);e==h.BACKSPACE_CODE&&(t="Backspace"),e==h.TAB_CODE&&(t="Tab"),this.simulateKeyPressNew(new KeyboardEvent("keypress",{key:t}))},h.prototype.getInputValue=function(){var e;return this.isLoginInputField()&&this.accessible?null==(e=document.getElementById(this.accessible.domId))?void 0:e.value:this._displayText.text},h.prototype.simulateKeyPressNew=function(t){function e(e){s(e,e+1)}var n=this,o=(this.showFakeCaret(!1),0<=this._selectionStartPos&&this._selectionEndPos>this._selectionStartPos),r=this.getInputValue(),i=t.key,a=function(e){n.updateSelectionFromCanvas(-1,-1),n._caretPos=e},s=function(e,t){t=r.substring(0,e)+r.substring(t);r!=t&&(n._displayText.text=t,a11y.setInputValue(n,t),a(e))};"Backspace"==i||"Delete"==i?(this._caretPos=Math.max(0,Math.min(r.length,this._caretPos)),o?s(this._selectionStartPos,this._selectionEndPos):("Backspace"==i&&0<this._caretPos&&e(this._caretPos-1),"Delete"==i&&this._caretPos<r.length&&e(this._caretPos)),this.updateSelectionFromCanvas(-1,-1)):"ArrowLeft"==t.key||"ArrowRight"==t.key?("ArrowLeft"==t.key?this._caretPos--:this._caretPos++,this._caretPos=Math.max(0,Math.min(r.length,this._caretPos)),this.updateSelectionFromCanvas(-1,-1)):"Home"==t.key||"End"==t.key?("Home"==t.key?this._caretPos=0:this._caretPos=r.length,this.updateSelectionFromCanvas(-1,-1)):"a"==t.key&&null!=t&&t.ctrlKey?(this._caretPos=-1,this.updateSelectionFromCanvas(0,r.length)):1===t.key.length&&(assert(0!=this._maxChars,"use maxChars -1 and not 0 for unlimited"),!this._reserveOperatorSpace&&r.length<this._maxChars||-1==this._maxChars||-1!=this._selectionStartPos||this.checkKeyPressWithReservedSpace(r,t.key))&&((o=new DBLTextInputEvent(DBLTextInputEvent.KEY_PRESS_PENDING)).keyPressed=t.key,this.dispatchEvent(o),!(!!o.defaultPrevented||this.checkRestricted(t.key)))&&(this._replaceValues&&0<this._replaceValues.length&&(o=0<(i=this._replaceValues.filter(function(e){return e.input==t.key})).length?i[0].replacement:t.key,t=new KeyboardEvent(t.type,{key:o,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey})),-1!=this._selectionStartPos?(i=Math.max(0,this._selectionStartPos),o=Math.min(this._displayText.text.length,this._selectionEndPos),r=r.substr(0,i)+t.key+r.substr(o),this._displayText.text=r,this._caretPos=i+1):(this._caretPos=Math.max(0,Math.min(r.length,this._caretPos)),this._reserveOperatorSpace?r=this.handleKeyPressWithReservedSpace(r,t.key):(r=r.substr(0,this._caretPos)+t.key+r.substr(this._caretPos),this._caretPos++),this._displayText.text=r),a11y.setInputValue(this,r),this.updateSelectionFromCanvas(-1,-1),this.dispatchKeyPressed(t)),t.key!=DBLTextInputEvent.ENTER_KEY&&t.key!=DBLTextInputEvent.TAB_KEY||(this.tabSupport?(o=t.shiftKey&&t.key==DBLTextInputEvent.TAB_KEY,DBLTextInputFocusManager.setInputsContainer(this.tabContainer),i=o?DBLTextInputFocusManager.getPreviousInput():DBLTextInputFocusManager.getNextInput(),DBLTextInputFocusManager.setInputsContainer(null),i&&i.focus(!0)):this._defocusOnEnter&&blur(),this.dispatchKeyPressed(t)),this.updateAndDispatchChange(),this._focused&&this.showFakeCaret(!0)},h.prototype.dispatchKeyPressed=function(e){var t=new DBLTextInputEvent(DBLTextInputEvent.KEY_PRESSED);t.init(e),this.dispatchEvent(t)},h.prototype.checkKeyPressWithReservedSpace=function(e,t){var n=0<e.length&&isNaN(parseInt(e[0]));return this._reserveOperatorSpace&&(isNaN(parseInt(t))||!n&&e.length<this._maxChars-1||n&&e.length<this._maxChars)},h.prototype.handleKeyPressWithReservedSpace=function(e,t){if(this._reserveOperatorSpace)if(isNaN(parseInt(t)))0<e.length&&isNaN(parseInt(e[0]))?e=t+e.slice(1):(e=t+e,this._caretPos++);else{if(e.length==this._maxChars)return e;(e.length!=this._maxChars-1||!isNaN(parseInt(e[0]))||0==this._caretPos)&&0<e.length&&0==this._caretPos&&isNaN(parseInt(e[0]))||(e=e.substr(0,this._caretPos)+t+e.substr(this._caretPos),this._caretPos++)}return e},h.prototype.updateCharacterBounds=function(){var e=this._displayText.text;if(!this._aXLast||e!=this._aXLast){if(this._aXLast&&e.length==this._aXLast.length+1&&e.substr(0,e.length-1)==this._aXLast)this._aX.push(this._displayText.getBounds().width);else if(this._aXLast&&e.length==this._aXLast.length-1&&e==this._aXLast.substr(0,this._aXLast.length-1))this._aX.pop();else{this._aX=[0];for(var t=1;t<=e.length;t++)this._displayText.text=e.substr(0,t),this._aX.push(this._displayText.getBounds().width)}this._aXLast=e}},h.prototype.onViewClick=function(e){this._focusOnClick&&!this._focused&&this._enabled&&(e.stopImmediatePropagation(),e.preventDefault(),a11y.focusElement(this)),this._enabled&&(this.handleCaretMouseDown(e),this.updateHtmlSelection())},h.prototype.handleCaretMouseDown=function(e){this._focusOnClick&&!this._focused&&this._enabled&&this.doComponentFocus(!0);var t=this.getTextBounds(),n=e.localX-t.x,o=0;for(this.updateCharacterBounds();o+1<this._aX.length&&n>(this._aX[o]+this._aX[o+1])/2;)o++;o!=this._caretPos&&(this._caretPos=o,this.updateSelectionFromCanvas(-1,-1),this.showFakeCaret(!1),this._focused)&&this.showFakeCaret(!0)},h.prototype.handleCaretPressMove=function(e){if(this._enabled){var t=this.globalToLocal(e.stageX,e.stageY);if(this.getBounds().contains(t.x,t.y)){var t=this.getTextBounds(),n=e.localX-t.x,o=0;for(this.updateCharacterBounds();o+1<this._aX.length&&n>(this._aX[o]+this._aX[o+1])/2;)o++;o!=this._caretPos&&(this._caretPos=o,this.updateSelectionFromCanvas(-1,-1),this.showFakeCaret(!1),this.showFakeCaret(!0))}else this.showFakeCaret(!1)}},h.prototype.handleMouseOver=function(e){this._enabled&&DBLCursor.setCursor(DBLCursor.TEXT)},h.prototype.handleMouseOut=function(e){DBLCursor.setCursor(DBLCursor.AUTO)},h.prototype.getTextBounds=function(){var e;return""==this._displayText.text?(this._displayText.text=" ",(e=this._displayText.getBounds()).x=0,e.width=0,this._displayText.text=""):e=this._displayText.getBounds(),e},h.prototype.getAccessibilityData=function(i){var a=this,e="dynamic";return{type:"input",role:e=this.isLoginInputField()?"input":e,display:{object:this},value:this._currentValue,visible:this.visible,maxLength:this._maxChars,insideGrid:i,keyAllowed:this.onA11yKeyAllowed,focus:{onHTMLFocus:function(){a._focusOnClick&&!a._focused&&a._enabled?(a.doComponentFocus(!0),a.onA11ySelectionChange()):a._autoSelect&&a.select()},onHTMLBlur:function(){a.doComponentFocus(!1)},onCanvasBlur:function(){a.doComponentFocus(!1)}},onChange:function(t){a._replaceValues&&0<a._replaceValues.length&&a._replaceValues.filter(function(e){return e.input!=e.replacement}).forEach(function(e){for(;-1<t.indexOf(e.input);)t=t.replace(e.input,e.replacement)});var n=a._displayText.text;(t||"").split("").some(function(e){return-1==n.indexOf(e)&&a.checkRestricted(e)})?a11y.setInputValue(a,a._displayText.text):(a._displayText.text=a.passwordFilter(t),a.updateAndDispatchChange())},onSelectionChanged:this.onA11ySelectionChange,onKeyDown:function(e,t){var n,o,r;a._focused&&a._enabled&&(a11y.isSimulatedInput(a)?a.isLoginInputField()||a.simulateKeyPressNew(new KeyboardEvent("keydown",{key:e})):(a._defocusOnEnter&&e==DBLTextInputEvent.ENTER_KEY&&a.blur(),a.dispatchKeyPressed(new KeyboardEvent("keydown",{key:e}))),i)&&a.focused&&(o=(n=a11y.getInputSelection(a))[0],"ArrowLeft"==e||"ArrowRight"==e)&&(r=a.text.length,o!==n[1]||"ArrowLeft"===e&&0!=o||"ArrowRight"===e&&o!=r)&&t.stopImmediatePropagation()}}},h.prototype.setCanvasSelection=function(e,t){if(this._focused){if(e==t)this._caretPos=e,this.updateSelection(-1,-1);else{if(0!=e||t!=this._displayText.text.length)return void this.setSelection(0,this._displayText.text.length);this._caretPos=-1,this.updateSelection(e,t)}this.showFakeCaret(!0)}},h.prototype.updateSelection=function(e,t){this._selectionStartPos=e,this._selectionEndPos=t},h.prototype.updateSelectionFromCanvas=function(e,t){this.updateSelection(e,t),this.updateHtmlSelection()},h.prototype.getSelection=function(){return-1<this._caretPos?[this._caretPos,this._caretPos]:[this._selectionStartPos,this._selectionEndPos]},h.prototype.updateHtmlSelection=function(){a11y.updateInputSelection(this)},h.RESTRICTED="restricted",h.KEYBOARDLESS="keyboardless",h.EMAIL="email",h.PASSWORD="password",h.USERID="userid",h.SCHOOLCODE="schoolcode",h.CLASSROOMCODE="classroomcode",h.RESTRICT_DEFAULT="0-9\\-",h.RESTRICT_POSITIVE="0-9",h.ENTER_CODE=13,h.TAB_CODE=9,h.BACKSPACE_CODE=8,h.DELETE_CODE=46,h.ARROW_UP_CODE=38,h.ARROW_DOWN_CODE=40,h.ARROW_LEFT_CODE=37,h.ARROW_RIGHT_CODE=39,h.HOME_CODE=36,h.END_CODE=35,h.A_CODE=65,h.CARET_WIDTH=1,h})(comp.InteractiveObject),DBLTextInputFocusManager,DBLTimer=((t=>{var o,n,r=[],i=null,a=0,s=[],l=1;function c(e){return"keyboardless"!=e.type&&"userid"!=e.type&&"password"!=e.type&&"email"!=e.type&&"schoolcode"!=e.type&&"classroomcode"!=e.type}function e(t){void 0===t&&(t="all");var n,e=r.filter(function(e){return e.visible&&e.enabled&&e.stage&&e.tabSupport&&(!i||e.tabContainer==i)});return"all"!=t&&(n=o,e=e.filter(function(e){return"sameRow"==t?d(n,e,"sameRow"):u(n,e)})),e.sort(function(e,t){var n=e.localToGlobal(e.x,e.y),o=t.localToGlobal(t.x,t.y);return n||o?n?o?u(e,t)?n.x-o.x:n.y-o.y:1:-1:0})}function u(e,t){return d(e,t)}function d(e,t,n){void 0===n&&(n="sameColumn");e=e.localToGlobal(e.x,e.y),t=t.localToGlobal(t.x,t.y);return!(!e||!t)&&("sameColumn"==n?Math.abs(e.y-t.y)<l:Math.abs(e.x-t.x)<l)}function p(e){o?(o.handleKeyDownDocument(e),e.defaultPrevented&&a++):0<s.length&&(0,s[s.length-1])(e)}function h(e,t){t=e&&e.indexOf(t);return DBLUtils.isUndefOrNull(t)||-1===t?null:e[(t-1+e.length)%e.length]}function g(e,t){t=e&&e.indexOf(t);return DBLUtils.isUndefOrNull(t)||-1===t?null:e[(t+1)%e.length]}t.init=function(){r=[],n=o=null,s=[],document.addEventListener("keydown",p)},t.cleanup=function(){document.removeEventListener("keydown",p),r=[],n=o=null,s=[]},t.registerTextInput=function(e){-1==r.indexOf(e)&&r.push(e)},t.unregisterTextInput=function(e){-1!=(e=r.indexOf(e))&&r.splice(e,1)},t.resetDeferredFocus=function(){t.__deferredFocus=void 0},t.setDeferredFocus=function(){var e;t.__deferredFocus&&(e=t.__deferredFocus,t.__deferredFocus=void 0,e.focus(!0,!0))},t.pushKeyboardListener=function(e){s.push(e)},t.popKeyboardListener=function(e){e?0<=(e=s.indexOf(e))&&s.splice(e,1):s.pop()},t.setInputsContainer=function(e){i=e},t.deferredFocusIn=function(e){},t.focusIn=function(e){o!=e&&(o=e,__keyPadController)&&c(o)&&__keyPadController.focusIn()},t.focusOut=function(e){o==e&&(n=o,o=null,__keyPadController)&&c(n)&&__keyPadController.focusOut()},t.getTextInputWithFocus=function(){return o},t.getLastInputWithFocus=function(){return n},t.restoreInputFocus=function(){n&&-1!=r.indexOf(n)&&n.focus(!0)},t.getNextInput=function(){return g(e(),o)},t.getPreviousInput=function(){return h(e(),o)},t.getDownInput=function(){return h(e("sameColumn"),o)},t.getUpInput=function(){return g(e("sameColumn"),o)},t.getSortedInputs=e,t.getKeyStats=function(){return"physicalKeys="+a}})(DBLTextInputFocusManager=DBLTextInputFocusManager||{}),(o=>{function n(e,t){void 0===t&&(t=0);var n=o.call(this)||this;return n._delay=e,n._repeatCount=t,n._currentCount=0,n._running=!1,n._elapsedTime=0,n._isPaused=!1,n}return __extends(n,o),n.prototype.start=function(){this._running||(this._listenerRef=createjs.Ticker.addEventListener("tick",this.onTick.bind(this)),this._lastTime=createjs.Ticker.getTime(),this._running=!0,this._isPaused=!1)},n.prototype.stop=function(){this._running&&(createjs.Ticker.removeEventListener("tick",this._listenerRef),this._running=!1)},n.prototype.reset=function(){this.stop(),this._elapsedTime=0,this._currentCount=0,this._isPaused=!1},n.prototype.complete=function(){this.reset(),this.dispatchEvent(n.TIMER_COMPLETE)},n.prototype.cleanup=function(){this.reset()},n.prototype.onTick=function(e){var t;e.paused||!this._running||this._isPaused||(t=(e=createjs.Ticker.getTime())-this._lastTime,this._lastTime=e,this._elapsedTime+=t,this._elapsedTime>=this._delay&&(this._elapsedTime-=this._delay,this._currentCount++,this._repeatCount<1?this.dispatchEvent(n.TIMER):(this.dispatchEvent(n.TIMER),this._currentCount>=this._repeatCount&&this.complete())))},Object.defineProperty(n.prototype,"delay",{get:function(){return this._delay},set:function(e){this._delay=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"repeatCount",{get:function(){return this._repeatCount},set:function(e){this._repeatCount=e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"running",{get:function(){return this._running},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._isPaused},set:function(e){this._isPaused=e},enumerable:!1,configurable:!0}),n.TIMER="timer",n.TIMER_COMPLETE="timerComplete",n})(createjs.EventDispatcher)),DBLTween,DBLUtils,DBLMD5,DBLJSONUtils,DBLVoiceChoice;(e=>{var r,t;function i(){var e=t;r=t=null,e&&e()}e.tweenTo=function(e,t,n,o){(r=r||new gsap.TimelineLite({paused:!0,onComplete:i})).to(e,t,n,o)},e.tweenFrom=function(e,t,n,o){(r=r||new gsap.TimelineLite({paused:!0,onComplete:i})).from(e,t,n,o)},e.playTweens=function(e){t=function(){"function"==typeof e&&e(),a11y.updateFocusGraphics()},r?(r.play(),fastForwarding&&r.progress(1)):i()},e.fastForwardPlayTweens=function(){t&&r.progress(1)}})(DBLTween=DBLTween||{}),(r=>{function t(e){return"string"==typeof e}function n(e){return"number"==typeof e}function o(e){return null!=e&&1==e.length&&e.charCodeAt(0)>="0".charCodeAt(0)&&e.charCodeAt(0)<="9".charCodeAt(0)}function l(n){return Array.isArray(n)?n.map(l):n instanceof Date?new Date(n.getTime()):n&&"object"==typeof n?Object.getOwnPropertyNames(n).reduce(function(e,t){return Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t)),e[t]=l(n[t]),e},Object.create(Object.getPrototypeOf(n))):n}function c(e){return Number.isInteger(e)?0:e.toString().split(".")[1].length}r.TIMES_SYMBOL="×",r.DIVIDE_SYMBOL="÷",r.PLUS_SYMBOL="+",r.MINUS_SYMBOL="-",r.MODULUS_SYMBOL="%",r.LT_SYMBOL="<",r.LE_SYMBOL="≤",r.GT_SYMBOL=">",r.GE_SYMBOL="≥",r.EQUAL_SYMBOL="=",r.NE_SYMBOL="≠",r.TRUE_SYMBOL="true",r.FALSE_SYMBOL="false",r.UNKNOWN_SYMBOL="?",r.ESCAPE_SYMBOL="#",r.PI_SYMBOL="π",r.isUndefined=function(e){return void 0===e},r.isDefined=function(e){return void 0!==e},r.isNull=function(e){return"object"==typeof e&&!e},r.isUndefOrNull=function(e){return this.isUndefined(e)||this.isNull(e)},r.isFunction=function(e){return"function"==typeof e},r.isObject=function(e){return e&&"object"==typeof e||this.isFunction(e)},r.isArray=function(e){var t=Object.prototype.toString;return e&&"[object Array]"==t.call(e)},r.isBoolean=function(e){return"boolean"==typeof e},r.isString=t,r.isNumber=n,r.isNumberString=function(e){return/^[+-]?\d+(\.\d+)?$/.test(e)},r.isNumberOrDigit=function(e){return n(e)||t(e)&&o(e)},r.isDigit=o,r.isAlpha=function(e){return null!=e&&1==e.length&&e.charCodeAt(0)>="a".charCodeAt(0)&&e.charCodeAt(0)<="z".charCodeAt(0)||e.charCodeAt(0)>="A".charCodeAt(0)&&e.charCodeAt(0)<="Z".charCodeAt(0)},r.isPrimitive=function(e){return this.isString(e)||this.isNumber(e)||this.isBoolean(e)},r.toInt=function(e){return this.isNumber(e)?isNaN(e)||(e=0<e?Math.floor(e):Math.ceil(e)):e=parseInt(e),e},r.fractionToNumber=function(e){if(0<=e.indexOf("."))return parseFloat(e);if(0<=e.indexOf("/")){for(var t=0,n=e.split(" "),o=0;o<n.length;o++)if(0<=n[o].indexOf("/")){var r=n[o].split("/");if(0==parseInt(r[1]))return NaN;t+=parseInt(r[0])/parseInt(r[1])}else t+=parseInt(n[o]);return t}return parseInt(e)},r.values=function(t){return Object.keys(t).map(function(e){return t[e]})},r.beginsWith=function(e,t){return!this.isUndefOrNull(e)&&!this.isUndefOrNull(t)&&-1!=(e=e.indexOf(t))&&0==e},r.endsWith=function(e,t){var n;return!this.isUndefOrNull(e)&&!this.isUndefOrNull(t)&&-1!=(n=e.lastIndexOf(t))&&n==e.length-t.length},r.reverseString=function(e){for(var t="",n=e.length-1;0<=n;n--)t+=e.charAt(n);return t},r.toFirstLetterUpper=function(e){return e.substr(0,1).toUpperCase()+e.substr(1)},r.equal=function(e,t){if(this.isUndefOrNull(e)&&this.isUndefOrNull(t))return!0;if(this.isUndefOrNull(e)||this.isUndefOrNull(t))return!1;if(this.isArray(e)&&this.isArray(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!this.equal(e[n],t[n]))return!1;return!0}return!!(this.isNumber(e)&&this.isNumber(t)&&isNaN(e)&&isNaN(t))||e==t},r.normalizeSymbol=function(e){if(this.isUndefOrNull(e))return"";if(2<=e.length&&e.charAt(0)==this.ESCAPE_SYMBOL&&e.charAt(e.length-1)==this.ESCAPE_SYMBOL)return e.substr(1,e.length-2);switch(e.toLowerCase().replace(" ","")){case"blank":case"noop":case"":return"";case"mult":case"multiplication":case"multipliedby":case"times":case"*":case this.TIMES_SYMBOL:return this.TIMES_SYMBOL;case"div":case"division":case"dividedby":case"/":case this.DIVIDE_SYMBOL:return this.DIVIDE_SYMBOL;case"plus":case"add":case"addition":case this.PLUS_SYMBOL:return this.PLUS_SYMBOL;case"minus":case"subtract":case"subtraction":case this.MINUS_SYMBOL:return this.MINUS_SYMBOL;case"mod":case this.MODULUS_SYMBOL:return this.MODULUS_SYMBOL;case"lt":case"less":case"lessthan":case this.LT_SYMBOL:return this.LT_SYMBOL;case"le":case"lessthanorequalto":case"<=":case"=<":case this.LE_SYMBOL:return this.LE_SYMBOL;case"gt":case"more":case"morethan":case"greater":case this.GT_SYMBOL:return this.GT_SYMBOL;case"ge":case"greaterthanorequalto":case">=":case"=>":case this.GE_SYMBOL:return this.GE_SYMBOL;case"eq":case"equal":case"equals":case"equalto":case this.EQUAL_SYMBOL:return this.EQUAL_SYMBOL;case"ne":case"notequal":case"notequals":case"notequalto":case"!=":case"<>":case this.NE_SYMBOL:return this.NE_SYMBOL;case"true":return this.TRUE_SYMBOL;case"false":return this.FALSE_SYMBOL;case"unknown":case"theblank":case"?":return this.UNKNOWN_SYMBOL;default:return e}},r.clone=function(e){return JSON.parse(JSON.stringify(e))},r.merge=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var o=void 0,r=0,i=t.filter(function(e){return!!e});r<i.length;r++){var a=i[r];if(o)if("object"==typeof o)for(var s in a)o[s]=e(o[s],a[s]);else o=a;else o=l(a)}return o},r.deepCopy=l,r.debugGetDisplayObjectInfo=function(e){return function t(e,n){void 0===n&&(n="");var o=n;var r=e.name||e.constructor.name||"(unnamed)";var i=e.localToGlobal(0,0);o+="".concat(r,": localPos (").concat(e.x.toFixed(1),", ").concat(e.y.toFixed(1),")");o+=", globalPos (".concat((i.x/engagementStage.scaleX).toFixed(1),", ").concat((i.y/engagementStage.scaleY).toFixed(1),")");o+=" reg (".concat(e.regX.toFixed(1),", ").concat(e.regY.toFixed(1),") scale ").concat(e.scaleX.toFixed(2));r=e.getBounds();i=e.getTransformedBounds();r?o=(o+=" bounds (".concat(r.x.toFixed(1),", ").concat(r.y.toFixed(1),")"))+" ".concat(r.width.toFixed(1)," x ").concat(r.height.toFixed(1)):o+=" bounds undefined";i?o=(o+=" transformed bounds (".concat(i.x.toFixed(1),", ").concat(i.y.toFixed(1),")"))+" ".concat(i.width.toFixed(1)," x ").concat(i.height.toFixed(1)):o+=" transformed bounds undefined";o+="\n";e instanceof createjs.Container&&e.children.forEach(function(e){o+=t(e,n+"    ")});return o}(e,"")},r.findRoughShapeBounds=function(e){var n=Number.MAX_VALUE,o=Number.MAX_VALUE,r=-Number.MAX_VALUE,i=-Number.MAX_VALUE;return e.graphics.instructions.forEach(function(e){var t;void 0!==e.x&&(t=e.x,n=Math.min(n,t),r=Math.max(r,t)),void 0!==e.y&&(t=e.y,o=Math.min(o,t),i=Math.max(i,t))}),{x:n,y:o,width:r-n,height:i-o}},r.hitTestPointObject=function(e,t){return r.hitTestPointRect(e,t.getTransformedBounds())},r.hitTestPointRect=function(e,t){return e.x>=t.x&&e.y>=t.y&&e.x<=t.x+t.width&&e.y<=t.y+t.height},r.hitTestRectRect=function(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.height+e.y>t.y},r.parseMinuteSecondMilliTime=function(e){var t;return"number"==typeof e?e:"string"==typeof e?4==(t=e.split(/[.:]/)).length?60*parseFloat(t[0])+60*parseFloat(t[1])+parseFloat(t[2]+"."+t[3]):3==t.length?60*parseFloat(t[0])+parseFloat(t[1]+"."+t[2]):2==t.length?parseFloat(t[0]+"."+t[1]):parseFloat(e):0},r.removeAllEventHandlersRecursive=function t(e,n){e instanceof createjs.Container&&e.children.forEach(function(e){t(e,n)}),e.removeAllEventListeners(n)},r.removeAllChildrenAndEventsRecursive=function t(e){var n;e instanceof createjs.Container&&((n=e).children.forEach(function(e){t(e)}),n.removeAllChildren()),e.removeAllEventListeners()},r.generateRandomWholeNumber=function(e,t,n,o,r){return void 0===n&&(n=1),void 0===o&&(o=!1),r&&(r(e%n==0,"generateRandomWholeNumber: minValue: ".concat(e," is not multiple of step: ").concat(n,"!")),r(t%n==0,"generateRandomWholeNumber: maxValue: ".concat(t," is not multiple of step: ").concat(n,"!")),r(e<=t,"generateRandomWholeNumber: minValue: ".concat(e," is not less than or equal to maxValue: ").concat(t,"!"))),o=o||e==t,e+Math.floor(((o?1:-1)+(t-e)/n)*DBLRandom.seededRandomForGenerators())*n+(o?0:n)},r.generateListOfNumbersFromRanges=function(e,a){var s=new Set;return e.forEach(function(e){o=a,t=e.min;var t,n,o=(t+=0<(n=t%o)?o-n:0)<=e.max?t:NaN;if(!isNaN(o))for(var r=Math.pow(10,c(a)),i=o;i<=e.max;i=Math.round((i+a)*r)/r)s.add(i)}),Array.from(s)},r.digitsAfterDecimal=c,r.rot13=function(e){for(var t="",n=0;n<e.length;n++){var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".indexOf(e[n]);t+=-1==o?e[n]:"NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm"[o]}return t},r.splitIntoSentences=function(e){return(e+" ").replace(/([\.!\?]+[ ]+)/g,"$1\n").split("\n").map(function(e){return e.trim()}).filter(function(e){return 0<e.length})},r.getDisplayObjectHash=function(e,a){function s(e,t){if(e){for(var n=e,o=(null!=(null==a?void 0:a.hashKeys)?a.hashKeys:Object.keys(n).filter(function(e){return!e.startsWith("_")&&("function"!=typeof n[e]||"object"!=typeof n[e])})).reduce(function(e,t){return e[t]="function"==typeof n[t]?n[t]():n[t],e},{}),r=t+JSON.stringify(o),i=0;i<r.length;i++)l=(31*l+r.charCodeAt(i))%1000000007;e instanceof createjs.Container&&(null!=a&&a.filterChildren?e.children.filter(a.filterChildren):e.children).forEach(s)}}var l=0;return s(e,0),l.toString(16)},r.createTimeString=function(e,t){void 0===t&&(t=!0);var e=r.toInt(e/1e3),n=r.toInt(e/3600),o=r.toInt((e%=3600)/60).toString(),e=(e%=60).toString();return 1==o.length&&(o="0"+o),1==e.length&&(e="0"+e),t?(0<n?n+":":"")+o+":"+e:translate("".concat(n,"h ").concat(o,"m"))},r.popupTimerChecker=function(e,t,n){var o=(new Date).getTime();return null==(e=null==(e=DBLStateManager.getProperty(e))?void 0:e[t])||24*n*60*60*1e3<=o-e},r.setLastShownPopupTimestamp=function(e,t){var n=(new Date).getTime(),o=DBLStateManager.getProperty(e)||{};DBLStateManager.setProperty(e,__assign(__assign({},o),((e={})[t]=n,e)))}})(DBLUtils=DBLUtils||{}),(()=>{function s(e,t){return e<<t|e>>>32-t}function d(e,t){var n=2147483648&e,o=2147483648&t,r=1073741824&e,i=1073741824&t,e=(1073741823&e)+(1073741823&t);return r&i?2147483648^e^n^o:r|i?1073741824&e?3221225472^e^n^o:1073741824^e^n^o:e^n^o}function p(e,t,n,o,r,i,a){return e=d(e,d(d(t&n|~t&o,r),a)),d(s(e,i),t)}function h(e,t,n,o,r,i,a){return e=d(e,d(d(t&o|n&~o,r),a)),d(s(e,i),t)}function g(e,t,n,o,r,i,a){return e=d(e,d(d(t^n^o,r),a)),d(s(e,i),t)}function f(e,t,n,o,r,i,a){return e=d(e,d(d(n^(t|~o),r),a)),d(s(e,i),t)}function _(e){for(var t="",n="",o=0;o<=3;o++)t+=(n="0"+(e>>>8*o&255).toString(16)).substr(n.length-2,2);return t}(DBLMD5||(DBLMD5={})).digest=function(e){Array();for(var t,n,o,r,i=(e=>{for(var t,n=e.length,o=16*(1+((o=n+8)-o%64)/64),r=Array(o-1),i=0,a=0;a<n;)i=a%4*8,r[t=(a-a%4)/4]=r[t]|e.charCodeAt(a)<<i,a++;return r[t=(a-a%4)/4]=r[t]|128<<(i=a%4*8),r[o-2]=n<<3,r[o-1]=n>>>29,r})(e=(e=>{e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):t=127<o&&o<2048?(t+=String.fromCharCode(o>>6|192))+String.fromCharCode(63&o|128):(t=(t+=String.fromCharCode(o>>12|224))+String.fromCharCode(o>>6&63|128))+String.fromCharCode(63&o|128)}return t})(e)),a=1732584193,s=4023233417,l=2562383102,c=271733878,u=0;u<i.length;u+=16)a=p(t=a,n=s,o=l,r=c,i[u+0],7,3614090360),c=p(c,a,s,l,i[u+1],12,3905402710),l=p(l,c,a,s,i[u+2],17,606105819),s=p(s,l,c,a,i[u+3],22,3250441966),a=p(a,s,l,c,i[u+4],7,4118548399),c=p(c,a,s,l,i[u+5],12,1200080426),l=p(l,c,a,s,i[u+6],17,2821735955),s=p(s,l,c,a,i[u+7],22,4249261313),a=p(a,s,l,c,i[u+8],7,1770035416),c=p(c,a,s,l,i[u+9],12,2336552879),l=p(l,c,a,s,i[u+10],17,4294925233),s=p(s,l,c,a,i[u+11],22,2304563134),a=p(a,s,l,c,i[u+12],7,1804603682),c=p(c,a,s,l,i[u+13],12,4254626195),l=p(l,c,a,s,i[u+14],17,2792965006),a=h(a,s=p(s,l,c,a,i[u+15],22,1236535329),l,c,i[u+1],5,4129170786),c=h(c,a,s,l,i[u+6],9,3225465664),l=h(l,c,a,s,i[u+11],14,643717713),s=h(s,l,c,a,i[u+0],20,3921069994),a=h(a,s,l,c,i[u+5],5,3593408605),c=h(c,a,s,l,i[u+10],9,38016083),l=h(l,c,a,s,i[u+15],14,3634488961),s=h(s,l,c,a,i[u+4],20,3889429448),a=h(a,s,l,c,i[u+9],5,568446438),c=h(c,a,s,l,i[u+14],9,3275163606),l=h(l,c,a,s,i[u+3],14,4107603335),s=h(s,l,c,a,i[u+8],20,1163531501),a=h(a,s,l,c,i[u+13],5,2850285829),c=h(c,a,s,l,i[u+2],9,4243563512),l=h(l,c,a,s,i[u+7],14,1735328473),a=g(a,s=h(s,l,c,a,i[u+12],20,2368359562),l,c,i[u+5],4,4294588738),c=g(c,a,s,l,i[u+8],11,2272392833),l=g(l,c,a,s,i[u+11],16,1839030562),s=g(s,l,c,a,i[u+14],23,4259657740),a=g(a,s,l,c,i[u+1],4,2763975236),c=g(c,a,s,l,i[u+4],11,1272893353),l=g(l,c,a,s,i[u+7],16,4139469664),s=g(s,l,c,a,i[u+10],23,3200236656),a=g(a,s,l,c,i[u+13],4,681279174),c=g(c,a,s,l,i[u+0],11,3936430074),l=g(l,c,a,s,i[u+3],16,3572445317),s=g(s,l,c,a,i[u+6],23,76029189),a=g(a,s,l,c,i[u+9],4,3654602809),c=g(c,a,s,l,i[u+12],11,3873151461),l=g(l,c,a,s,i[u+15],16,530742520),a=f(a,s=g(s,l,c,a,i[u+2],23,3299628645),l,c,i[u+0],6,4096336452),c=f(c,a,s,l,i[u+7],10,1126891415),l=f(l,c,a,s,i[u+14],15,2878612391),s=f(s,l,c,a,i[u+5],21,4237533241),a=f(a,s,l,c,i[u+12],6,1700485571),c=f(c,a,s,l,i[u+3],10,2399980690),l=f(l,c,a,s,i[u+10],15,4293915773),s=f(s,l,c,a,i[u+1],21,2240044497),a=f(a,s,l,c,i[u+8],6,1873313359),c=f(c,a,s,l,i[u+15],10,4264355552),l=f(l,c,a,s,i[u+6],15,2734768916),s=f(s,l,c,a,i[u+13],21,1309151649),a=f(a,s,l,c,i[u+4],6,4149444226),c=f(c,a,s,l,i[u+11],10,3174756917),l=f(l,c,a,s,i[u+2],15,718787259),s=f(s,l,c,a,i[u+9],21,3951481745),a=d(a,t),s=d(s,n),l=d(l,o),c=d(c,r);return(_(a)+_(s)+_(l)+_(c)).toLowerCase()}})(),(e=>{function u(){return""}function d(e,t,n){return e.slice(t=void 0===t?void 0:t,n=void 0===n?void 0:n).replace(/\S/g," ")}var p="singleComment",h="multiComment";e.stripJsonComments=function(e,t){if(t=void 0===(t=(void 0===t?{}:t).whitespace)||t,"string"!=typeof e)throw new TypeError("Expected argument `jsonString` to be a `string`, got `".concat(typeof e,"`"));for(var n=t?d:u,o=!1,r=!1,i=0,a="",s=0;s<e.length;s++){var l=e[s],c=e[s+1];(o=r||'"'!==l||((e,t)=>{for(var n=t-1,o=0;"\\"===e[n];)--n,o+=1;return Boolean(o%2)})(e,s)?o:!o)||(r||l+c!=="//"?r===p&&l+c==="\r\n"?(r=!1,a+=n(e,i,++s),i=s):r===p&&"\n"===l?(r=!1,a+=n(e,i,s),i=s):r||l+c!=="/*"?r===h&&l+c==="*/"&&(r=!1,a+=n(e,i,++s+1),i=s+1):(a+=e.slice(i,s),i=s,r=h,s++):(a+=e.slice(i,s),i=s,r=p,s++))}return a+(r?n(e.slice(i)):e.slice(i))}})(DBLJSONUtils=DBLJSONUtils||{}),(o=>{var e={1:{english:["Joanna","Ruth","Matthew","Amy"],spanish:["Lupe"]},2:{english:["Matthew"]}};function t(e){o.voice=e,o.engine=rootParams.ttsengine||("Ruth"==o.voice||"Matthew"==o.voice||"Amy"==o.voice?"generative":"neural"),o.style=rootParams.ttsstyle||("Joanna"==o.voice?"conversational":"")}function n(e){t(e),DBLStateManager.setProperty(o.PROPERTY_VOICE_BASE+lcid,e)}function r(){return e[__application][language]}function i(){if("GB"==dialect)for(var e=0,t=r();e<t.length;e++){var n=t[e];if("GB"==o.info[n].dialect)return n}return r()[0]}o.info={Joanna:{character:"Angela",avatar:"math1",sample:"Hello, I'm Angela! Let's explore some ideas.",dialect:"US"},Ruth:{character:"Randi",avatar:"math2",sample:"Hi, I'm Randi! Let's find out something new!",dialect:"US"},Matthew:{character:"Michael",avatar:"math3",sample:"Hello, I'm Michael! Let's learn something together today.",dialect:"US"},Amy:{character:"Alice",avatar:"math4",sample:"Hello, I'm Alice! Let's do some lessons.",dialect:"GB"},Lupe:{character:"Lupe",avatar:"math_es1",sample:"Hello, I'm Lupe!"},Stephen:{character:"Stephen",avatar:"reading1",sample:"Hello, I'm Stephen!"}},o.PROPERTY_VOICE_BASE="Property.voice_",o.init=function(){o.voice||t(r()[0])},o.setVoicePermanently=n,o.getVoices=r,o.afterInitialPropSync=function(){var e=DBLStateManager.getProperty(o.PROPERTY_VOICE_BASE+lcid);e&&-1==r().indexOf(e)?n(i()):t(e||i())}})(DBLVoiceChoice=DBLVoiceChoice||{});